documentation_complete: true

title: Ensure Rsyslog Encrypts Off-Loaded Audit Records

description: |-
  Rsyslogd is a system utility providing support for message logging. Support
  for both internet and UNIX domain sockets enables this utility to support both local
  and remote logging.  Couple this utility with <tt>gnutls</tt> (which is a secure communications
  library implementing the SSL, TLS and DTLS protocols), and you have a method to securely
  encrypt and off-load auditing.

  When using <tt>rsyslogd</tt> to off-load logs off a encrpytion system must be used.

rationale: |-
    The audit records generated by Rsyslog contain valuable information regarding system
    configuration, user authentication, and other such information. Audit records should be
    protected from unauthorized access.

severity: medium

identifiers:
    cce@rhel8: CCE-86098-1
    cce@rhel9: CCE-90191-8

references:
    disa: CCI-001851
    nist: AU-4(1)
    srg: SRG-OS-000342-GPOS-00133,SRG-OS-000479-GPOS-00224
    stigid@ol8: OL08-00-030710
    stigid@rhel8: RHEL-08-030710

ocil_clause: 'rsyslogd ActionSendStreamDriverMode is not set to 1'

ocil: |-
    Verify the operating system encrypts audit records off-loaded onto a different system
    or media from the system being audited with the following commands:

    <pre>$ sudo grep -i '$ActionSendStreamDriverMode' /etc/rsyslog.conf /etc/rsyslog.d/*.conf</pre>

    The output should be:

    <pre>/etc/rsyslog.conf:$ActionSendStreamDriverMode 1</pre>

fixtext: |-
    Configure the operating system to encrypt off-loaded audit records by setting the following options in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":

    $ActionSendStreamDriverMode 1

srg_requirement: '{{{ full_name }}}  must encrypt the transfer of audit records off-loaded onto a different system or media from the system being audited.'
