documentation_complete: true

prodtype: sle12

title: 'Record Event When /usr/bin/su Gets Executed'

description: |-
    The audit system should collect execution events of <tt>/usr/bin/su</tt>.

    Add the following lines to the <tt>/etc/audit/audit.rules</tt> file:
    <pre>-a always,exit -F -arch=b32 path=/usr/bin/su -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged-priv_change
    -a always,exit -F -arch=b64 path=/usr/bin/su -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged-priv_change</pre>

rationale: |-
    Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system.
    Auditing these events could serve as evidence of potential system compromise.

severity: medium

references:
    disa: 130,169,172,2884
    nist: AU-3,AU-12(a),AU-12(c),MA-4(1)(a)
    stigid: "020250"

warnings:
    - general: |-
        Note that these rules can be configured in a
        number of ways while still achieving the desired effect.

ocil_clause: 'audit records for user switch events are missing.'

ocil: |-
    Check that the following lines appear in the <tt>/etc/audit/audit.rules</tt> file:
    <pre>-a always,exit -F -arch=b32 path=/usr/bin/su -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged-priv_change
    -a always,exit -F -arch=b64 path=/usr/bin/su -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged-priv_change</pre>

    If one or both are missing, add them.
