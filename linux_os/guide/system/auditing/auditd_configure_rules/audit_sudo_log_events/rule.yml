documentation_complete: true

prodtype: rhel8,rhel9,ubuntu2004,ubuntu2204

title: 'Record Attempts to perform maintenance activities'

description: |-
    The {{{ full_name }}} operating system must generate audit records for
    privileged activities, nonlocal maintenance, diagnostic sessions and
    other system-level access.

    Verify the operating system audits activities performed during nonlocal
    maintenance and diagnostic sessions. Run the following command:
    <pre>$ sudo auditctl -l | grep sudo.log
    -w /var/log/sudo.log -p wa -k maintenance</pre>

rationale: |-
    If events associated with nonlocal administrative access or diagnostic
    sessions are not logged, a major tool for assessing and investigating
    attacks would not be available.
    This requirement addresses auditing-related issues associated with
    maintenance tools used specifically for diagnostic and repair actions
    on organizational information systems.
    Nonlocal maintenance and diagnostic activities are those activities
    conducted by individuals communicating through a network, either an
    external network (e.g., the internet) or an internal network. Local
    maintenance and diagnostic activities are those activities carried
    out by individuals physically present at the information system or
    information system component and not communicating across a network
    connection.
    This requirement applies to hardware/software diagnostic test
    equipment or tools. This requirement does not cover hardware/software
    components that may support information system maintenance, yet are a
    part of the system, for example, the software implementing "ping,"
    "ls," "ipconfig," or the hardware and software implementing the
    monitoring port of an Ethernet switch.

severity: medium

identifiers:
    cce@rhel8: CCE-86432-2
    cce@rhel9: CCE-86433-0

references:
    cis@rhel8: 4.1.3.3
    cis@rhel9: 4.1.3.3
    disa: CCI-000172,CCI-002884
    srg: SRG-OS-000392-GPOS-00172,SRG-OS-000471-GPOS-00215
    stigid@ubuntu2004: UBTU-20-010244

ocil_clause: 'Audit rule is not present'

ocil: |-
    Verify the operating system audits activities performed during nonlocal
    maintenance and diagnostic sessions. Run the following command:
    <pre>$ sudo auditctl -l | grep sudo.log
    -w /var/log/sudo.log -p wa -k maintenance
    </pre>

template:
    name: audit_rules_login_events
    vars:
        path: /var/log/sudo.log
