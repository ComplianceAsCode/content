documentation_complete: true

prodtype: sle12

title: 'Configure a Sufficiently Large Partition for Audit Logs'

description: |-
    The SUSE operating system must allocate audit record storage capacity to
    store at least one weeks worth of audit records when audit records are not
    immediately sent to a central audit record storage facility.

    The partition size needed to capture a week's worth of audit records is
    based on the activity level of the system and the total storage capacity
    available. In normal circumstances, 10.0 GB of storage space for audit
    records will be sufficient.

    Check the size of the partition that audit records are written to with the
    following command:

    <pre># df -h /var/log/audit/
    /dev/sda2 24G 10.4G 13.6G 43% /var/log/audit</pre>

rationale: |-
    Information stored in one location is vulnerable to accidental or incidental
    deletion or alteration.Off-loading is a common process in information systems
    with limited audit storage capacity.

severity: medium

identifiers:
    cce@rhel7: 80541-6
    cce@rhel8: 80925-1

references:
    disa: "1851"
    srg: SRG-OS-000342-GPOS-00133
    vmmsrg: SRG-OS-000051-VMM-000230,SRG-OS-000058-VMM-000270,SRG-OS-000059-VMM-000280,SRG-OS-000479-VMM-001990,SRG-OS-000479-VMM-001990
    stigid@sle12: "020020"
    ospp: FAU_GEN.1.1.c

ocil_clause: 'audispd is not sending logs to a remote system and the local partition is insufficiently large'

ocil: |-
    To verify whether audispd plugin off-loads audit records onto a different system or
    media from the system being audited, run the following command:
{{% if product in ["rhel8", "fedora", "ol8"] %}}
    <pre>$ sudo grep -i remote_server /etc/audit/audisp-remote.conf</pre>
{{% else %}}
    <pre>$ sudo grep -i remote_server /etc/audisp/audisp-remote.conf</pre>
{{% endif %}}
    The output should return something similar to where <i>REMOTE_SYSTEM</i>
    is an IP address or hostname:
    <pre>remote_server = <i>REMOTE_SYSTEM</i></pre>

    Check the size of the partition that audit records are written to with the
    following command and verify whether it is sufficiently large:

    <pre># df -h /var/log/audit/
    /dev/sda2 24G 10.4G 13.6G 43% /var/log/audit</pre>


platform: machine
