documentation_complete: true

prodtype: sle12

title: 'Configure a Sufficiently Large Partition for Audit Logs'

description: |-
    The SUSE operating system must allocate audit record storage capacity to
    store at least one weeks worth of audit records when audit records are not
    immediately sent to a central audit record storage facility.

    The partition size needed to capture a week's worth of audit records is
    based on the activity level of the system and the total storage capacity
    available. In normal circumstances, 10.0 GB of storage space for audit
    records will be sufficient.

    Determine which partition the audit records are being written to with the
    following command:

    <pre># grep log_file /etc/audit/auditd.conf
    log_file = /var/log/audit/audit.log</pre>

    Check the size of the partition that audit records are written to with the
    following command:

    <pre># df -h /var/log/audit/
    /dev/sda2 24G 10.4G 13.6G 43% /var/log/audit</pre>

rationale: |-
    Information stored in one location is vulnerable to accidental or incidental
    deletion or alteration.Off-loading is a common process in information
    systems with limited audit storage capacity.

severity: medium

identifiers:
    cce@sle12: CCE-83114-9

references:
    disa@sle12: CCI-001849
    srg@sle12: SRG-OS-000342-GPOS-00133
    stigid@sle12: SLES-12-020020 

ocil_clause: 'audispd is not sending logs to a remote system and the local partition has inadequate'

ocil: |-
    To verify whether audispd plugin off-loads audit records onto a different
    system or media from the system being audited, run the following command:

    <pre># grep -i remote_server /etc/audisp/audisp-remote.conf</pre>

    The output should return something similar to where <i>REMOTE_SYSTEM</i>
    is an IP address or hostname:
    <pre>remote_server = <i>REMOTE_SYSTEM</i></pre>

    Determine which partition the audit records are being written to with the
    following command:

    <pre># grep log_file /etc/audit/auditd.conf
    log_file = /var/log/audit/audit.log</pre>

    Check the size of the partition that audit records are written to with the
    following command and verify whether it is sufficiently large:

    <pre># df -h /var/log/audit/
    /dev/sda2 24G 10.4G 13.6G 43% /var/log/audit</pre>


platform: machine
