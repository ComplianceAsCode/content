documentation_complete: true

prodtype: fedora,ol8,rhcos4,rhel8,rhel9

title: 'Disable the use of user namespaces'

description: |-
    {{{ describe_sysctl_option_value(sysctl="user.max_user_namespaces", value="0") }}}
    When containers are deployed on the machine, the value should be set
    to large non-zero value.

rationale: |-
    User namespaces are used primarily for Linux containers. The value 0
    disallows the use of user namespaces.

warnings:
    - general: |-
       This configuration baseline was created to deploy the base operating system for general purpose
       workloads. When the operating system is configured for certain purposes, such as to host Linux Containers,
       it is expected that <tt>user.max_user_namespaces</tt> will be enabled.

severity: low

identifiers:
    cce@rhcos4: CCE-82503-4
    cce@rhel8: CCE-82211-4
    cce@rhel9: CCE-83956-3

references:
    disa: CCI-000366
    nist: SC-39,CM-6(a)
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000480-GPOS-00227
    stigid@rhel8: RHEL-08-040284

{{{ complete_ocil_entry_sysctl_option_value(sysctl="user.max_user_namespaces", value="0") }}}

platform: machine

template:
    name: sysctl
    vars:
        sysctlvar: user.max_user_namespaces
        sysctlval: '0'
        datatype: int
