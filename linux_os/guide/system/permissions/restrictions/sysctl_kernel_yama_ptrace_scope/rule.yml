documentation_complete: true


title: 'Restrict usage of ptrace to descendant processes'

description: '{{{ describe_sysctl_option_value(sysctl="kernel.yama.ptrace_scope", value="1") }}}'

rationale: |
    Unrestricted usage of ptrace allows compromised binaries to run ptrace
    on another processes of the user. Like this, the attacker can steal
    sensitive information from the target processes (e.g. SSH sessions, web browser, ...)
    without any additional assistance from the user (i.e. without resorting to phishing).

severity: medium

identifiers:
    cce@rhcos4: CCE-82501-8
    cce@rhel7: CCE-81058-0
    cce@rhel8: CCE-80953-3
    cce@rhel9: CCE-83965-4
    cce@sle12: CCE-91572-8
    cce@sle15: CCE-91262-6

references:
    anssi: BP28(R25)
    cis@rhel7: 1.4.2
    cis@rhel8: 1.4.2
    disa: CCI-000366
    nist: SC-7(10)
    srg: SRG-OS-000132-GPOS-00067,SRG-OS-000480-GPOS-00227
    stigid@ol8: OL08-00-040282
    stigid@rhel8: RHEL-08-040282
    stigid@rhel9: RHEL-09-213080

{{{ complete_ocil_entry_sysctl_option_value(sysctl="kernel.yama.ptrace_scope", value="1") }}}

fixtext: |-
    Configure {{{ full_name }}} to restrict usage of ptrace to descendant processes.
    {{{ fixtext_sysctl(sysctl="kernel.yama.ptrace_scope", value="1") | indent(4) }}}

srg_requirement: '{{{ full_name }}} must restrict usage of ptrace to descendant processes.'

platform: machine

template:
    name: sysctl
    vars:
        sysctlvar: kernel.yama.ptrace_scope
        sysctlval: '1'
        datatype: int
