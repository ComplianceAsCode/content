documentation_complete: true

prodtype: fedora,ocp4,ol7,ol8,rhel7,rhel8

title: 'Enable SLUB/SLAB allocator poisoning'

description: |-
    To enable poisoning of SLUB/SLAB objects,
    add the argument <tt>slub_debug=P</tt> to the default
    GRUB 2 command line for the Linux operating system in
    <tt>/etc/default/grub</tt>, in the manner below:
    <pre>GRUB_CMDLINE_LINUX="slub_debug=P"</pre>

rationale: |-
    Poisoning writes an arbitrary value to freed objects, so any modification or
    reference to that object after being freed or before being initialized will be
    detected and prevented.
    This prevents many types of use-after-free vulnerabilities at little performance cost.
    Also prevents leak of data and detection of corrupted memory.

severity: medium

identifiers:
    cce@rhel7: 82157-9
    cce@rhel8: 80945-9
    cce@ocp4: 82672-7

references:
    srg: SRG-OS-000433-GPOS-00192
    nist: CM-6(a)

ocil_clause: 'SLUB/SLAB poisoning is not enabled'

ocil: |-
    Inspect the form of default GRUB 2 command line for the Linux operating system
    in <tt>/etc/default/grub</tt>. If they include <tt>slub_debug=P</tt>,
    then SLUB/SLAB poisoning is enabled at boot time.
    <br /><br />
    To ensure <tt>slub_debug=P</tt> is configured on all installed kernels, the
    following command may be used:
    <br />
    <pre>$ sudo /sbin/grubby --update-kernel=ALL --args="slub_debug=P</pre>
    <br />

warnings:
    - management: |-
        The GRUB 2 configuration file, <tt>grub.cfg</tt>,
        is automatically updated each time a new kernel is installed. Note that any
        changes to <tt>/etc/default/grub</tt> require rebuilding the <tt>grub.cfg</tt>
        file. To update the GRUB 2 configuration file manually, use the
        <pre>grub2-mkconfig -o</pre> command as follows:
        <ul>
        <li>On BIOS-based machines, issue the following command as <tt>root</tt>:
        <pre>~]# grub2-mkconfig -o /boot/grub2/grub.cfg</pre></li>
        <li>On UEFI-based machines, issue the following command as <tt>root</tt>:
{{% if product in ["rhel7", "rhel8", "ol7", "ol8"] %}}
        <pre>~]# grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg</pre></li>
{{% else %}}
        <pre>~]# grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg</pre></li>
{{% endif %}}
        </ul>

platform: machine

template:
    name: grub2_bootloader_argument
    vars:
        arg_name: slub_debug
        arg_value: P
