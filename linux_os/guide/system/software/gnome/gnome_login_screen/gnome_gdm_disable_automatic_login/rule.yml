documentation_complete: true

prodtype: fedora,ol7,ol8,rhel6,rhel7,rhel8

title: 'Disable GDM Automatic Login'

description: |-
    The GNOME Display Manager (GDM) can allow users to automatically login without
    user interaction or credentials. User should always be required to authenticate themselves
    to the system that they are authorized to use. To disable user ability to automatically
    login to the system, set the <tt>AutomaticLoginEnable</tt> to <tt>false</tt> in the
    <tt>[daemon]</tt> section in <tt>/etc/gdm/custom.conf</tt>. For example:
    <pre>[daemon]
    AutomaticLoginEnable=false</pre>

rationale: |-
    Failure to restrict system access to authenticated users negatively impacts operating
    system security.

severity: high

identifiers:
    cce@rhel7: 80104-3
    cce@rhel8: 80823-8

references:
    cui: 3.1.1
    disa: "366"
    nist: CM-6(a),AC-6(1),CM-7(b)
    nist-csf: PR.IP-1
    ospp: FIA_AFL.1
    srg: SRG-OS-000480-GPOS-00229
    stigid@rhel7: "010440"
    isa-62443-2013: 'SR 7.6'
    isa-62443-2009: 4.3.4.3.2,4.3.4.3.3
    cobit5: BAI10.01,BAI10.02,BAI10.03,BAI10.05
    iso27001-2013: A.12.1.2,A.12.5.1,A.12.6.2,A.14.2.2,A.14.2.3,A.14.2.4
    cis-csc: 11,3,9

ocil_clause: 'GDM allows users to automatically login'

ocil: |-
    To verify that automatic logins are disabled, run the following command:
    <pre>$ grep -Pzoi "^\[daemon]\\nautomaticlogin.*" /etc/gdm/custom.conf</pre>
    The output should show the following:
    <pre>[daemon]
    AutomaticLoginEnable=false</pre>

platform: machine
