<!-- DO NOT TEMPLATE this check. dracut-fips-aesni should only be installed on
 certified systems, and changes to this file should be scrutinized through the
 review process.
-->
<def-group>
  <definition class="compliance" id="package_dracut-fips-aesni_installed"
  version="1">
    <metadata>
      <title>Package dracut-fips-aesni Installed</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 6</platform>
        <platform>Red Hat Enterprise Linux 7</platform>
        <platform>Oracle Linux 7</platform>
      </affected>
      <description>The RPM package dracut-fips-aesni should be installed.</description>
    </metadata>
    <criteria operator="OR">
      <criterion comment="System does not support AES instruction set" test_ref="test_processor_aes_instruction" />
      <criterion comment="package dracut-fips-aesni is installed"
      test_ref="test_package_dracut-fips-aesni_installed" />
    </criteria>
  </definition>

  <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="query /proc/cpuinfo" id="test_processor_aes_instruction" version="1">
    <ind:object object_ref="object_processor_aes_instruction" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="object_processor_aes_instruction" version="1">
    <ind:filepath>/proc/cpuinfo</ind:filepath>
    <ind:pattern operation="pattern match">^[\s]*flags[\s]*:[\s]*.*aes.*$</ind:pattern>
    <ind:instance datatype="int" operation="equals">1</ind:instance>
  </ind:textfilecontent54_object>

  <linux:rpminfo_test check="all" check_existence="all_exist"
  id="test_package_dracut-fips-aesni_installed" version="1"
  comment="package dracut-fips-aesni is installed">
    <linux:object object_ref="obj_package_dracut-fips-aesni_installed" />
  </linux:rpminfo_test>
  <linux:rpminfo_object id="obj_package_dracut-fips-aesni_installed" version="1">
    <linux:name>dracut-fips-aesni</linux:name>
  </linux:rpminfo_object>
</def-group>
