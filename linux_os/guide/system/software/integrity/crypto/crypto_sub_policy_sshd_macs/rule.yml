documentation_complete: true

title: Implement Custom Crypto Policy for SSHD MACs

{{% set module_name = "NO-SSHWEAKMACS" %}}
{{% set key = "mac@SSH" %}}
{{% set value = "-HMAC-MD5* -UMAC-64* -UMAC-128*" %}}

description: |-
    Create a custom crypto policy module for SSHD to enforce the use of strong MACs.
    {{{ describe_crypto_sub_policy(module_name, key, value) }}}

rationale: |-
    Message Authentication Codes (MACs) are cryptographic mechanisms used to verify the
    integrity and authenticity of data transmitted over SSH connections. Weak MACs that
    are used for authentication to the cryptographic module cannot be relied upon to
    provide integrity, and system data may be compromised. Implementing a custom crypto
    policy that disables weak MAC algorithms helps ensure that only strong, proven
    cryptographic algorithms are used to protect SSH communications.

severity: medium

identifiers:
    cce@rhel8: CCE-86952-9

references:

ocil_clause: 'the custom crypto policy module for SSH does not exist'

ocil: |-
    {{{ ocil_crypto_sub_policy(module_name, key, value) }}}

template:
    name: crypto_sub_policy
    vars:
        module_name: {{{ module_name }}}
        key: {{{ key }}}
        value: {{{ value }}}
