documentation_complete: true

prodtype: alinux3,ol7,ol8,ol9,rhcos4,rhel7,rhel8,rhel9,rhv4,sle12,sle15

title: 'Verify and Correct Ownership with RPM'

description: |-
    The RPM package management system can check file ownership
    permissions of installed software packages, including many that are
    important to system security. After locating a file with incorrect
    permissions, which can be found with
    <pre>rpm -Va | awk '{ if (substr($0,6,1)=="U" || substr($0,7,1)=="G") print $NF }'</pre>
    run the following command to determine which package owns it:
    <pre>$ rpm -qf <i>FILENAME</i></pre>
    Next, run the following command to reset its permissions to
    the correct values:
    <pre>$ sudo rpm --setugids <i>PACKAGENAME</i></pre>

rationale: |-
    Ownership of binaries and configuration files that is incorrect
    could allow an unauthorized user to gain privileges that they should
    not have. The ownership set by the vendor should be maintained. Any
    deviations from this baseline should be investigated.

severity: high

identifiers:
    cce@rhcos4: CCE-82686-7
    cce@rhel7: CCE-80545-7
    cce@rhel8: CCE-82196-7
    cce@rhel9: CCE-90842-6
    cce@sle12: CCE-91649-4
    cce@sle15: CCE-91290-7

references:
    cis-csc: 1,11,12,13,14,15,16,18,3,5,6,9
    cis@alinux3: 6.1.1
    cis@rhel7: 1.7.1.4,1.7.1.5,1.7.1.6,6.1.1,6.1.2,6.1.3,6.1.4,6.1.5,6.1.6,6.1.7,6.1.8,6.1.9
    cis@rhel8: 1.8.1.4,1.8.1.5,1.8.1.6,6.1.1,6.1.2,6.1.3,6.1.4,6.1.5,6.1.6,6.1.7,6.1.8,6.1.9
    cis@rhel9: 6.1.15
    cis@sle12: 6.1.1
    cis@sle15: 6.1.1
    cjis: 5.10.4.1
    cobit5: APO01.06,APO11.04,BAI03.05,BAI10.01,BAI10.02,BAI10.03,BAI10.05,DSS05.04,DSS05.07,DSS06.02,MEA02.01
    cui: 3.3.8,3.4.1
    disa: CCI-001494,CCI-001496
    isa-62443-2009: 4.3.3.3.9,4.3.3.5.8,4.3.3.7.3,4.3.4.3.2,4.3.4.3.3,4.3.4.4.7,4.4.2.1,4.4.2.2,4.4.2.4
    isa-62443-2013: 'SR 2.1,SR 2.10,SR 2.11,SR 2.12,SR 2.8,SR 2.9,SR 5.2,SR 7.6'
    iso27001-2013: A.10.1.1,A.11.1.4,A.11.1.5,A.11.2.1,A.12.1.2,A.12.4.1,A.12.4.2,A.12.4.3,A.12.4.4,A.12.5.1,A.12.6.2,A.12.7.1,A.13.1.1,A.13.1.3,A.13.2.1,A.13.2.3,A.13.2.4,A.14.1.2,A.14.1.3,A.14.2.2,A.14.2.3,A.14.2.4,A.6.1.2,A.7.1.1,A.7.1.2,A.7.3.1,A.8.2.2,A.8.2.3,A.9.1.1,A.9.1.2,A.9.2.3,A.9.4.1,A.9.4.4,A.9.4.5
    nerc-cip: CIP-003-8 R4.2,CIP-003-8 R6,CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2
    nist: CM-6(d),CM-6(c),SI-7,SI-7(1),SI-7(6),AU-9(3)
    nist-csf: PR.AC-4,PR.DS-5,PR.IP-1,PR.PT-1
    pcidss: Req-11.5
    srg: SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000278-GPOS-00108
    stigid@ol7: OL07-00-010010
    stigid@rhel7: RHEL-07-010010

ocil_clause: 'there is output'

ocil: |-
    The following command will list which files on the system have ownership different from what
    is expected by the RPM database:
    <pre>$ rpm -Va | rpm -Va --nofiledigest | awk '{ if (substr($0,6,1)=="U" || substr($0,7,1)=="G") print $NF }'</pre>

fixtext: |-
    Run the following command to determine which package owns the file:

    $ sudo rpm -qf [path to file]

    Reset the user and group ownership of files within a package with the following command:

    $ sudo rpm --setugids [package]

srg_requirement: '{{{ full_name }}} must be configured so that the file ownership and group membership of system files and commands match the vendor values.'

warnings:
    - general: |-
        Profiles may require that specific files be owned by root while the default owner defined
        by the vendor is different.
        Such files will be reported as a finding and need to be evaluated according to your policy
        and deployment environment.
