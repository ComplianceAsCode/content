{{% if "Red Hat" in full_name %}}
{{% set vendor = "Red Hat" %}}
{{% set url = "https://access.redhat.com/errata-search/" %}}
{{% elif "ol" in product %}}
{{% set vendor = "Oracle" %}}
{{% set url = "https://linux.oracle.com/errata/" %}}
{{% endif %}}
srg_requirement: |-
    {{{ full_name }}} vendor packaged system security patches and updates must be installed and up to date.

vuldiscussion: |-
    Installing software updates is a fundamental mitigation against
    the exploitation of publicly-known vulnerabilities. If the most
    recent security patches and updates are not installed, unauthorized
    users may take advantage of weaknesses in the unpatched software. The
    lack of prompt attention to patching could result in a system compromise.

checktext: |-
    Verify {{{ full_name }}} security patches and updates are installed and up to date.    Updates are required to be applied with a frequency determined by organizational policy.

    {{% if "Red Hat" in full_name or "ol" in product %}}
    Obtain the list of available package security updates from {{{ vendor }}}. The URL for updates
    is {{{ url }}}.    It is important to note that updates provided by {{{ vendor }}} may not be
    present on the system if the underlying packages are not installed.
    {{% endif %}}

    Check that the available package security updates have been installed on the system with the following command:

    $ dnf history list | more

        ID | Command line | Date and time | Action(s) | Altered
    -------------------------------------------------------------------------------
       70 | install aide | 2020-03-05 10:58 | Install | 1
       69 | update -y | 2020-03-04 14:34 | Update | 18 EE
       68 | install vlc | 2020-02-21 17:12 | Install | 21
       67 | update -y | 2020-02-21 17:04 | Update | 7 EE

    Typical update frequency may be overridden by Information Assurance Vulnerability Alert (IAVA) notifications from CYBERCOM.

    If the system is in non-compliance with the organizational patching policy, this is a finding.

fixtext: |-
    Install {{{ full_name }}} security patches and updates at the organizationally-defined frequency. If system updates are installed via a centralized repository that is configured on the system, you can install all updates with the following command:

    $ sudo dnf update
