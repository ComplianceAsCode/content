documentation_complete: true

prodtype: fedora,ol7,ol8,rhel6,rhel7,rhel8,rhv4

title: 'Ensure gpgcheck Enabled for All {{{ pkg_manager }}} Package Repositories'

description: |-
    To ensure signature checking is not disabled for
    any repos, remove any lines from files in <tt>/etc/yum.repos.d</tt> of the form:
    <pre>gpgcheck=0</pre>

rationale: |-
    Verifying the authenticity of the software prior to installation validates
    the integrity of the patch or upgrade received from a vendor. This ensures
    the software has not been tampered with and that it has been provided by a
    trusted vendor. Self-signed certificates are disallowed by this
    requirement. Certificates used to verify the software must be from an
    approved Certificate Authority (CA)."

severity: high

identifiers:
    cce@rhel6: 26647-8
    cce@rhel7: 26876-3
    cce@rhel8: 80792-5

references:
    stigid@rhel6: "000015"
    srg@rhel6: SRG-OS-000103
    srg: SRG-OS-000366-GPOS-00153
    vmmsrg: SRG-OS-000366-VMM-001430,SRG-OS-000370-VMM-001460,SRG-OS-000404-VMM-001650
    disa@rhel6: 352,663
    cjis: 5.10.4.1
    cui: 3.4.8
    disa: "1749"
    hipaa: 164.308(a)(1)(ii)(D),164.312(b),164.312(c)(1),164.312(c)(2),164.312(e)(2)(i)
    nist: CM-5(3),SI-7,SC-12,SC-12(3),CM-6(a),SA-12,SA-12(10),CM-11(a),CM-11(b)
    nist-csf: PR.DS-6,PR.DS-8,PR.IP-1
    ospp: FAU_GEN.1.1.c
    pcidss: Req-6.2
    isa-62443-2013: 'SR 3.1,SR 3.3,SR 3.4,SR 3.8,SR 7.6'
    isa-62443-2009: 4.3.4.3.2,4.3.4.3.3,4.3.4.4.4
    cobit5: APO01.06,BAI03.05,BAI06.01,BAI10.01,BAI10.02,BAI10.03,BAI10.05,DSS06.02
    iso27001-2013: A.11.2.4,A.12.1.2,A.12.2.1,A.12.5.1,A.12.6.2,A.14.1.2,A.14.1.3,A.14.2.2,A.14.2.3,A.14.2.4
    cis-csc: 11,2,3,9
    anssi: NT28(R15)

ocil_clause: 'GPG checking is disabled'

ocil: |-
    To determine whether <tt>{{{ pkg_manager }}}</tt> has been configured to disable
    <tt>gpgcheck</tt> for any repos,  inspect all files in
    <tt>/etc/yum.repos.d</tt> and ensure the following does not appear in any
    sections:
    <pre>gpgcheck=0</pre>
    A value of <tt>0</tt> indicates that <tt>gpgcheck</tt> has been disabled for that repo.
