documentation_complete: true

prodtype: alinux2,alinux3,fedora,ol7,ol8,ol9,rhel7,rhel8,rhel9,sle12,sle15

title: 'Ensure All Accounts on the System Have Unique User IDs'

description: 'Change user IDs (UIDs), or delete accounts, so each has a unique name.'

rationale: 'To assure accountability and prevent unauthenticated access, interactive users must be identified and authenticated to prevent potential misuse and compromise of the system.'

severity: medium

identifiers:
    cce@rhel7: CCE-85857-1
    cce@rhel8: CCE-89903-9
    cce@rhel9: CCE-88493-2
    cce@sle12: CCE-83196-6
    cce@sle15: CCE-83277-4

references:
    cis@alinux2: 6.2.16
    cis@alinux3: 6.2.12
    cis@rhel7: 6.2.7
    cis@rhel8: 6.2.3
    cis@sle12: 6.2.14
    cis@sle15: 6.2.14
    disa: CCI-000135,CCI-000764,CCI-000804
    nist@sle12: IA-2,IA-2.1,IA-8,IA-8.1
    srg: SRG-OS-000104-GPOS-00051,SRG-OS-000121-GPOS-00062,SRG-OS-000042-GPOS-00020
    stigid@ol8: OL08-00-020240
    stigid@rhel8: RHEL-08-020240
    stigid@sle12: SLES-12-010640
    stigid@sle15: SLES-15-010230

# The rule check uses password probe, which doesn't support offline mode
platform: machine

ocil_clause: 'a line is returned'

ocil: |-
    Run the following command to check for duplicate account names:
    Check that the operating system contains no duplicate UIDs for interactive users by running the following command:
    <pre># awk -F ":" 'list[$3]++{print $1, $3}' /etc/passwd</pre>
    If output is produced, this is a finding.
    Configure the operating system to contain no duplicate UIDs for interactive users.
    Edit the file "/etc/passwd" and provide each interactive user account that has a duplicate UID with a unique UID.

warnings:
    - general: |-
        Automatic remediation of this control is not available due to unique requirements of each
        system.

fixtext: |-
    Edit the file "/etc/passwd" and provide each interactive user account that has a duplicate User ID (UID) with a unique UID.

srg_requirement: |-
        {{{ full_name }}} duplicate User IDs (UIDs) must not exist for interactive users.
