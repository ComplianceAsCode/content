documentation_complete: true

prodtype: rhel7,fedora,ol7

title: 'Set Password Retry Prompts Permitted Per-Session'

description: |-
    To configure the number of retry prompts that are permitted per-session:
    Edit the <tt>pam_pwquality.so</tt> statement in <tt>/etc/pam.d/system-auth</tt> to
    show <tt>retry=<sub idref="var_password_pam_retry" /></tt>, or a lower value if
    site policy is more restrictive.
    The DoD requirement is a maximum of 3 prompts per session.

rationale: |-
    Setting the password retry prompts that are permitted on a per-session basis to a low value
    requires some software, such as SSH, to re-connect. This can slow down and
    draw additional attention to some types of password-guessing attacks. Note that this
    is different from account lockout, which is provided by the pam_faillock module.

severity: unknown

identifiers:
    cce@rhel7: 27160-1

references:
    cis: 6.3.2
    cjis: 5.5.3
    disa: "366"
    nist: CM-6(b),IA-5(c)
    ospp@rhel7: FMT_MOF_EXT.1
    srg: SRG-OS-000480-GPOS-00225
    stigid@rhel7: "010119"

ocil_clause: 'it is not the required value'

ocil: |-
    To check how many retry attempts are permitted on a per-session basis, run the following command:
    <pre>$ grep pam_pwquality /etc/pam.d/system-auth</pre>
    The <tt>retry</tt> parameter will indicate how many attempts are permitted.
    The DoD required value is less than or equal to 3.
    This would appear as <tt>retry=3</tt>, or a lower value.
