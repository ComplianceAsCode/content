documentation_complete: true

prodtype: sle12

title: 'Set Password Retry Limit'

description: |-
    The pam_cracklib module's <tt>retry</tt> parameter controls the maximum
    number of times to prompt the user for the password before returning
    with error. Make sure it it configured with a value that is no more than
    three (3). For example, <tt>retry=1</tt>.

rationale: |-
    To reduce opportunities for successful guesses and brute-force attacks.

severity: medium

identifiers:
    cce@sle12: CCE-83174-3

references:
    disa@sle12: CCI-000366
    stigid@sle12: SLES-12-010320
    nist@sle12: CM-6(b),CM-6.1
    srg@sle12: SRG-OS-000480-GPOS-00225

ocil_clause: 'retry is not found or not set to the required value (or lower)'

ocil: |-
    Check the password retry limit with the following command:

    <pre># grep pam_cracklib.so /etc/pam.d/common-password
    password requisite pam_cracklib.so retry=3</pre>

    If the command does not return anything, or the returned line is
    commented out, this is a finding.

    If the value of "retry" is greater than 3, this is a finding.

template:
    name: pam_options
    vars:
      path: /etc/pam.d/common-password
      type: password
      control_flag: requisite
      module: pam_cracklib.so
      arguments:
        - argument: retry
          argument_match: (?:[1-3])
          argument_value: 3
          new_argument: retry=3
