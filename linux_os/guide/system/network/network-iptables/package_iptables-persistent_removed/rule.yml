documentation_complete: true


title: 'Remove iptables-persistent Package'

description: |-
    {{{ describe_package_remove(package="iptables-persistent") }}}

rationale: |-
    Running both <tt>ufw</tt> and the services included in the
    <tt>iptables-persistent</tt> package may lead to conflict.

severity: medium

references:
    cis@ubuntu2004: 3.5.1.2
    cis@ubuntu2204: 3.5.1.2

ocil_clause: 'the package is installed'

ocil: '{{{ ocil_package(package="iptables-persistent") }}}'

{{%- if product in [ "ubuntu2404", "debian12" ] %}}
platform: system_with_kernel and package[ufw]

template:
    name: package_removed_guard_var
    vars:
        pkgname: iptables-persistent
        variable: var_network_filtering_service
        value: iptables
{{%- else %}}
platform: system_with_kernel

template:
    name: package_removed
    vars:
        pkgname: iptables-persistent
{{%- endif %}}

fixtext: |-
    {{{ describe_package_remove(package="iptables-persistent") }}}
