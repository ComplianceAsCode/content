documentation_complete: true

title: Disable Support for Kernel Modules

description: |-
    Kernel modules are small pieces of compiled code which can be inserted in the running kernel, rather than being permanently built into the kernel.
    If module support isn't neccessary, it must be disabled.

    {{{ describe_kernel_build_config("CONFIG_MODULES", "n") | indent(4) }}}

rationale: |-
    Disabling support for kernel modules will prevent loading unwanted modules.

warnings:
    {{{ warning_kernel_build_config() | indent(4) }}}

severity: low

identifiers:
    cce@rhel7: CCE-86302-7
    cce@rhel8: CCE-86303-5
    cce@rhel9: CCE-86304-3

ocil_clause: 'the kernel was not built with the required value'

ocil: |-
    {{{ ocil_kernel_build_config("CONFIG_MODULES", "n") | indent(4) }}}

template:
    name: kernel_build_config
    vars:
        config: CONFIG_MODULES
        value: 'n'

