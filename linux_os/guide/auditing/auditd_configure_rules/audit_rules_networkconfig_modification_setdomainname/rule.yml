documentation_complete: true

title: "Record Events that Modify the System's Network Environment - setdomainname"

description: |-
    The audit system should collect <tt>setdomainname</tt>
    events for all users and root. If the <tt>auditd</tt> daemon is configured to
    use the <tt>augenrules</tt> program to read audit rules during daemon startup
    (the default), add the following line to a file with suffix <tt>.rules</tt> in
    the directory <tt>/etc/audit/rules.d</tt>, setting ARCH to either b32 for
    32-bit system, or having two lines for both b32 and b64 in case your
    system is 64-bit:
    <pre>-a always,exit -F arch=ARCH -S setdomainname -F auid&gt;={{{ auid }}} -F auid!=unset -F key=system-locale</pre>
    If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>
    utility to read audit rules during daemon startup, add the following line to
    <tt>/etc/audit/audit.rules</tt> file, setting ARCH to either b32 for
    32-bit system, or having two lines for both b32 and b64 in case your
    system is 64-bit:
    <pre>-a always,exit -F arch=ARCH -S setdomainname -F auid&gt;={{{ auid }}} -F auid!=unset -F key=system-locale</pre>

identifiers:
    cce@rhel10: CCE-89916-1

rationale: |-
    Monitoring <tt>setdomainname</tt> will identify potential unauthorized
    changes to host name of a system. The changing of the host name could
    potentially break security parameters that are set based on this name.

severity: medium

{{{ complete_ocil_entry_audit_syscall("setdomainname") }}}

template:
    name: audit_rules_dac_modification
    vars:
        attr: setdomainname
        key: system-locale
        syscall_grouping:
            - sethostname
            - setdomainname
