documentation_complete: true

title: 'Ensure auditd Collects Changes to Cron Jobs - /etc/cron.d/'

description: |-
    At a minimum, the audit system should collect administrator actions
    for all users and root.
    {{{ describe_audit_rules_watch("/etc/cron.d/", "cronjobs") }}}

rationale: |-
    The actions taken by system administrators should be audited to keep a record
    of what was executed on the system, as well as, for accountability purposes.
    Editing the sudoers file may be sign of an attacker trying to
    establish persistent methods to a system, auditing the editing of the sudoers
    files mitigates this risk.

severity: medium

identifiers:
    cce@rhel8: CCE-86606-1
    cce@rhel9: CCE-86613-7
    cce@rhel10: CCE-86464-5
    cce@sle15: CCE-92586-7

references:
    srg: SRG-OS-000471-GPOS-00215
    stigid@sle15: SLES-15-030015


ocil_clause: 'the command does not return a line, or the line is commented out'

ocil: |-
    {{{ ocil_audit_rules_watch("/etc/cron.d/", "cronjobs") }}}

fixtext: '{{{ fixtext_audit_file_watch_rule("/etc/cron.d/", "cronjobs", "/etc/audit/rules.d/audit.rules") }}}'

srg_requirement: '{{{ srg_requirement_audit_file_watch_rule("/etc/cron.d/") }}}'

template:
    name: audit_rules_watch
    vars:
        path: /etc/cron.d/
        key: actions
