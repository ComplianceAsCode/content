documentation_complete: true

title: 'Ensure auditd Collects Changes to Cron Jobs - /var/spool/cron'

description: |-
    {{{ describe_audit_rules_watch("/var/spool/cron", "cronjobs") }}}

rationale: |-
    In addition to auditing new user and group accounts, these watches
    will alert the system administrator(s) to any modifications. Any unexpected
    users, groups, or modifications should be investigated for legitimacy.

severity: medium

identifiers:
    cce@rhel8: CCE-86635-0
    cce@rhel9: CCE-86636-8
    cce@rhel10: CCE-86564-2
    cce@sle15: CCE-92588-3

references:
    srg: SRG-OS-000363-GPOS-00150,SRG-OS-000363-GPOS-00150,SRG-OS-000446-GPOS-00200,SRG-OS-000447-GPOS-00201
    stigid@ol8: OL08-00-030645
    stigid@ol9: OL09-00-002584
    stigid@sle15: SLES-15-030015

ocil_clause: 'command does not return a line, or the line is commented out'

ocil: |-
    {{{ ocil_audit_rules_watch("/var/spool/cron", "cronjobs") }}}

fixtext: '{{{ fixtext_audit_file_watch_rule("/var/spool/cron", "cronjobs", "/etc/audit/rules.d/audit.rules") }}}'

srg_requirement: '{{{ srg_requirement_audit_file_watch_rule("/var/spool/cron") }}}'

template:
    name: audit_rules_watch
    vars:
        path: /var/spool/cron
        key: cronjobs
