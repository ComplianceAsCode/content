documentation_complete: true

title: 'Ensure SSH LoginGraceTime is configured'

description: |-
    The <tt>LoginGraceTime</tt> parameter to the SSH server specifies the time allowed for successful authentication to
    the SSH server. The longer the Grace period is the more open unauthenticated connections
    can exist. Like other session controls in this session the Grace Period should be limited to
    appropriate limits to ensure the service is available for needed access.

rationale: |-
    Setting the <tt>LoginGraceTime</tt> parameter to a low number will minimize the risk of successful
    brute force attacks to the SSH server. It will also limit the number of concurrent
    unauthenticated connections.

severity: medium

identifiers:
    cce@rhel7: CCE-86550-1
    cce@rhel8: CCE-86551-9
    cce@rhel9: CCE-86552-7

references:
    cis@alinux2: 5.2.15
    cis@alinux3: 5.2.14
    cis@rhel7: 5.3.17
    cis@rhel8: 5.2.19
    cis@sle15: 5.2.14

{{{ complete_ocil_entry_sshd_option(default="no", option="LoginGraceTime", xccdf_variable="var_sshd_set_login_grace_time")}}}

template:
    name: sshd_lineinfile
    vars:
        missing_parameter_pass: 'false'
        parameter: LoginGraceTime
        rule_id: sshd_set_login_grace_time
        value: ''
        xccdf_variable: var_sshd_set_login_grace_time
