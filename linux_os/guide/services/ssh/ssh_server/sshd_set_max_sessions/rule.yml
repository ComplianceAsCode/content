documentation_complete: true

title: 'Set SSH MaxSessions limit'

description: |-
    The <tt>MaxSessions</tt> parameter specifies the maximum number of open sessions permitted
    from a given connection. To set MaxSessions edit
    <tt>/etc/ssh/sshd_config</tt> as follows: <pre>MaxSessions {{{ xccdf_value("var_sshd_max_sessions") }}}</pre>

rationale: |-
    To protect a system from denial of service due to a large number of concurrent
    sessions, use the rate limiting function of MaxSessions to protect availability
    of sshd logins and prevent overwhelming the daemon.

severity: medium

identifiers:
    cce@rhel7: CCE-85856-3
    cce@rhel8: CCE-83357-4
    cce@rhel9: CCE-84103-1

references:
    cis@rhel7: 5.3.22
    cis@rhel8: 5.2.18
    cis@sle12: 5.3.23
    cis@sle15: 5.2.22
    cis@ubuntu2004: 5.2.22

{{{ complete_ocil_entry_sshd_option(default="no", option="MaxSessions", xccdf_variable="var_sshd_max_sessions")}}}

template:
    name: sshd_lineinfile
    vars:
        missing_parameter_pass: 'false'
        parameter: MaxSessions
        rule_id: sshd_set_max_sessions
        value: ''
        xccdf_variable: var_sshd_max_sessions
