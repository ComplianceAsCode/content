documentation_complete: true

title: 'Disable SSH TCP Forwarding'

description: |-
    The <tt>AllowTcpForwarding</tt> parameter specifies whether TCP forwarding is permitted.
    To disable TCP forwarding, add or correct the
    following line in <tt>/etc/ssh/sshd_config</tt>:
    <pre>AllowTcpForwarding no</pre>

rationale: |-
    Leaving port forwarding enabled can expose the organization to security risks and back-doors.

severity: medium

identifiers:
  cce@rhel8: 83301-2

references:
  cis@rhel8: 5.2.17
  cis@sle15: 5.2.21

ocil_clause: "The AllowTcpForwarding option exists and is disabled"

ocil: |-
    {{{ ocil_sshd_option(default="yes", option="AllowTcpForwarding", value="no") }}}

template:
    name: sshd_lineinfile
    vars:
        missing_parameter_pass: 'false'
        parameter: AllowTcpForwarding
        rule_id: sshd_disable_tcp_forwarding
        value: 'no'
