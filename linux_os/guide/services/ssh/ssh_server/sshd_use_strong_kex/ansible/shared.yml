# platform = multi_platform_all
# reboot = false
# strategy = restrict
# complexity = low
# disruption = low

{{{ ansible_instantiate_variables("sshd_strong_kex") }}}

{{%- if product == 'sle16' -%}}
    {{{
        ansible_sshd_set_usr(
                parameter="KexAlgorithms",
                value="{{ sshd_strong_kex }}",
                copy_defaults='true',
                rule_title=rule_title
            )
    }}}
{{%- else -%}}
    {{{
        ansible_sshd_set(
          parameter="KexAlgorithms",
          value="{{ sshd_strong_kex }}",
          config_is_distributed=sshd_distributed_config,
          rule_title=rule_title
        )
    }}}
{{%- endif -%}}
