{{% set sshd_redhat_drop_in_file = sshd_config_dir ~ "/50-redhat.conf" %}}
documentation_complete: true

title: 'The File {{{ sshd_redhat_drop_in_file }}} Must Exist'

description: |-
    The <tt>{{{ sshd_redhat_drop_in_file }}}</tt> file must exist as it contains important
    settings to secure SSH.


rationale: |-
    The file must exist to configure SSH correctly.

identifiers:
    cce@rhel9: CCE-88599-6
    cce@rhel10: CCE-86691-3

references:
    nist: AC-17 (2)
    srg: SRG-OS-000250-GPOS-00093

severity: medium

warnings:
    - general:
        There is no remediation available for this rule since this file
        needs to have the correct content for the given system.


template:
    name: 'file_existence'
    vars:
        filepath: '{{{ sshd_redhat_drop_in_file }}}'
        exists: true
    backends:
        ansible: off
        bash: off

platform: system_with_kernel
