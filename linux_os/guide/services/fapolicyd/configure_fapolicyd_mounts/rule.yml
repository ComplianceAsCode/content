documentation_complete: true

prodtype: rhel8,fedora,ol8

title: 'Enable fapolicyd to watch all system mountpoints'

description: |-
    Configure the <tt>fapolicyd</tt> (File Access Policy Daemon)
    to watch on all system filesystem mountpoints
    in <tt>/etc/fapolicyd/fapolicyd.mounts</tt>.
    An initial configuration may be generated by running
    the following command:
    <pre>mount | egrep '^tmpfs| ext4| ext3| xfs' | awk '{ printf "%s\n", $3 }' | egrep
    -v '^\/run$|^\/sys' > /etc/fapolicyd/fapolicyd.mounts</pre>
    Any mountpoints not listed in /etc/fapolicyd/fapolicyd.mounts will not be
    watched.


rationale: |-
    To control file access for all possible rules, all system
    mountpoints need to be listed.

severity: medium

identifiers:
    cce@rhel8: 82271-8

references:
    ospp: FPT_SRP_EXT.1
    srg: SRG-OS-000370-GPOS-00155

ocil_clause: 'not all system mountpoints are listed'

ocil: |-
    To verify that all system mountpoints are configured to be
    watched by <tt>fapolicyd</tt>, run the following command:
    <pre>$ mount | egrep '^tmpfs| ext4| ext3| xfs' | awk '{ print $3 }' | egrep -v '^\/run$|^\/sys'</pre>
    Check the output against <tt>/etc/fapolicyd/fapolicyd.mounts</tt>
    and make sure that all relevant partitions are listed.
