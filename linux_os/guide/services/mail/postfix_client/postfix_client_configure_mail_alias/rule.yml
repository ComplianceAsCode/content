documentation_complete: true

title: 'Configure System to Forward All Mail For The Root Account'

description: |-
    Make sure that mails delivered to root user are forwarded to a monitored
    email address. Make sure that the address
    {{{ xccdf_value("var_postfix_root_mail_alias") }}} is a valid email address
    reachable from the system in question. Use the following command to
    configure the alias:
    <pre>$ sudo echo "root: {{{ xccdf_value("var_postfix_root_mail_alias") }}}" &gt;&gt; /etc/aliases
    $ sudo newaliases</pre>

rationale: |-
    A number of system services utilize email messages sent to the root user to
    notify system administrators of active or impending issues.  These messages must
    be forwarded to at least one monitored email address.

severity: low

identifiers:
    cce@rhel7: CCE-82380-7
    cce@rhel8: CCE-82381-5
    cce@rhel9: CCE-90826-9
    cce@sle12: CCE-83031-5
    cce@sle15: CCE-85605-4

references:
    disa: CCI-000139,CCI-000366
    nist: CM-6(a)
    stigid@sle12: SLES-12-020050
    stigid@sle15: SLES-15-030580
    srg: SRG-OS-000046-GPOS-00022
    nist@sle12: AU-5(a),AU-5.1(ii)
    anssi: BP28(R49)
    stigid@rhel8: RHEL-08-030030


ocil_clause: 'it is not'

ocil: |-
    Find the list of alias maps used by the Postfix mail server:
    <pre>$ sudo postconf alias_maps</pre>
    Query the Postfix alias maps for an alias for the <i>root</i> user:
    <pre>$ sudo postmap -q root hash:/etc/aliases</pre>
    The output should return an alias.
