documentation_complete: true

title: 'Remove the Server with GUI Package Group'

description: |-
    By removing the <tt>Server with GUI</tt> package group, the system no longer has a graphical user interface (GUI) installed.
    If a GUI is not installed then the system cannot boot into graphical user mode.
    This prevents the system from being accidentally or maliciously booted into a <tt>graphical.target</tt> mode.
    To do so, run the following command:
    <pre>dnf groupremove -y "Server with GUI"</pre>

rationale: |-
    Unnecessary service packages must not be installed to decrease the attack surface of the system.
    If a Graphical User Interface (GUI) is not required, it should be removed to reduce the
    attack surface of the system.

severity: medium

identifiers:
    cce@rhel10: CCE-87443-8

ocil_clause: The Server with GUI package group has not been removed

ocil: |-
    Run the following command to verify the Installed Environment Group is not
    Server with GUI:
    # dnf grouplist | sed -n '/Installed Environment Groups:/,/Installed Groups:/p'
    The output should not contain the Server with GUI group.

fixtext: |-
    Run the following commands to remove the Server with GUI package group:
    # dnf groupinstall -y "Minimal Install"
    Note: This is important to update dependencies to allow the removal of the Server
    with GUI group with minimal impact to the system functionality.
    # dnf groupremove -y "Server with GUI"
    # dnf groupinstall -y "Server"
    # reboot

warnings:
    - general: |-
        This rule doesn't come with an OVAL check, as it is not possible to check if the Server with GUI group is installed using the OVAL rpm objects. Therefore, this rule contains only an SCE check.
