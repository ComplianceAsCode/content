<def-group>
    <definition class="compliance" id="{{{ rule_id }}}" version="1">
        {{{ oval_metadata("The TFTP daemon should use secure mode.") }}}
        <criteria comment="package tftp-server removed or /etc/xinetd.d/tftp configured correctly" operator="OR">
            <extend_definition comment="rpm package tftp-server removed" definition_ref="package_tftp-server_removed"/>
            <criterion comment="tftpd secure mode" test_ref="test_{{{ rule_id }}}"/>
        </criteria>
    </definition>

    <linux:systemdunitproperty_test check="all" comment="tftpd secure mode using systemd" id="test_{{{ rule_id }}}"
                                version="1">
        <linux:object object_ref="object_{{{ rule_id }}}"/>
        <linux:state state_ref="state_{{{ rule_id }}}"/>
    </linux:systemdunitproperty_test>

    <linux:systemdunitproperty_object id="object_{{{ rule_id }}}" version="1">
        <linux:unit>tftp.service</linux:unit>
        <linux:property>ExecStart</linux:property>
    </linux:systemdunitproperty_object>


    <linux:systemdunitproperty_state id="state_{{{ rule_id }}}" version="1">
        <linux:value operation="pattern match">^.+-s ([\w\.\/]+).+$</linux:value>
    </linux:systemdunitproperty_state>
</def-group>
