documentation_complete: true

title: 'tfpd Must Use Secure Mode - systemd'

prodtype: rhel9

description: |-
    If running the Trivial File Transfer Protocol (TFTP) service is necessary,
    it should be configured to change its root directory at startup. To do so,
    find the path for the <tt>tftp</tt> systemd service:
    <pre>$ sudo systemctl show tftp | grep FragmentPath=
    FragmentPath=/etc/systemd/system/tftp.service</pre>

    and ensure the <tt>ExecStart</tt> line on that file includes the <tt>-s</tt> option with a subdirectory:
    <pre>ExecStart=/usr/sbin/in.tftpd -s {{{ xccdf_value("var_tftpd_secure_directory") }}}</pre>


rationale: |-
    Using the <tt>-s</tt> option causes the TFTP service to only serve files from the
    given directory. Serving files from an intentionally-specified directory
    reduces the risk of sharing files which should remain private.


severity: medium

platform: package[tftp-server]

identifiers:
    cce@rhel9: CCE-86763-0

references:
    srg: SRG-OS-000480-GPOS-00227
    stigid@rhel9: RHEL-09-252055

ocil_clause: 'the "ExecStart" line does not have a "-s" option, and a subdirectory is not assigned'

ocil: |-
    Verify the TFTP daemon is configured to operate in secure mode.

    Check if a TFTP server is installed with the following command:


    If a TFTP server is not installed, this is Not Applicable.
    <br /><br />

    If a TFTP server is installed, check for the server arguments with the following command:

    <pre>$ systemctl cat tftp | grep ExecStart=
    ExecStart=/usr/sbin/in.tftpd -s {{{ xccdf_value("var_tftpd_secure_directory") }}}</pre>

srg_requirement: 'If the Trivial File Transfer Protocol (TFTP) server is required, the {{{ full_name }}} TFTP daemon must be configured to operate in secure mode.'
