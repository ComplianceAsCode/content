documentation_complete: true

prodtype: fedora,ol7,ol8,ol9,rhcos4,rhel7,rhel8,rhel9,rhv4

title: 'Install usbguard Package'

description: |-
    {{% if product != "rhcos4" %}}
    {{{ describe_package_install(package="usbguard") }}}
    {{% else %}}
    The <tt>usbguard</tt> package can be installed with the following manifest:
    <pre>
    ---
    apiVersion: machineconfiguration.openshift.io/v1
    kind: MachineConfig
    metadata:
      labels:
        machineconfiguration.openshift.io/role: master
      name: 75-master-usbguard-install
    spec:
      config:
        ignition:
          version: 3.1.0
      extensions:
        - usbguard
    </pre>
    <p>
    This will install the <tt>usbguard</tt> package in all the
    nodes labeled with the "master" role.
    </p>
    {{{ machineconfig_description_footer() | indent(4) }}}
    {{% endif %}}

rationale: |-
    <tt>usbguard</tt> is a software framework that helps to protect
    against rogue USB devices by implementing basic whitelisting/blacklisting
    capabilities based on USB device attributes.

severity: medium

identifiers:
    cce@rhcos4: CCE-82524-0
    cce@rhel7: CCE-82960-6
    cce@rhel8: CCE-82959-8
    cce@rhel9: CCE-84203-9

references:
    disa: CCI-001958
    ism: "1418"
    nist: CM-8(3),IA-3
    srg: SRG-OS-000378-GPOS-00163
    stigid@ol8: OL08-00-040139
    stigid@rhel8: RHEL-08-040139

ocil_clause: 'the package is not installed'

ocil: '{{{ ocil_package(package="usbguard") }}}'

template:
    name: package_installed
    vars:
        pkgname: usbguard

fixtext: |-
    {{{ describe_package_install(package="usbguard") }}}

srg_requirement: '{{{ srg_requirement_package_installed("usbguard") }}}'
