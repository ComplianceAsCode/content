policy: 'CIS Benchmark for Red Hat Enterprise Linux 8'
title: 'CIS Benchmark for Red Hat Enterprise Linux 8'
id: cis_rhel8
version: '1.0.1'
source: https://www.cisecurity.org/cis-benchmarks/#red_hat_linux
levels:
  - id: l1_server
  - id: l2_server
    inherits_from:
      - l1_server
  - id: l1_workstation
  - id: l2_workstation
    inherits_from:
      - l1_workstation

controls:
  - id: reload_dconf_db
    title: Reload Dconf database
    levels:
      - l1_server
      - l1_workstation
    notes: <-
      This is a helper rule to reload Dconf datbase correctly.
    automated: yes
    rules:
      - dconf_db_up_to_date

  - id: 1.1.1.1
    title: Ensure mounting of cramfs filesystems is disabled (Automated)
    levels:
      - l1_workstation
      - l1_server
    automated: yes
    rules:
      - kernel_module_cramfs_disabled

  - id: 1.1.1.2
    title: Ensure mounting of vFAT filesystems is limited (Manual)
    levels:
      - l2_workstation
      - l2_server
    automated: no
    related_rules:
      - kernel_module_vfat_disabled

  - id: 1.1.1.3
    title: Ensure mounting of squashfs filesystems is disabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - kernel_module_squashfs_disabled

  - id: 1.1.1.4
    title: Ensure mounting of udf filesystems is disabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - kernel_module_udf_disabled

  - id: 1.1.2
    title: Ensure /tmp is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - partition_for_tmp

  - id: 1.1.3
    title: Ensure nodev option set on /tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_tmp_nodev

  - id: 1.1.4
    title: Ensure nosuid option set on /tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_tmp_nosuid

  - id: 1.1.5
    title: Ensure noexec option set on /tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_tmp_noexec

  - id: 1.1.6
    title: Ensure separate partition exists for /var (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - partition_for_var

  - id: 1.1.7
    title: Ensure separate partition exists for /var/tmp (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - partition_for_var_tmp

  - id: 1.1.8
    title: Ensure nodev option set on /var/tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_var_tmp_nodev

  - id: 1.1.9
    title: Ensure nosuid option set on /var/tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_var_tmp_nosuid

  - id: 1.1.10
    title: Ensure noexec option set on /var/tmp partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_var_tmp_noexec

  - id: 1.1.11
    title: Ensure separate partition exists for /var/log (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - partition_for_var_log

  - id: 1.1.12
    title: Ensure separate partition exists for /var/log/audit (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - partition_for_var_log_audit

  - id: 1.1.13
    title: Ensure separate partition exists for /home (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - partition_for_home

  - id: 1.1.18
    title: Ensure nodev option set on /home partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_home_nodev

  - id: 1.1.15
    title: Ensure nodev option set on /dev/shm partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_dev_shm_nodev

  - id: 1.1.16
    title: Ensure nosuid option set on /dev/shm partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_dev_shm_nosuid

  - id: 1.1.17
    title: Ensure noexec option set on /dev/shm partition (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - mount_option_dev_shm_noexec

  - id: 1.1.18
    title: Ensure nodev option set on removable media partitions (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    rules:
      - mount_option_nodev_removable_partitions

  - id: 1.1.19
    title: Ensure nosuid option set on removable media partitions (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    rules:
      - mount_option_nosuid_removable_partitions

  - id: 1.1.20
    title: Ensure noexec option set on removable media partitions (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    rules:
      - mount_option_noexec_removable_partitions

  - id: 1.1.22
    title: Disable Automounting (Automated)
    levels:
      - l1_server
      - l2_workstation
    automated: yes
    rules:
      - service_autofs_disabled

  - id: 1.1.23
    title: Disable USB Storage (Automated)
    levels:
      - l1_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_usb-storage_disabled

  - id: 1.2.1
    title: Ensure Red Hat Subscription Manager connection is configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 1.2.2
    title: Disable the rhnsd Daemon (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    related_rules:
      - service_rhnsd_disabled

  - id: 1.2.3
    title: Ensure GPG keys are configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    related_rules:
      - ensure_redhat_gpgkey_installed

  - id: 1.2.4
    title: Ensure gpgcheck is globally activated (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - ensure_gpgcheck_globally_activated

  - id: 1.2.5
    title: Ensure package manager repositories are configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 1.3.1
    title: Ensure sudo is installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_sudo_installed

  - id: 1.3.2
    title: Ensure sudo commands use pty (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sudo_add_use_pty

  - id: 1.3.3
    title: Ensure sudo log file exists (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sudo_custom_logfile

  - id: 1.4.1
    title: Ensure AIDE is installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_aide_installed

  - id: 1.4.2
    title: Ensure filesystem integrity is regularly checked (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - aide_periodic_cron_checking

  - id: 1.5.1
    title: Ensure permissions on bootloader config are configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - file_owner_grub2_cfg
      - file_groupowner_grub2_cfg
      - file_permissions_grub2_cfg

  - id: 1.5.1
    title: Ensure bootloader password is set (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - grub2_password

  - id: 1.5.3
    title: Ensure authentication required for single user mode (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - require_singleuser_auth
      - require_emergency_target_auth

  - id: 1.6.1
    title: Ensure core dumps are restricted (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - disable_users_coredumps
      - sysctl_fs_suid_dumpable
      - coredump_disable_backtraces
      - coredump_disable_storage

  - id: 1.6.2
    title: Ensure address space layout randomization (ASLR) is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_kernel_randomize_va_space

  - id: 1.7.1.1
    title: Ensure SELinux is installed (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - package_libselinux_installed

  - id: 1.7.1.1
    title: Ensure SELinux is installed (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - package_libselinux_installed

  - id: 1.7.1.2
    title: Ensure SELinux is not disabled in bootloader configuration (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - grub2_enable_selinux

  - id: 1.7.1.3
    title: Ensure SELinux policy is configured (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - var_selinux_policy_name=targeted
      - selinux_policytype

  - id: 1.7.1.4
    title: Ensure the SELinux state is enforcing (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - var_selinux_state=enforcing
      - selinux_state

  - id: 1.7.1.5
    title: Ensure no unconfined services exist (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - selinux_confinement_of_daemons

  - id: 1.7.1.6
    title: Ensure SETroubleshoot is not installed (Automated)
    levels:
      - l2_server
    automated: yes
    rules:
      - package_setroubleshoot_removed

  - id: 1.7.1.7
    title: Ensure the MCS Translation Service (mcstrans) is not installed (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - package_mcstrans_removed

  - id: 1.8.1.1
    title: Ensure message of the day is configured properly (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - banner_etc_motd

  - id: 1.8.1.2
    title: Ensure local login warning banner is configured properly (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - banner_etc_issue

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5225
  - id: 1.8.1.3
    title: Ensure remote login warning banner is configured properly (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 1.8.1.4
    title: Ensure permissions on /etc/motd are configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - file_permissions_etc_motd

  - id: 1.8.1.5
    title: Ensure permissions on /etc/issue are configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - file_permissions_etc_issue

  - id: 1.8.2
    title: Ensure GDM login banner is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - dconf_gnome_banner_enabled
      - dconf_gnome_login_banner_text

  - id: 1.9
    title: Ensure updates, patches, and additional security software are installed (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    related_rules:
      - security_patches_up_to_date

  - id: 1.10
    title: Ensure system-wide crypto policy is not legacy (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - configure_crypto_policy

  # This rule works in conjunction with the configure_crypto_policy above.
  # If a system is remediated to CIS Level 1, just the rule above will apply
  # and will enforce the default value for var_system_crypto_policy (DEFAULT).
  # If the system is remediated to Level 2 then this rule will be selected,
  # and the value applied by the rule above will will be overridden to
  # FUTURE through the var_system_crypto_policy variable.
  - id: 1.11
    title: Ensure system-wide crypto policy is FUTURE or FIPS (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - var_system_crypto_policy=future

  - id: 2.1.1
    title: Ensure xinetd is not installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_xinetd_removed

  - id: 2.2.1.1
    title: Ensure time synchronization is in use (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    related_rules:
      - package_chrony_installed

  - id: 2.1.1
    title: Ensure chrony is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_chronyd_enabled
      - chronyd_specify_remote_server
      - chronyd_run_as_chrony_user

  - id: 2.2.2
    title: Ensure chrony is configured (Automated)
    levels:
      - l1_server
    automated: yes
    rules:
      - package_xorg-x11-server-common_removed
      - xwindows_runlevel_target

  - id: 2.2.3
    title: Ensure rsync service is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_rsyncd_disabled

  - id: 2.2.4
    title: Ensure Avahi Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_avahi-daemon_disabled

  - id: 2.2.5
    title: Ensure SNMP Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_snmpd_disabled

  - id: 2.2.6
    title: Ensure HTTP Proxy Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_squid_removed

  - id: 2.2.7
    title: Ensure Samba is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_smb_disabled

  - id: 2.2.8
    title: Ensure IMAP and POP3 server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_dovecot_disabled

  - id: 2.2.9
    title: Ensure HTTP server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_httpd_disabled

  - id: 2.2.10
    title: Ensure FTP Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_vsftpd_disabled

  - id: 2.2.11
    title: Ensure DNS Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_named_disabled

  - id: 2.2.12
    title: Ensure NFS is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_nfs_disabled

  - id: 2.2.13
    title: Ensure RPC is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_rpcbind_disabled

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5231
  - id: 2.2.14
    title: Ensure RPC is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 2.2.15
    title: Ensure DHCP Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_dhcpd_disabled

  - id: 2.2.16
    title: Ensure CUPS is not enabled (Automated)
    levels:
      - l1_server
      - l2_workstation
    automated: yes
    rules:
      - service_cups_disabled

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5232
  - id: 2.2.17
    title: Ensure NIS Server is not enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 2.2.18
    title: Ensure mail transfer agent is configured for local-only mode (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - postfix_network_listening_disabled

  - id: 2.3.1
    title: Ensure NIS Client is not installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_ypbind_removed

  - id: 2.3.2
    title: Ensure telnet client is not installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_telnet_removed

  - id: 2.3.3
    title: Ensure LDAP client is not installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_openldap-clients_removed

  - id: 3.1.1
    title: Ensure IP forwarding is disabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_ip_forward
      - sysctl_net_ipv6_conf_all_forwarding

  - id: 3.1.2
    title: Ensure packet redirect sending is disabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_send_redirects
      - sysctl_net_ipv4_conf_default_send_redirects

  - id: 3.2.1
    title: Ensure source routed packets are not accepted (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_accept_source_route
      - sysctl_net_ipv4_conf_default_accept_source_route
      - sysctl_net_ipv6_conf_all_accept_source_route
      - sysctl_net_ipv6_conf_default_accept_source_route

  - id: 3.2.2
    title: Ensure ICMP redirects are not accepted (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_accept_redirects
      - sysctl_net_ipv4_conf_default_accept_redirects
      - sysctl_net_ipv6_conf_all_accept_redirects
      - sysctl_net_ipv6_conf_default_accept_redirects

  - id: 3.2.3
    title: Ensure secure ICMP redirects are not accepted (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_secure_redirects
      - sysctl_net_ipv4_conf_default_secure_redirects

  - id: 3.2.4
    title: Ensure suspicious packets are logged (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_log_martians
      - sysctl_net_ipv4_conf_default_log_martians

  - id: 3.2.5
    title: Ensure broadcast ICMP requests are ignored (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_icmp_echo_ignore_broadcasts

  - id: 3.2.6
    title: Ensure bogus ICMP responses are ignored (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_icmp_ignore_bogus_error_responses

  - id: 3.2.7
    title: Ensure Reverse Path Filtering is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_conf_all_rp_filter
      - sysctl_net_ipv4_conf_default_rp_filter

  - id: 3.2.8
    title: Ensure TCP SYN Cookies is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_tcp_syncookies

  - id: 3.2.8
    title: Ensure TCP SYN Cookies is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv4_tcp_syncookies

  - id: 3.2.9
    title: Ensure IPv6 router advertisements are not accepted (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - sysctl_net_ipv6_conf_all_accept_ra
      - sysctl_net_ipv6_conf_default_accept_ra

  - id: 3.3.1
    title: Ensure DCCP is disabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_dccp_disabled

  - id: 3.3.2
    title: Ensure SCTP is disabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_sctp_disabled

  - id: 3.3.3
    title: Ensure RDS is disabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_rds_disabled

  - id: 3.3.4
    title: Ensure TIPC is disabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_tipc_disabled

  # NEEDS RULE
  # This rule is currently quite opinionated and expects firewalld
  # as the installed firewall package. But, as per the CIS control,
  # this rule should also be satisfied by nftables or iptables.
  - id: 3.4.1.1
    title: Ensure a Firewall package is installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_firewalld_installed

  - id: 3.4.2.1
    title: Ensure firewalld service is enabled and running (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_firewalld_enabled

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5238
  - id: 3.4.2.2
    title: Ensure iptables service is not enabled with firewalld (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5239
  - id: 3.4.2.3
    title: Ensure nftables is not enabled with firewalld (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.2.4
    title: Ensure firewalld default zone is set (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - set_firewalld_default_zone

  - id: 3.4.2.5
    title: Ensure network interfaces are assigned to appropriate zone (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.2.6
    title: Ensure firewalld drops unnecessary services and ports (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.3.1
    title: Ensure iptables are flushed with nftables (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5244
  - id: 3.4.3.2
    title: Ensure an nftables table exists (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5245
  - id: 3.4.3.3
    title: Ensure nftables base chains exist (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5246
  - id: 3.4.3.4
    title: Ensure nftables loopback traffic is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.3.5
    title: Ensure nftables outbound and established connections are configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5248
  - id: 3.4.3.6
    title: Ensure nftables default deny firewall policy (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5249
  - id: 3.4.3.7
    title: Ensure nftables service is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5250
  - id: 3.4.3.8
    title: Ensure nftables rules are permanent (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5252
  - id: 3.4.4.1.1
    title: Ensure iptables default deny firewall policy (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5253
  - id: 3.4.4.1.2
    title: Ensure iptables loopback traffic is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.4.1.3
    title: Ensure iptables outbound and established connections are configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5255
  - id: 3.4.4.1.4
    title: Ensure iptables firewall rules exist for all open ports (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/7190
  - id: 3.4.4.1.5
    title: Ensure iptables is enabled and active (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5257
  - id: 3.4.4.2.1
    title: Ensure ip6tables default deny firewall policy (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5258
  - id: 3.4.4.2.2
    title: Ensure ip6tables loopback traffic is configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.4.4.2.3
    title: Ensure ip6tables outbound and established connections are configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/7191
  - id: 3.4.4.2.4
    title: Ensure ip6tables firewall rules exist for all open ports (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/7192
  - id: 3.4.4.2.5
    title: Ensure ip6tables is enabled and active (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 3.5
    title: Ensure wireless interfaces are disabled (Automated)
    levels:
      - l1_server
      - l2_workstation
    automated: yes
    rules:
      - wireless_disable_interfaces

  - id: 3.6
    title: Disable IPv6 (Manual)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - kernel_module_ipv6_option_disabled

  - id: 4.1.1.1
    title: Ensure auditd is installed (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - package_audit_installed

  - id: 4.1.1.2
    title: Ensure auditd service is enabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - service_auditd_enabled

  - id: 4.1.1.3
    title: Ensure auditing for processes that start prior to auditd is enabled (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - grub2_audit_argument

  - id: 4.1.1.4
    title: Ensure audit_backlog_limit is sufficient (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - grub2_audit_backlog_limit_argument

  - id: 4.1.2.1
    title: Ensure audit log storage size is configured (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - auditd_data_retention_max_log_file

  - id: 4.1.2.2
    title: Ensure audit logs are not automatically deleted (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - auditd_data_retention_max_log_file_action

  - id: 4.1.2.3
    title: Ensure system is disabled when audit logs are full (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - auditd_data_retention_action_mail_acct
      - auditd_data_retention_admin_space_left_action
      - auditd_data_retention_space_left_action
      - var_auditd_action_mail_acct=root
      - var_auditd_admin_space_left_action=halt
      - var_auditd_space_left_action=email

  - id: 4.1.3
    title: Ensure changes to system administration scope (sudoers) is collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_sysadmin_actions

  - id: 4.1.4
    title: Ensure login and logout events are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_login_events_faillock
      - audit_rules_login_events_lastlog

  - id: 4.1.5
    title: Ensure session initiation information is collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_session_events

  - id: 4.1.6
    title: Ensure events that modify date and time information are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_time_adjtimex
      - audit_rules_time_clock_settime
      - audit_rules_time_settimeofday
      - audit_rules_time_stime
      - audit_rules_time_watch_localtime

  # NEEDS RULE
  # -w /usr/share/selinux/ -p wa
  # https://github.com/ComplianceAsCode/content/issues/5264
  - id: 4.1.7
    title: Ensure events that modify the system's Mandatory Access Controls are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_mac_modification

  - id: 4.1.8
    title: Ensure events that modify the system's network environment are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_networkconfig_modification

  - id: 4.1.9
    title: Ensure discretionary access control permission modification events are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_dac_modification_chmod
      - audit_rules_dac_modification_chown
      - audit_rules_dac_modification_fchmod
      - audit_rules_dac_modification_fchmodat
      - audit_rules_dac_modification_fchown
      - audit_rules_dac_modification_fchownat
      - audit_rules_dac_modification_fremovexattr
      - audit_rules_dac_modification_fsetxattr
      - audit_rules_dac_modification_lchown
      - audit_rules_dac_modification_lremovexattr
      - audit_rules_dac_modification_lsetxattr
      - audit_rules_dac_modification_removexattr
      - audit_rules_dac_modification_setxattr

  - id: 4.1.10
    title: Ensure unsuccessful unauthorized file access attempts are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_unsuccessful_file_modification_creat
      - audit_rules_unsuccessful_file_modification_ftruncate
      - audit_rules_unsuccessful_file_modification_open
      - audit_rules_unsuccessful_file_modification_openat
      - audit_rules_unsuccessful_file_modification_truncate
      # Opinionated selection
      - audit_rules_unsuccessful_file_modification_open_by_handle_at

  - id: 4.1.11
    title: Ensure events that modify user/group information are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_usergroup_modification_group
      - audit_rules_usergroup_modification_gshadow
      - audit_rules_usergroup_modification_opasswd
      - audit_rules_usergroup_modification_passwd
      - audit_rules_usergroup_modification_shadow

  - id: 4.1.12
    title: Ensure successful file system mounts are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_media_export

  - id: 4.1.13
    title: Ensure use of privileged commands is collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_privileged_commands

  - id: 4.1.14
    title: Ensure file deletion events by users are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_file_deletion_events_rename
      - audit_rules_file_deletion_events_renameat
      - audit_rules_file_deletion_events_unlink
      - audit_rules_file_deletion_events_unlinkat
      # Opinionated selection
      - audit_rules_file_deletion_events_rmdir

  - id: 4.1.15
    title: Ensure kernel module loading and unloading is collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_kernel_module_loading

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5516
  - id: 4.1.16
    title: Ensure system administrator actions (sudolog) are collected (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: no

  - id: 4.1.17
    title: Ensure the audit configuration is immutable (Automated)
    levels:
      - l2_server
      - l2_workstation
    automated: yes
    rules:
      - audit_rules_immutable

  - id: 4.2.1.1
    title: Ensure rsyslog is installed (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - package_rsyslog_installed

  - id: 4.2.1.2
    title: Ensure rsyslog Service is enabled (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - service_rsyslog_enabled

  - id: 4.2.1.3
    title: Ensure rsyslog default file permissions configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - rsyslog_files_permissions

  - id: 4.2.1.4
    title: Ensure logging is configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 4.2.1.5
    title: Ensure rsyslog is configured to send logs to a remote log host (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: yes
    rules:
      - rsyslog_remote_loghost

  - id: 4.2.1.6
    title: Ensure remote rsyslog messages are only accepted on designated log hosts. (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
    related_rules:
      - rsyslog_nolisten

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5520
  - id: 4.2.2.1
    title: Ensure journald is configured to send logs to rsyslog (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5521
  - id: 4.2.2.2
    title: Ensure journald is configured to compress large log files (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5522
  - id: 4.2.2.3
    title: Ensure journald is configured to write logfiles to persistent disk (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  # NEEDS RULE
  # https://github.com/ComplianceAsCode/content/issues/5523
  - id: 4.2.3
    title: Ensure permissions on all logfiles are configured (Automated)
    levels:
      - l1_server
      - l1_workstation
    automated: no

  - id: 4.3
    title: Ensure logrotate is configured (Manual)
    levels:
      - l1_server
      - l1_workstation
    automated: no
