<Profile id="disa-rhel7-stig" extends="ospp-rhel7-server">
<title override="true">DISA STIG for Red Hat Enterprise Linux 7</title>
<description override="true">This is a *draft* profile for STIG. This profile is being developed under the DoD consensus model to become a STIG in coordination with DISA FSO.</description>

<!-- DISA FSO REFINEMENT VALUES
     The following refine-values tailor the NIAP OSPP profile
     to DoD-specific settings, as deemed approriate by DISA FSO (RE71) -->
<refine-value idref="sshd_idle_timeout_value" selector="10_minutes" />
<refine-value idref="var_password_pam_unix_remember" selector="5" />
<refine-value idref="var_password_pam_difok" selector="8" />
<refine-value idref="login_banner_text" selector="dod_default" />
<refine-value idref="var_password_pam_minclass" selector="4" />
<refine-value idref="var_password_pam_maxrepeat" selector="2" />
<refine-value idref="var_password_pam_maxclassrepeat" selector="4" />
<refine-value idref="inactivity_timeout_value" selector="15_minutes" />
<refine-value idref="var_account_disable_post_pw_expiration" selector="0" />
<refine-value idref="var_accounts_fail_delay" selector="4" />
<refine-value idref="sshd_listening_port" selector="default" />
<refine-value idref="var_accounts_user_umask" selector="077" />
<!-- END DISA FSO REFINEMENT VALUES -->

<!-- NIAP/OSPP EXCLUDED RULES
     The following rules are established within the NIAP Operating System Protection Profile,
     however specifically excluded by DISA FSO (RE71) for use U.S. Department of Defense baselines -->

<!-- END NIAP/OSPP EXCLUDED RULES -->

<!-- DISA FSO (RE71) RULE ADDITIONS -->
<!-- The following rules reflect DISA FSO (RE71) extensions to the NIAP Operating System
     Protection Profile (NIAP OSPP). -->

<!-- Disk/Partition Requirements -->
<select idref="partition_for_tmp" selected="true" />
<select idref="partition_for_var_log_audit" selected="true" />
<select idref="partition_for_var" selected="true" />
<select idref="partition_for_home" selected="true" />
<select idref="mount_option_nosuid_remote_filesystems" selected="true" />
<select idref="mount_option_nodev_remote_filesystems" selected="true" />
<select idref="mount_option_nosuid_removable_partitions" selected="true" />
<select idref="mount_option_nodev_removable_partitions" selected="true" />
<select idref="mount_option_noexec_removable_partitions" selected="true" />

<!-- Auditing Requirements -->
<select idref="audit_rules_system_shutdown" selected="true" />
<select idref="audit_rules_login_events_tallylog" selected="true" />
<select idref="audit_rules_login_events_faillock" selected="true" />
<select idref="audit_rules_login_events_lastlog" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_creat" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_open" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_openat" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_open_by_handle_at" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_truncate" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_ftruncate" selected="true" />
<select idref="audit_rules_execution_semanage" selected="true" />
<select idref="audit_rules_execution_setsebool" selected="true" />
<select idref="audit_rules_execution_chcon" selected="true" />
<select idref="audit_rules_execution_restorecon" selected="true" />
<select idref="audit_rules_privileged_commands_passwd" selected="true" />
<select idref="audit_rules_privileged_commands_unix_chkpwd" selected="true" />
<select idref="audit_rules_privileged_commands_gpasswd" selected="true" />
<select idref="audit_rules_privileged_commands_chage" selected="true" />
<select idref="audit_rules_privileged_commands_userhelper" selected="true" />
<select idref="audit_rules_privileged_commands_su" selected="true" />
<select idref="audit_rules_privileged_commands_sudo" selected="true" />
<select idref="audit_rules_privileged_commands_sudoedit" selected="true" />
<select idref="audit_rules_privileged_commands_newgrp" selected="true" />
<select idref="audit_rules_privileged_commands_chsh" selected="true" />
<select idref="audit_rules_privileged_commands_umount" selected="true" />
<select idref="audit_rules_privileged_commands_postdrop" selected="true" />
<select idref="audit_rules_privileged_commands_postqueue" selected="true" />
<select idref="audit_rules_privileged_commands_ssh_keysign" selected="true" />
<select idref="audit_rules_privileged_commands_pt_chown" selected="true" />
<select idref="audit_rules_privileged_commands_crontab" selected="true" />
<select idref="audit_rules_privileged_commands_pam_timestamp_check" selected="true" />
<select idref="audit_rules_file_deletion_events_rmdir" selected="true" />
<select idref="audit_rules_file_deletion_events_unlink" selected="true" />
<select idref="audit_rules_file_deletion_events_unlinkat" selected="true" />
<select idref="audit_rules_file_deletion_events_rename" selected="true" />
<select idref="audit_rules_file_deletion_events_renameat" selected="true" />
<select idref="audit_rules_kernel_module_loading" selected="true" />
<select idref="audit_rules_kernel_module_loading_init" selected="true" />
<select idref="audit_rules_kernel_module_loading_delete" selected="true" />
<select idref="audit_rules_kernel_module_loading_insmod" selected="true" />
<select idref="audit_rules_kernel_module_loading_rmmod" selected="true" />
<select idref="audit_rules_kernel_module_loading_modprobe" selected="true" />

<!-- Password Requirements -->
<select idref="accounts_password_pam_minclass" selected="true" />
<select idref="accounts_password_pam_unix_remember" selected="true" />
<select idref="accounts_password_pam_difok" selected="true" />
<select idref="accounts_password_pam_maxrepeat" selected="true" />
<select idref="accounts_password_pam_maxclassrepeat" selected="true" />
<select idref="account_disable_post_pw_expiration" selected="true" />

<!-- Account Management Requirements -->
<select idref="account_temp_expire_date" selected="false" />
<select idref="accounts_logon_fail_delay" selected="true" />
<select idref="sudo_remove_no_authenticate" selected="true" />
<select idref="sudo_remove_nopasswd" selected="true" />

<!-- User Management -->
<select idref="smartcard_auth" selected="true" />
<select idref="banner_etc_issue" selected="true" />
<select idref="sshd_enable_warning_banner" selected="true" />
<select idref="accounts_umask_etc_login_defs" selected="true" />

<!-- Software/Patch Requirements -->
<select idref="ensure_redhat_gpgkey_installed" selected="false" />
<select idref="ensure_gpgcheck_never_disabled" selected="false" />
<select idref="security_patches_up_to_date" selected="true" />
<select idref="clean_components_post_updating" selected="true" />

<!-- Kernel/Network Settings -->
<select idref="libreswan_approved_tunnels" selected="true" />
<select idref="package_libreswan_installed" selected="false" />
<select idref="package_dracut-fips_installed" selected="false" />
<select idref="grub2_enable_fips_mode" selected="true" />

<!-- System Logging Requirements -->
<select idref="rsyslog_remote_loghost" selected="true" />
<select idref="rsyslog_nolisten" selected="true" />
<select idref="rsyslog_cron_logging" selected="true" />

<!-- Remote Access Requirements -->
<select idref="package_openssh-server_installed" selected="true" />
<select idref="firewalld_sshd_port_enabled" selected="false" />
<select idref="service_sshd_enabled" selected="true" />
<select idref="sshd_disable_compression" selected="true" />
<select idref="sshd_disable_gssapi_auth" selected="true" />
<select idref="sshd_disable_kerb_auth" selected="true" />
<select idref="sshd_enable_strictmodes" selected="true" />
<select idref="sshd_use_priv_separation" selected="true" />
<select idref="sshd_print_last_log" selected="true" />
<select idref="sshd_disable_user_known_hosts" selected="true" />
<select idref="sshd_disable_rhosts_rsa" selected="true" />

<!-- System Integrity -->
<select idref="install_mcafee_antivirus" selected="true" />
<select idref="service_nails_enabled" selected="false" />
<select idref="mcafee_antivirus_definitions_updated" selected="true" />
<select idref="aide_scan_notification" selected="true" />
<select idref="aide_verify_acls" selected="true" />
<select idref="aide_verify_ext_attributes" selected="true" />
<select idref="aide_use_fips_hashes" selected="true" />

<!-- X Window System Settings -->
<select idref="package_xorg-x11-server-common_removed" selected="true" />
<select idref="enable_x11_forwarding" selected="true" />

<!-- File Server/Client Settings -->
<select idref="mount_option_krb_sec_remote_filesystems" selected="true" />
<select idref="use_kerberos_security_all_exports" selected="false" />

<!-- Obsolete Services -->
<select idref="package_tftp-server_removed" selected="true" />
<select idref="tftpd_uses_secure_mode" selected="true" />

<!-- Miscellaneous Services -->
<select idref="snmpd_not_default_password" selected="true" />
<select idref="service_kdump_disabled" selected="true" />
<select idref="package_vsftpd_removed" selected="true" />

<!-- LDAP -->

<!-- Currently uncategorized -->
<select idref="disable_ctrlaltdel_reboot" selected="true" />
<select idref="dir_perms_world_writable_system_owned" selected="true" />
<select idref="file_owner_cron_allow" selected="true" />
<select idref="file_groupowner_cron_allow" selected="true" />

<!-- Disabled OSPP rules -->
<select idref="install_antivirus" selected="false" />
<select idref="file_permissions_var_log_audit" selected="false" />
<select idref="accounts_password_all_shadowed" selected="false" />
<select idref="require_singleuser_auth" selected="false" />
<select idref="disable_interactive_boot" selected="false" />
<select idref="service_debug-shell_disabled" selected="false" />
<select idref="no_direct_root_logins" selected="false" />
<select idref="securetty_root_login_console_only" selected="false" />
<select idref="restrict_serial_port_logins" selected="false" />
<select idref="bios_assign_password" selected="false" />
<select idref="set_firewalld_default_zone" selected="false" />
<select idref="sysctl_net_ipv4_tcp_syncookies" selected="false" />
<select idref="auditd_audispd_syslog_plugin_activated" selected="false" />
<select idref="auditd_data_retention_num_logs" selected="false" />
<select idref="auditd_data_retention_max_log_file" selected="false" />
<select idref="auditd_data_retention_max_log_file_action" selected="false" />
<select idref="auditd_data_retention_admin_space_left_action" selected="false" />
<select idref="bootloader_audit_argument" selected="false" />
<select idref="auditd_data_retention_flush" selected="false" />
<select idref="audit_rules_time_adjtimex" selected="false" />
<select idref="audit_rules_time_settimeofday" selected="false" />
<select idref="audit_rules_time_stime" selected="false" />
<select idref="audit_rules_time_clock_settime" selected="false" />
<select idref="audit_rules_time_watch_localtime" selected="false" />
<select idref="audit_rules_networkconfig_modification" selected="false" />
<select idref="audit_rules_mac_modification" selected="false" />
<select idref="audit_rules_session_events" selected="false" />
<select idref="audit_rules_immutable" selected="false" />
<select idref="service_chronyd_or_ntpd_enabled" selected="false" />
<select idref="chronyd_or_ntpd_specify_remote_server" selected="false" />
<select idref="chronyd_or_ntpd_specify_multiple_servers" selected="false" />
<select idref="wireless_disable_in_bios" selected="false" />
<select idref="kernel_module_bluetooth_disabled" selected="false" />
<select idref="service_bluetooth_disabled" selected="false" />
<select idref="bootloader_nousb_argument" selected="false" />
<select idref="bios_disable_usb_boot" selected="false" />
<select idref="service_xinetd_disabled" selected="false" />
<select idref="package_xinetd_removed" selected="false" />
<select idref="service_telnet_disabled" selected="false" />
<select idref="package_telnet_removed" selected="false" />
<select idref="service_rexec_disabled" selected="false" />
<select idref="service_rsh_disabled" selected="false" />
<select idref="package_rsh_removed" selected="false" />
<select idref="service_rlogin_disabled" selected="false" />
<select idref="no_rsh_trust_files" selected="false" />
<select idref="service_ypbind_disabled" selected="false" />
<select idref="package_ypbind_removed" selected="false" />
<select idref="package_talk-server_removed" selected="false" />
<select idref="package_talk_removed" selected="false" />
<select idref="service_crond_enabled" selected="false" />
<select idref="enable_selinux_bootloader" selected="false" />
<select idref="selinux_confinement_of_daemons" selected="false" />
<select idref="package_aide_installed" selected="false" />
<select idref="disable_prelink" selected="false" />
<select idref="aide_build_database" selected="false" />
<select idref="install_hids" selected="false" />
<select idref="sysctl_fs_suid_dumpable" selected="false" />
<select idref="sysctl_kernel_exec_shield" selected="false" />
<select idref="sysctl_kernel_randomize_va_space" selected="false" />
<select idref="install_PAE_kernel_on_x86-32" selected="false" />
<select idref="bios_enable_execution_restrictions" selected="false" />
<select idref="sysctl_kernel_dmesg_restrict" selected="false" />
<select idref="encrypt_partitions" selected="false" />

</Profile>
