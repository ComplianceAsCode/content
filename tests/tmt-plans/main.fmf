discover:
    how: fmf
    url: https://github.com/RHSecurityCompliance/contest.git
execute:
    how: tmt
adjust:
  - environment:
        CONTEST_VERBOSE: 0

#
# Hardening via ansible-playbook remediation
#

/hardening/host-os/ansible/anssi_bp28_high:
    summary: Destructive ANSSI BP-028 (high) profile test (Ansible)
    discover+: {test: /hardening/host-os/ansible/anssi_bp28_high$}
    adjust+:
      - when: distro <= centos-7
        enabled: false

/hardening/host-os/ansible/cis:
    summary: Destructive CIS Server Level 2 profile test (Ansible)
    discover+: {test: /hardening/host-os/ansible/cis$}

/hardening/host-os/ansible/ospp:
    summary: Destructive OSPP profile test (Ansible)
    discover+: {test: /hardening/host-os/ansible/ospp$}

/hardening/host-os/ansible/pci-dss:
    summary: Destructive PCI-DSS profile test (Ansible)
    discover+: {test: /hardening/host-os/ansible/pci-dss$}

/hardening/host-os/ansible/stig:
    summary: Destructive STIG profile test (Ansible)
    discover+: {test: /hardening/host-os/ansible/stig$}
    adjust+:
      - when: distro <= centos-8
        enabled: false

#
# Hardening via oscap xccdf eval --remediate
#

/hardening/host-os/oscap/anssi_bp28_high:
    summary: Destructive ANSSI-BP-028 (high) profile test (Bash)
    discover+: {test: /hardening/host-os/oscap/anssi_bp28_high$}
    adjust+:
      - when: distro <= centos-7
        enabled: false

/hardening/host-os/oscap/cis:
    summary: Destructive CIS Server Level 2 profile test (Bash)
    discover+: {test: /hardening/host-os/oscap/cis$}

/hardening/host-os/oscap/ospp:
    summary: Destructive OSPP profile test (Bash)
    discover+: {test: /hardening/host-os/oscap/ospp$}

/hardening/host-os/oscap/pci-dss:
    summary: Destructive PCI-DSS profile test (Bash)
    discover+: {test: /hardening/host-os/oscap/pci-dss$}

/hardening/host-os/oscap/stig:
    summary: Destructive STIG profile test (Bash)
    discover+: {test: /hardening/host-os/oscap/stig$}

#
# Misc smoke/sanity tests
#

/static-checks:
    summary: Sanity non-destructive tests
    discover+: {test: /static-checks}
