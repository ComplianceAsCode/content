documentation_complete: true

prodtype: ocp4

title: 'Configure A Unique CA Certificate for etcd'

description: |-
  A unique CA certificate should be created for <tt>etcd</tt>.  OpenShift by
  default creates separate PKIs for etcd and the Kubernetes API server. The
  same is done for other points of communication in the cluster.

rationale: |-
  The Kubernetes API server and etcd utilize separate CA certificates in
  OpenShift.  This ensures that the etcd data is still protected in the event
  that the API server CA is compromised.

severity: medium

#identifiers:
#    cce@ocp4:

references:
  cis: '2.7'

platform: ocp4-master-node

ocil_clause: 'The etcd CA certificate is not unique'

ocil: |-
  Run the following command:
  <pre>oc debug node/$NODE -- diff /host/etc/kubernetes/static-pod-resources/etcd-certs/configmaps/etcd-serving-ca/ca-bundle.crt /host/etc/kubernetes/static-pod-resources/kube-apiserver-certs/configmaps/client-ca/ca-bundle.crt</pre>
  where <tt>$NODE</tt> is a master node. If you don't see diff output
  the differences, you might have a compromise and should isolate the cluster.
  OpenShift will use separate PKIs by default.
