
title: Ensure ETCD has correct cipher suite

description: |-
  Check the current cipher suite used in ETCD.

rationale: |-
  Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to
  protect data. The system must implement cryptographic modules adhering to the higher
  standards approved by the federal government since this provides assurance they have been tested
  and validated.


identifiers:
  cce@ocp4: CCE-85866-2

references:
  pcidss: Req-4.1

platform: not ocp4-on-hypershift-hosted

ocil_clause: 'ETCD cipher suite does not meet requirements'

ocil: |-
    Run the following command to check the cipher suites for ETCD:
    <pre>$ oc get configmaps etcd-pod -n openshift-etcd -o json | jq -r '.data["pod.yaml"]' |  grep -P "{{ .var_etcd_tls_cipher_suites_regex }}" </pre>
    Make sure that the result prints the configured cipher suites. If the result is empty, the cipher suites are not configured properly.

severity: medium

warnings:
- general: |-
    {{{ openshift_cluster_setting('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod') | indent(4) }}}
template:
  name: yamlfile_value
  vars:
    ocp_data: "true"
    filepath: /api/v1/namespaces/openshift-etcd/configmaps/etcd-pod
    yamlpath: ".data['pod.yaml']"
    xccdf_variable: var_etcd_tls_cipher_suites_regex
    regex_data: true
