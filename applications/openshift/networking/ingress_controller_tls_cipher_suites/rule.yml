documentation_complete: true


title: "Ensure that the Ingress Controller only makes use of Strong Cryptographic Ciphers"

description: |-
  Ensure that the Ingress Controller is configured to only use strong cryptographic ciphers.

rationale: |-
  TLS ciphers have had a number of known vulnerabilities and weaknesses,
  which can reduce the protection provided by them. By default Kubernetes
  supports a number of TLS ciphersuites including some that have security
  concerns, weakening the protection provided.

severity: medium

#identifiers:
#    cce@ocp4:

references:
  cis@ocp4: 4.2.12

ocil_clause: "Ingress controller TLS cipher suite configuration is incomplete or possibly insecure"

ocil: |-
  Run the following command:
  <pre>oc get ingresscontrollers/default -n openshift-ingress-operator -o=jsonpath='{.status.tlsProfile.ciphers[:]}'</pre>
  Verify that the set of ciphers contains only the following:
  <pre>
  {{ .var_ingresscontroller_tls_cipher_suites }}
  </pre>

warnings:
- general: |-
    {{{ openshift_cluster_setting("/apis/operator.openshift.io/v1/namespaces/openshift-ingress-operator/ingresscontrollers/default") | indent(4) }}}

template:
  name: yamlfile_value
  vars:
    ocp_data: "true"
    filepath: '/apis/operator.openshift.io/v1/namespaces/openshift-ingress-operator/ingresscontrollers/default'
    yamlpath: ".status.tlsProfile.ciphers[:]"
    xccdf_variable: var_ingresscontroller_tls_cipher_suites_regex
    regex_data: true
