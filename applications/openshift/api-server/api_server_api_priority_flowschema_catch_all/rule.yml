documentation_complete: true


title: 'Ensure catch-all FlowSchema object for API Priority and Fairness
  Exists'

description: |-
  Using `APIPriorityAndFairness` feature provides a fine-grained way to
  control the behaviour of the Kubernetes API server in an overload situation.
  The well-known FlowSchema `catch-all` should be available to make sure that
  every request gets some kind of classification. By default, the `catch-all`
  priority level only allows one concurrency share and does not queue
  requests. To inspect all the `FlowSchema` objects, run:
  ```oc get flowschema```
  To inspect the well-known `catch-all` object, run the following:
  ```oc describe flowschema catch-all```

rationale: |-
  The `FlowSchema` API objects enforce a limit on the number of events that
  the API Server will accept in a given time slice. In a large multi-tenant
  cluster, there might be a small percentage of misbehaving tenants which
  could have a significant impact on the performance of the cluster overall.
  It is recommended to limit the rate of events that the API Server will
  accept.

identifiers:
  cce@ocp4: CCE-85891-0

severity: medium

references:
  cis@ocp4: 1.2.9
  nerc-cip: CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1
  nist: CM-6,CM-6(1)
  pcidss: Req-2.2
  srg: SRG-APP-000516-CTR-001325

ocil_clause: 'A FlowSchema object `catch-all` exists'

ocil: |-
  Run the following commands:
  ```oc get flowschema```
  and inspect the FlowSchema objects. Make sure that at least the
  `catch-all` object exists by calling:
  ```oc describe flowschema catch-all```

warnings:
    - general: |-
        {{{ openshift_cluster_setting(["/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all", "/apis/flowcontrol.apiserver.k8s.io/v1beta1/flowschemas/catch-all", "/apis/flowcontrol.apiserver.k8s.io/v1beta2/flowschemas/catch-all", "/apis/flowcontrol.apiserver.k8s.io/v1/flowschemas/catch-all"], true) | indent(8) }}}
