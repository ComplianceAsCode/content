documentation_complete: true


title: 'Disable Use of the Insecure Bind Address'

{{% set default_jqfilter = '.data."config.yaml" | fromjson | .apiServerArguments' %}}
{{% set default_api_path = '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' %}}
{{% set hypershift_path = '/api/v1/namespaces/{{.hypershift_namespace_prefix}}-{{.hypershift_cluster}}/configmaps/kas-config' %}}
{{% set hypershift_jqfilter = '.data."config.json" | fromjson | .apiServerArguments' %}}
{{% set custom_api_path = '{{if ne .hypershift_cluster "None"}}' ~ hypershift_path ~ '{{else}}' ~  default_api_path ~ '{{end}}' %}}
{{% set custom_jqfilter = '{{if ne .hypershift_cluster "None"}}' ~ hypershift_jqfilter ~ '{{else}}' ~  default_jqfilter ~ '{{end}}' %}}
{{% set dump_path = default_api_path ~ ',' ~ default_jqfilter ~ ',' ~ custom_jqfilter %}}

description: |-
    Disable the insecure bind address to prevent OpenShift from binding to
    non-loopback insecure addresses. Remove the `insecure-bind-address`
    parameter from the `openshift-kube-apiserver` configmap if it exists to
    ensure secure API server bindings.

rationale: |-
    If the API Server is bound to an insecure address, the installation would
    be susceptible to unauthenticated and unencrypted access to the master
    nodes. The API Server does not perform authentication checking for insecure
    binds and the traffic is generally not encrypted. This creates a critical
    security vulnerability allowing unauthorized access to cluster management
    functions.

identifiers:
  cce@ocp4: CCE-83955-5

severity: medium

references:
    cis@ocp4: 1.2.16
    nerc-cip: CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1
    nist: CM-6,CM-6(1)
    pcidss: Req-2.2
    srg: SRG-APP-000516-CTR-001325

platform: not ocp4-on-hypershift-hosted

ocil_clause: 'insecure-bind-address exists and has not been removed'

ocil: |-
    Verify that the insecure bind address is not configured by running the
    following command:

    ```
    $ oc get configmap config -n openshift-kube-apiserver -ojson | \
      jq -r '.data["config.yaml"]' | jq '.apiServerArguments["insecure-bind-address"]'
    ```

    The output should be empty.

warnings:
- general: |-
    {{{ openshift_filtered_cluster_setting({custom_api_path: dump_path}) | indent(4) }}}

template:
  name: yamlfile_value
  vars:
    ocp_data: "true"
    check_existence: "none_exist"
    filepath: {{{ openshift_filtered_path(default_api_path, default_jqfilter) }}}
    yamlpath: '.apiServerArguments[:]'
    values:
    - value: 'insecure-bind-address'
      operation: "pattern match"
      type: "string"
