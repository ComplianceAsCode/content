documentation_complete: true


title: "Ensure APIServer is configured with secure tlsSecurityProfile"

description: |-
    Configure secure TLS Security Profile for the APIServer to ensure strong
    encryption protocols during external connections. The `tlsSecurityProfile`
    setting specifies TLS configurations used when establishing connections
    with externally exposed servers. While secure transport mode is used for
    connections, the protocols may not always provide sufficient strength to
    prevent interception and manipulation of data in transit.

    The TLS Security Profile must not use protocols, ciphers, or algorithms
    with known security vulnerabilities. Configure `tlsSecurityProfile` to use
    Intermediate or Modern profiles rather than Old or Custom profiles. The Old
    profile should never be used, and Custom profiles require extreme caution
    as invalid configurations can be catastrophic.

    Update tlsSecurityProfile to Intermediate using the following command:

    ```
    oc patch apiservers.config.openshift.io cluster --type 'json' --patch \
      '[{"op": "add", "path": "/spec/tlsSecurityProfile/intermediate", "value": {}}, {"op": "replace", "path": "/spec/tlsSecurityProfile/type", "value": "Intermediate"}'
    ```

    For more information, follow OpenShift documentation:
    {{{ weblink(link="https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html",
                text="the relevant documentation") }}}.

rationale: |-
    The authenticity and integrity of the container platform and communication
    between nodes and components must be secure. Secure protocols, ciphers, and
    algorithms are essential to prevent data interception and manipulation
    during transmission. Failure to configure secure TLS profiles exposes the
    cluster to man-in-the-middle attacks, data theft, and unauthorized access
    to sensitive communications.

severity: medium

identifiers:
    cce@ocp4: CCE-86232-6

references:
    nist: SC-8,SC-8(1)
    srg: SRG-APP-000014-CTR-000040,SRG-APP-000560-CTR-001340

ocil_clause: 'insecure tlsSecurityProfile is configured for accessing external services'

ocil: |-
    Verify the configured tlsSecurityProfile using the following command:

    ```
    $ oc get apiservers.config.openshift.io cluster -o jsonpath='{.spec.tlsSecurityProfile}{"\n"}'
    ```

    The output displays the tlsSecurityProfile configured for the API Server.
    Ensure the profile is not Old and if using Custom, verify the minimum TLS
    version is TLSv1.2 or newer.

warnings:
    - general: |-
        {{{ openshift_cluster_setting("/apis/config.openshift.io/v1/apiservers/cluster") | indent(8) }}}
