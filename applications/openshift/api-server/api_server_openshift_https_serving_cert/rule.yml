documentation_complete: true


title: 'Ensure the openshift-oauth-apiserver service uses TLS'

description: |-
    Ensure the OpenShift API Server uses TLS encryption for secure
    communication. Configure HTTPS for connections between openshift-apiserver
    and kube-apiserver. The OpenShift OAuth API Server uses an Intermediate
    profile requiring a minimum TLS version of 1.2.

rationale: |-
    Connections between the kube-apiserver and the extension
    openshift-apiserver could potentially carry sensitive data such as secrets
    and keys. Using in-transit encryption for any communication between the
    kube-apiserver and the extension openshift-apiserver is critical.
    Unencrypted connections could expose sensitive cluster data to network
    eavesdropping attacks.

severity: medium

references:
    cis@ocp4: 1.2.4
    nerc-cip: CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1
    nist: CM-6,CM-6(1),SC-8,SC-8(1)
    pcidss: Req-2.2,Req-2.2.3,Req-2.3
    srg: SRG-APP-000516-CTR-001325

ocil_clause: |-
    The openshift-apiserver TLS security profile is set to old.

ocil: |-
    Verify that the TLS security profile is properly configured by running the
    following command:

    ```
    $ oc get APIServer cluster -o yaml
    ```

    Verify that the `tlsSecurityProfile` is not type `Old`.

warnings:
    - general: |-
        {{{ openshift_cluster_setting("/apis/config.openshift.io/v1/apiservers/cluster") | indent(8) }}}


