<Group id="software">
<title>Installing and Maintaining Software</title>
<description>The following sections contain information on
security-relevant choices during the initial operating system
installation process and the setup of software
updates.</description>

<!-- partitioning -->
<Group id="installation-storage-partitioning">
<title>Partitioning</title>
<description>
  Separating various locations of the file systems in different partitions allows a more restrictive
  segregation, distinctly from one location to another. Moreover, some native restrictions can be made by
partitioning, such as no hard link between different filesystems, and reduce the corruption impact to the
affected filesystem instead of the entire system. The last gain is to allow a differenciated usage of storage
media, depending on the operational needs (speed, resilience, etc.).
</description>
<reference href="http://www.pathname.com/fhs/">Filesystem Hierarchy Standard</reference>

<Rule id="partition_for_tmp">
<title>Ensure /tmp Located On Separate Partition</title>
<description>
The <tt>/tmp</tt> directory is a world-writable directory used
for temporary file storage. Ensure it has its own partition or
logical volume at installation time, or migrate it using LVM (when non-ephemeral is needed) or use tmpfs if possible.
</description>
<!--
<fixtext ffixref="partition_for_tmp_fix">
  When tmpfs is possible, just add a specific tmpfs line on the <h:code>fstab</h:code> file (or via systemd), and specify the maximum
  associated size by using <h:code>size=</h:code> argument.
</fixtext>
-->
<rationale>
The <tt>/tmp</tt> partition is used as temporary storage by many programs.
Placing <tt>/tmp</tt> in its own partition enables the setting of more
restrictive mount options, which can help protect programs which use it.
</rationale>
<ocil><partition-check-macro part="/tmp "/></ocil>
<ident cce="27173-4" />
<oval id="partition_for_tmp" />
<ref nist="SC-32" />
<tested by="MM" on="20120928"/>
</Rule>

<Rule id="partition_for_var">
<title>Ensure /var Located On Separate Partition</title>
<description>The <tt>/var</tt> directory is used by daemons and other system
services to store frequently-changing data. Ensure that <tt>/var</tt> has its own partition
or logical volume at installation time, or migrate it using LVM.
</description>
<ocil><partition-check-macro part="/var "/></ocil>
<rationale>
Ensuring that <tt>/var</tt> is mounted on its own partition enables the
setting of more restrictive mount options. This helps protect
system services such as daemons or other programs which use it.
It is not uncommon for the <tt>/var</tt> directory to contain
world-writable directories installed by other software packages.
</rationale>
<ident cce="26404-4" />
<oval id="partition_for_var" />
<ref nist="SC-32" />
<tested by="MM" on="20120928"/>
</Rule>

<Rule id="partition_for_var_log">
<title>Ensure /var/log Located On Separate Partition</title>
<description>
System logs are stored in the <tt>/var/log</tt> directory.
Ensure that it has its own partition or logical
volume at installation time, or migrate it using LVM.
</description>
<ocil><partition-check-macro part="/var/log "/></ocil>
<rationale>
Placing <tt>/var/log</tt> in its own partition
enables better separation between log files
and other files in <tt>/var/</tt>.
</rationale>
<ident cce="26967-0" />
<oval id="partition_for_var_log" />
<ref nist="AU-9,SC-32" disa=""/>
<tested by="MM" on="20120928"/>
</Rule>

<Rule id="partition_for_var_log_audit">
<title>Ensure /var/log/audit Located On Separate Partition</title>
<description>
Audit logs are stored in the <tt>/var/log/audit</tt> directory.  Ensure that it
has its own partition or logical volume at installation time, or migrate it
later using LVM. Make absolutely certain that it is large enough to store all
audit logs that will be created by the auditing daemon.
</description>
<ocil><partition-check-macro part="/var/log/audit "/></ocil>
<rationale>
Placing <tt>/var/log/audit</tt> in its own partition
enables better separation between audit files
and other files, and helps ensure that
auditing cannot be halted due to the partition running out
of space.
</rationale>
<ident cce="26971-2" />
<oval id="partition_for_var_log_audit" />
<ref nist="AU-4,AU-9,SC-32" disa=""/>
<tested by="MM" on="20120928"/>
</Rule>

<Rule id="partition_for_home">
<title>Ensure /home Located On Separate Partition</title>
<description>
If user home directories will be stored locally, create a separate partition
for <tt>/home</tt> at installation time (or migrate it later using LVM). If
<tt>/home</tt> will be mounted from another system such as an NFS server, then
creating a separate partition is not necessary at installation time, and the
mountpoint can instead be configured later.
</description>
<ocil><partition-check-macro part="/home "/></ocil>
<rationale>
Ensuring that <tt>/home</tt> is mounted on its own partition enables the
setting of more restrictive mount options, and also helps ensure that
users cannot trivially fill partitions used for log or audit data storage.
</rationale>
<ident cce="RHEL7-CCE-TBD" />
<oval id="partition_for_home" />
<ref nist="SC-32" disa="1208"/>
<tested by="MM" on="20120928"/>
</Rule>

</Group>
<!-- end of partitioning -->

<!-- critical file access rights and ownership -->
<Group id="files">
<title>Verify Permissions on Important Files and
Directories</title>
<description>Permissions for many files on a system must be set
restrictively to ensure sensitive information is properly protected.
This section discusses important
permission restrictions which can be verified
to ensure that no harmful discrepancies have
arisen.</description>

<Group id="permissions_important_account_files">
<title>Verify Permissions on Files with Local Account Information and Credentials</title>
<description>The default restrictive permissions for files which act as
important security databases such as <tt>passwd</tt>, <tt>shadow</tt>,
<tt>group</tt>, and <tt>gshadow</tt> files must be maintained.  Many utilities
need read access to the <tt>passwd</tt> file in order to function properly, but
read access to the <tt>shadow</tt> file allows malicious attacks against system
passwords, and should never be enabled.</description>


<!-- /etc/group -->
<Rule id="file_permissions_etc_group" severity="medium">
<title>Verify Permissions on <tt>group</tt> File</title>
<description><fileperms-desc-macro file="/etc/group" perms="644"/></description>
<ocil><fileperms-check-macro file="/etc/group" perms="-rw-r--r--"/></ocil>
<rationale>The <tt>/etc/group</tt> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.</rationale>
<ident cce="26949-8" />
<oval id="file_permissions_etc_group" />
<ref nist="AC-6" disa="" pcidss="Req-8" />
<tested by="DS" on="20121026"/>
</Rule>

<Rule id="file_owner_etc_group" severity="medium">
<title>Verify User Who Owns <tt>group</tt> File</title>
<description><fileowner-desc-macro file="/etc/group" owner="root"/></description>
<ocil><fileowner-check-macro file="/etc/group" owner="root"/></ocil>
<rationale>The <tt>/etc/group</tt> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.</rationale>
<ident cce="26933-2" />
<oval id="file_owner_etc_group" />
<ref nist="AC-6" pcidss="Req-8" />
<tested by="DS" on="20121026"/>
</Rule>

<!-- /etc/shadow  -->
<Rule id="file_permissions_etc_shadow" severity="medium">
<title>Verify Permissions on <tt>shadow</tt> File</title>
<description><fileperms-desc-macro file="/etc/shadow" perms="0000"/></description>
<ocil><fileperms-check-macro file="/etc/shadow" perms="----------"/></ocil>
<rationale>The <tt>/etc/shadow</tt> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.</rationale>
<ident cce="27100-7" />
<oval id="file_permissions_etc_shadow" />
<ref nist="AC-6" disa="" pcidss="Req-8" />
<tested by="DS" on="20121026"/>
</Rule>


<Rule id="file_owner_etc_gshadow" severity="high">
<title>Verify User Who Owns <tt>shadow</tt> File</title>
<description><fileowner-desc-macro file="/etc/shadow" owner="root"/></description>
<ocil><fileowner-check-macro file="/etc/shadow" owner="root"/></ocil>
<ident cce="26795-5" />
<rationale>The <tt>/etc/shadow</tt> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.</rationale>
<oval id="file_owner_etc_gshadow" />
<ref nist="AC-6" disa="" pcidss="Req-8" />
</Rule>

<!-- /etc/passwd -->
<Rule id="file_owner_etc_passwd" severity="medium">
<title>Verify User Who Owns <tt>passwd</tt> File</title>
<description><fileowner-desc-macro file="/etc/passwd" owner="root"/></description>
<ocil><fileowner-check-macro file="/etc/passwd" owner="root"/></ocil>
<rationale>The <tt>/etc/passwd</tt> file contains information about the users that are configured on
the system. Protection of this file is critical for system security.</rationale>
<ident cce="27138-7" />
<oval id="file_owner_etc_passwd" />
<ref nist="AC-6" disa="" pcidss="Req-8" />
<tested by="DS" on="20121026"/>
</Rule>

<Rule id="file_permissions_etc_passwd" severity="medium">
<title>Verify Permissions on <tt>passwd</tt> File</title>
<description><fileperms-desc-macro file="/etc/passwd" perms="0644"/></description>
<ocil><fileperms-check-macro file="/etc/passwd" perms="-rw-r--r--"/></ocil>
<rationale>If the <tt>/etc/passwd</tt> file is writable by a group-owner or the
world the risk of its compromise is increased. The file contains the list of
accounts on the system and associated information, and protection of this file
is critical for system security.</rationale>
<ident cce="26887-0" />
<oval id="file_permissions_etc_passwd" />
<ref nist="AC-6" disa="" pcidss="Req-8" />
<tested by="DS" on="20121026"/>
</Rule>

</Group>
</Group>
</Group>
