documentation_complete: true

title: 'Oracle JRE 8 must lock the option to enable users to check publisher certificates for revocation'

description: |-
    To ensure that Java enables users to check publisher certificates for revocation, set
    <tt>deployment.security.revocation.check</tt> to equal <tt>ALL_CERTIFICATES</tt>
    in <tt>/etc/.java/deployment/deployment.properties</tt>.
    
    To ensure the setting cannot be modified by a user, additionally set
    <tt>deployment.security.revocation.check.locked</tt>
    in <tt>/etc/.java/deployment/deployment.properties</tt>.

rationale: |-
    Certificates may be revoked due to improper issuance, compromise of the certificate, and failure 
    to adhere to policy. Therefore, any certificate found revoked on a CRL or via Online Certificate 
    Status Protocol (OCSP) should not be trusted.

severity: medium

references:
    nist: IA-5(2)
    stigid: JRE8-UX-000160

ocil_clause: 'it does not exist or is not configured properly'

ocil: |-
    To verify that Java enables users to check publisher certificates for revocation,
    run the following command:
    <pre>$ grep 'deployment.security.revocation.check=ALL_CERTIFICATES' /etc/.java/deployment/deployment.properties</pre>
    If properly configured, the output should return:
    <pre>deployment.security.revocation.check=ALL_CERTIFICATES</pre>
    
    To verify that the Java setting is locked, run the following command:
    <pre>$ grep 'deployment.security.revocation.check.locked' /etc/.java/deployment/deployment.properties</pre>
    If properly configured, the output should return:
    <pre>deployment.security.revocation.check.locked</pre>
    
