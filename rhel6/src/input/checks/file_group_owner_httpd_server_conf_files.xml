<def-group>
  <definition class="compliance" id="file_group_owner_httpd_server_conf_files" version="1">
    <metadata>
      <title>Check Group Ownership /etc/httpd/conf</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 6</platform>
      </affected>
      <reference ref_id="CCE-3626-9" source="CCE" />
      <description>The directory /etc/httpd/conf and contained files should be owned by the apache group.</description>
    </metadata>
    <criteria operator="AND">
      <criterion test_ref="test_file_group_owner_httpd_server_conf_files-dir" />
      <criterion test_ref="test_file_group_owner_httpd_server_conf_files-files" />
    </criteria>
  </definition>
  <unix:file_test check="all" check_existence="all_exist" comment="apache gid for /etc/http/conf/" id="test_file_group_owner_httpd_server_conf_files-dir" version="1">
    <unix:object object_ref="object_file_group_owner_httpd_server_conf_files-dir" />
    <unix:state state_ref="state_file_group_owner_httpd_server_conf_files-dir" />
  </unix:file_test>
  <unix:file_object comment="/etc/httpd/conf/" id="object_file_group_owner_httpd_server_conf_files-dir" version="1">
    <unix:path>/etc/httpd/conf</unix:path>
    <unix:filename xsi:nil="true" />
  </unix:file_object>
  <unix:file_state id="state_file_group_owner_httpd_server_conf_files-dir" version="1">
    <unix:group_id datatype="int" var_ref="var_apache_gid" />
  </unix:file_state>
  <unix:file_test check="all" check_existence="all_exist" comment="apache gid for /etc/http/conf/*" id="test_file_group_owner_httpd_server_conf_files-files" version="1">
    <unix:object object_ref="object_file_group_owner_httpd_server_conf_files-files" />
    <unix:state state_ref="state_file_group_owner_httpd_server_conf_files-files" />
  </unix:file_test>
  <unix:file_object comment="/etc/httpd/conf/*" id="object_file_group_owner_httpd_server_conf_files-files" version="1">
    <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local" />
    <unix:path operation="equals">/etc/httpd/conf</unix:path>
    <unix:filename operation="pattern match">^.*$</unix:filename>
  </unix:file_object>
  <unix:file_state id="state_file_group_owner_httpd_server_conf_files-files" version="1">
    <unix:group_id datatype="int" var_ref="var_apache_gid" />
  </unix:file_state>
  <unix:password_test check="all" comment="Find the Apache group id (GID)" id="test_find_apache_gid" version="1">
    <unix:object object_ref="object_find_apache_gid"/>
    <!-- <unix:state state_ref="state_find_apache_gid"/> -->
  </unix:password_test>
  <unix:password_object id="object_find_apache_gid" version="1">
    <unix:username operation="equals">apache</unix:username>
  </unix:password_object>
  <local_variable id="var_apache_gid" version="1" datatype="int" comment="GID for apache group">
    <object_component item_field="group_id" object_ref="object_find_apache_gid"/>
  </local_variable>
</def-group>
