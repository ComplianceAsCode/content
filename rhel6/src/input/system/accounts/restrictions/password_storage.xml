<Group id="password_storage">
<title>Verify Proper Storage and Existence of Password
Hashes</title>
<description>
By default, password hashes for local accounts are stored
in the second field (colon-separated) in
<tt>/etc/shadow</tt>. This file should be readable only by
processes running with root credentials, preventing users from
casually accessing others' password hashes and attempting
to crack them.
However, it remains possible to misconfigure the system
and store password hashes
in world-readable files such as <tt>/etc/passwd</tt>, or
to even store passwords themselves in plaintext on the system.
Using system-provided tools for password change/creation
should allow administrators to avoid such misconfiguration.
</description>

<Rule id="no_empty_passwords" severity="high">
<title>Verify that No Accounts Have Empty Password Fields</title>
<description>Run the command:
<pre># awk -F: '($2 == "") {print}' /etc/shadow</pre>
If this produces any output, fix the problem by locking each
account or by setting a password.
</description>
<rationale>
If an account has an empty password, anybody may log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational
environments.
</rationale>
<ident cce="4238-2" />
<oval id="accounts_no_empty_passwords" />
<ref nist="AC-3, CM-6, IA-5" />
</Rule>


<Rule id="no_hashes_outside_shadow">
<title>Verify All Account Password Hashes are Shadowed</title>
<description>To ensure that no password hashes are stored in
<tt>/etc/passwd</tt>, the following command should have no output:
<pre># awk -F: '($2 != "x") {print}' /etc/passwd</pre>
</description>
<rationale>
The hashes for all user account passwords should be stored in
the file <tt>/etc/shadow</tt> and never in <tt>/etc/passwd</tt>,
which is readable by all users.
</rationale>
<ident cce="14300-8" />
<oval id="accounts_password_all_shadowed" />
<ref nist="IA-5" />
</Rule>
</Group>

