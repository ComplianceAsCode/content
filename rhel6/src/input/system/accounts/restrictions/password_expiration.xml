<Group id="password_expiration">
<title>Set Password Expiration Parameters</title>
<description>The file <tt>/etc/login.defs</tt> controls several
password-related settings. Programs such as <tt>passwd</tt>,
<tt>su</tt>, and
<tt>login</tt> consult <tt>/etc/login.defs</tt> to determine
behavior with regard to password aging, expiration warnings,
and length. See the man page <tt>login.defs(5)</tt> for more information.
<br/><br/>
Users should be forced to change their passwords, in order to
decrease the utility of compromised passwords. However, the need to
change passwords often should be balanced against the risk that
users will reuse or write down passwords if forced to change them
too often. Forcing password changes every 90-360 days, depending on
the environment, is recommended. Set the appropriate value as
<tt>PASS_MAX_DAYS</tt> and apply it to existing accounts with the
<tt>-M</tt> flag.
<br /><br />
The <tt>PASS_MIN_DAYS</tt> (<tt>-m</tt>) setting prevents password
changes for 7 days after the first change, to discourage password
cycling. If you use this setting, train users to contact an administrator
for an emergency password change in case a new password becomes
compromised. The <tt>PASS_WARN_AGE</tt> (<tt>-W</tt>) setting gives
users 7 days of warnings at login time that their passwords are about to expire.
<br /><br />
For each existing human user USER , modify the current
expiration settings to match these:
<pre># chage -M 180 -m 7 -W 7 USER</pre>
</description>

<Value id="var_password_min_len" type="string" operator="equals" interactive="0">
<title>minimum password length</title>
<description>Minimum number of characters in password</description>
<warning category="general">This will only check new passwords</warning>
<value selector="">14</value>
<value selector="6">6</value>
<!-- NIST 800-53 requires 1 in a million using brute force which translates to six numbers -->
<value selector="8">8</value>
<value selector="10">10</value>
<value selector="14">14</value>
</Value>

<Value id="password_max_age_login_defs_value" type="string"
operator="equals" interactive="0">
<title>maximum password age</title>
<description>Maximum age of password in days</description>
<warning category="general">This will only apply to newly created accounts</warning>
<value selector="">90</value>
<value selector="90">90</value>
<value selector="120">120</value>
<value selector="180">180</value>
</Value>


<Value id="password_warn_age_login_defs_value" type="string"
operator="equals" interactive="0">
<title>warning days before password expires</title>
<description>The number of days' warning given before a password expires.</description>
<warning category="general">This will only apply to newly created accounts</warning>
<value selector="">7</value>
<value selector="7">7</value>
<value selector="14">14</value>
</Value>

<Rule id="password_min_len">
<title>Set Password Minimum Length in login.defs</title>
<description>To specify password length requirements for new accounts,
edit the file <tt>/etc/login.defs</tt> and add or correct the following
lines:
<pre>PASS_MIN_LEN=12<!-- <sub idref="var_password_min_len"> --></pre>
TODO: More research needed to understand exact interaction: when precisely is this file consulted?
<br/><br/>
If a program consults <tt>/etc/login.defs</tt> and also another PAM module
(such as <tt>pam_cracklib</tt>) during a password change operation,
then the most restrictive must be satisfied. See PAM section
for more information about enforcing password quality requirements.
</description>
<rationale>
Requiring a minimum password length makes password
cracking attacks more difficult by ensuring a larger
search space. However, any security benefit from an onerous requirement
must be carefully weighed
against usability problems, support costs, or counterproductive
behavior that may result.
</rationale>
<ident cce="4154-1" />
<oval id="accounts_password_minlen_login_defs" value="var_password_min_len"/>
<ref nist="CM-6, CM-7, IA-5, AC-3" />
</Rule>


<Rule id="password_min_age">
<title>Set Password Minimum Age</title>
<description>To specify password minimum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MIN_DAYS=7</pre>
</description>
<rationale>
Setting the minimum password age protects against
users cycling back to a favorite password
after satisfying the password reuse requirement.
</rationale>
<ident cce="4180-6" />
<oval id="accounts_minimum_age_login_defs" />
<ref nist="CM-6, IA-5" />
</Rule>



<Rule id="password_max_age">
<title>Set Password Maximum Age</title>
<description>To specify password maximum age for new accounts,
edit the file <tt>/etc/login.defs</tt>
and add or correct the following line:
<pre>PASS_MAX_DAYS=180<!-- <sub idref="password_max_age_login_defs_value" /> --></pre>
</description>
<rationale>
Setting the password warning age enables users to
make the change at a practical time prior to expiration.
</rationale>
<ident cce="4092-3" />
<oval id="accounts_maximum_age_login_defs" />
<ref nist="CM-6, CM-7, IA-5, AC-3" />
<ident cci="CCI-000199" />
</Rule>


<Rule id="password_warn_age">
<title>Set Password Warning Age</title>
<description>To specify how many days prior to password
expiration that a warning will be issued to users,
edit the file <tt>/etc/login.defs</tt> and add or correct
 the following line:
<pre>PASS_WARN_AGE=7</pre>
<!-- <sub idref="password_warn_age_login_defs_value" /> -->
</description>
<rationale>
Setting the password warning age enables users to
make the change at a practical time.
</rationale>
<ident cce="4097-2" />
<oval id="accounts_password_warn_age_login_defs" />
<ref nist="CM-6, CM-7, IA-5, AC-3" />
</Rule>
</Group>

