<Group id="network-kernel">
<title>Kernel Parameters Which Affect Networking</title>
<description>The <tt>sysctl</tt> utility is used to set a number of
parameters which affect the operation of the Linux kernel. Several
of these parameters are specific to networking, and the
configuration options in this section are recommended.</description>

<Group id="network_host_parameters">
<title>Network Parameters for Hosts Only</title>
<description>Is this system going to be used as a firewall or
gateway to pass IP traffic between different networks?
<br />If not, edit the file <tt>/etc/sysctl.conf</tt> and add or
correct the following lines:
<pre>net.ipv4.ip_forward = 0
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0</pre>
These settings disable hosts from performing network
functionality which is only appropriate for routers.</description>

<Rule id="disable_sysctl_ipv4_default_send_redirects">
<title>Disable net.ipv4.conf.default.send_redirects Kernel Runtime Parameter</title>
<description>The default setting for sending ICMP redirects should
be disabled for network interfaces.</description>
<rationale>This setting is only appropriate for routers and it should be disabled on all other systems.</rationale>
<ident cce="4151-7" />
<oval id="sysctl_net_ipv4_conf_default_send_redirects" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>

<Rule id="disable_sysctl_ipv4_all_send_redirects">
<title>Disable net.ipv4.conf.all.send_redirects Kernel Runtime Parameter</title>
<description>Sending ICMP redirects should be disabled for all interfaces.</description>
<rationale>This setting is only appropriate for routers and it should be disabled on all other systems.</rationale>
<ident cce="4155-8" />
<oval id="sysctl_net_ipv4_conf_all_send_redirects" />
<ref nist="CM-6" />
</Rule>

<Rule id="disable_sysctl_ipv4_ip_forward">
<title>Disable net.ipv4.ip_forward Kernel Runtime Parameter</title>
<description>IP forwarding should be disabled.</description>
<rationale>The ability to forward packets between two networks is only appropriate for routers. This setting
should be disabled on all other systems.</rationale>
<ident cce="3561-8" />
<oval id="sysctl_net_ipv4_ip_forward" />
<ref nist="AC-3, CM-6, CM-7, SC-5" />
</Rule>
</Group>

<Group id="network_host_and_router_parameters">
<title>Set Network Related Kernel Runtime Parameters</title>
<description>Edit the file <tt>/etc/sysctl.conf</tt> and add or correct the
following lines:
<pre>net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.default.secure_redirects = 0
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_ignore_bogus_error_messages = 1
net.ipv4.tcp_syncookies = 1
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1</pre>
These options improve Linux's ability to defend against
certain types of IPv4 protocol attacks.
</description>

<Value id="sysctl_net_ipv4_conf_all_accept_source_route_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.all.accept_source_route</title>
<description>Trackers could be using source-routed packets to
generate traffic that seems to be intra-net, but actually was
created outside and has been redirected.</description>
<value selector="">0</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>

<Value id="sysctl_net_ipv4_conf_all_accept_redirects_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.all.accept_redirects</title>
<description>Disable ICMP Redirect Acceptance</description>
<value selector="">0</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>

<Value id="sysctl_net_ipv4_conf_all_secure_redirects_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.all.secure_redirects</title>
<description>Enable to prevent hijacking of routing path by only
allowing redirects from gateways known in routing
table.</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>

<Value id="sysctl_net_ipv4_conf_all_log_martians_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.all.log_martians</title>
<description>Disable so you don't Log Spoofed Packets, Source
Routed Packets, Redirect Packets</description>
<value selector="">0</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_conf_default_accept_source_route_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.default.accept_source_route</title>
<description>Disable IP source routing?</description>
<value selector="">0</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_conf_default_accept_redirects_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.default.accept_redirects</title>
<description>Disable ICMP Redirect Acceptance?</description>
<value selector="">0</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_conf_default_secure_redirects_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.default.secure_redirects</title>
<description>Log packets with impossible addresses to kernel
log?</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.icmp_echo_ignore_broadcasts</title>
<description>Ignore all ICMP ECHO and TIMESTAMP requests sent to it
via broadcast/multicast</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_icmp_ignore_bogus_error_messages_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.icmp_ignore_bogus_error_messages</title>
<description>Enable to prevent certain types of
attacks</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_tcp_syncookies_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.tcp_syncookies</title>
<description>Enable to turn on TCP SYN Cookie
Protection</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_conf_all_rp_filter_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.all.rp_filter</title>
<description>Enable to enforce sanity checking, also called ingress
filtering or egress filtering. The point is to drop a packet if the
source and destination IP addresses in the IP header do not make
sense when considered in light of the physical interface on which
it arrived.</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>


<Value id="sysctl_net_ipv4_conf_default_rp_filter_value" type="string"
operator="equals" interactive="0">
<title>net.ipv4.conf.default.rp_filter</title>
<description>Enables source route verification</description>
<value selector="">1</value>
<value selector="enabled">1</value>
<value selector="disabled">0</value>
</Value>

<Rule id="set_sysctl_net_ipv4_conf_all_accept_source_route">
<title>Set net.ipv4.conf.all.accept_source_route Kernel Runtime Parameter</title>
<description>Accepting source routed packets should be:
<sub idref="sysctl_net_ipv4_conf_all_accept_source_route_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="4236-6" />
<oval id="sysctl_net_ipv4_conf_all_accept_source_route" value="sysctl_net_ipv4_conf_all_accept_source_route_value" />
<ref nist="CM-7" />
</Rule>

<Rule id="set_sysctl_net_ipv4_conf_all_accept_redirects">
<title>Set net.ipv4.conf.all.accept_redirects Kernel Runtime Parameter</title>
<description>Accepting ICMP redirects should be:
<sub idref="sysctl_net_ipv4_conf_all_accept_redirects_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="4217-6" />
<oval id="sysctl_net_ipv4_conf_all_accept_redirects" value="sysctl_net_ipv4_conf_all_accept_redirects_value" />
<ref nist="CM-7" />
</Rule>


<Rule id="set_sysctl_net_ipv4_conf_all_secure_redirects">
<title>Set net.ipv4.conf.all.secure_redirects Kernel Runtime Parameter</title>
<description>Accepting "secure" ICMP redirects (those from gateways
listed in the default gateways list) should be:
<sub idref="sysctl_net_ipv4_conf_all_secure_redirects_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="3472-8" />
<oval id="sysctl_net_ipv4_conf_all_secure_redirects" value="sysctl_net_ipv4_conf_all_secure_redirects_value" />
<ref nist="CM-7, AC-4" />
</Rule>

<Rule id="set_sysctl_net_ipv4_conf_all_log_martians">
<title>Set net.ipv4.conf.all.log_martians Kernel Runtime Parameter</title>
<description>Logging of "martian" packets (those with impossible
addresses) should be:
<sub idref="sysctl_net_ipv4_conf_all_log_martians_value" />for all interfaces
as appropriate.</description>
<rationale>The presence of suspicious packets, such as spoofed packets, source-routed packets, and redirects
could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.</rationale>
<ident cce="4320-8" />
<oval id="sysctl_net_ipv4_conf_all_log_martians" value="sysctl_net_ipv4_conf_all_log_martians_value" />
<ref nist="CM-7" />
</Rule>


<Rule id="set_sysctl_net_ipv4_conf_default_accept_source_route">
<title>Set net.ipv4.conf.default.accept_source_route Kernel Runtime Parameter</title>
<description>The default setting for accepting source routed
packets should be:
<sub idref="sysctl_net_ipv4_conf_default_accept_source_route_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="4091-5" />
<oval id="sysctl_net_ipv4_conf_all_accept_source_route" value="sysctl_net_ipv4_conf_all_accept_source_route_value" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>


<Rule id="set_sysctl_net_ipv4_conf_default_accept_redirects">
<title>Set net.ipv4.conf.default.accept_redirects Kernel Runtime Parameter</title>
<description>The default setting for accepting ICMP redirects
should be:
<sub idref="sysctl_net_ipv4_conf_default_accept_redirects_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="4186-3" />
<oval id="sysctl_net_ipv4_conf_default_accept_redirects" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>


<Rule id="set_sysctl_net_ipv4_conf_default_secure_redirects">
<title>Set net.ipv4.conf.default.secure_redirects Kernel Runtime Parameter</title>
<description>The default setting for accepting "secure" ICMP
redirects (those from gateways listed in the default gateways list)
should be:
<sub idref="sysctl_net_ipv4_conf_default_secure_redirects_value" />for all interfaces
as appropriate.</description>
<rationale>This feature of the IPv4 protocol has few legitimate
uses. It should be disabled unless it is absolutely required.</rationale>
<ident cce="3339-9" />
<oval id="sysctl_net_ipv4_conf_default_secure_redirects" value="sysctl_net_ipv4_conf_default_secure_redirects_value" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>


<Rule id="set_sysctl_net_ipv4_icmp_echo_ignore_broadcasts">
<title>Set net.ipv4.icmp_echo_ignore_broadcasts Kernel Runtime Parameter</title>
<description>Ignoring ICMP echo requests (pings) sent to broadcast
/ multicast addresses should be:
<sub idref="sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value" />for all interfaces
as appropriate.</description>
<rationale>This setting prevents attacks against the ICMP protocol.</rationale>
<ident cce="3644-2" />
<oval id="sysctl_net_ipv4_icmp_echo_ignore_broadcasts" value="sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value" />
<ref nist="AC-3, CM-6, CM-7, SC-5" />
</Rule>


<Rule id="set_sysctl_net_ipv4_icmp_ignore_bogus_error_messages">
<title>Set net.ipv4.icmp_ignore_bogus_error_messages Kernel Runtime Parameter</title>
<description>Ignoring bogus ICMP responses to broadcasts should be:
<sub idref="sysctl_net_ipv4_icmp_ignore_bogus_error_messages_value" />for all interfaces
as appropriate.</description>
<rationale>This setting prevents attacks against the ICMP protocol.</rationale>
<ident cce="4133-5" />
<oval id="sysctl_net_ipv4_icmp_ignore_bogus_error_messages" value="sysctl_net_ipv4_icmp_ignore_bogus_error_messages_value" />
<ref nist="AC-3, CM-6, CM-7, SC-5" />
</Rule>

<Rule id="set_sysctl_net_ipv4_tcp_syncookies">
<title>Set net.ipv4.tcp_syncookies Kernel Runtime Parameter</title>
<description>Sending TCP syncookies should be:
<sub idref="sysctl_net_ipv4_tcp_syncookies_value" />for all interfaces
as appropriate.</description>
<rationale>This setting enables a cryptographic feature called SYN cookies to allow machines to continue to
accept legitimate connections when faced with a SYN flood attack.</rationale>
<ident cce="4265-5" />
<oval id="sysctl_net_ipv4_tcp_syncookies" value="sysctl_net_ipv4_tcp_syncookies_value" />
<ref nist="CM-6, CM-7" />
</Rule>

<Rule id="set_sysctl_net_ipv4_conf_all_rp_filter">
<title>Set net.ipv4.conf.all.rp_filter Kernel Runtime Parameter</title>
<description>Performing source validation by reverse path should
be:
<sub idref="sysctl_net_ipv4_conf_all_rp_filter_value" />for all interfaces
as appropriate.</description>
<rationale>This setting enables RFC-recommended source validation. It should not be used on machines which
are routers for very complicated networks, but is helpful for end hosts and routers serving small networks.</rationale>
<ident cce="4080-8" />
<oval id="sysctl_net_ipv4_conf_all_rp_filter" value="sysctl_net_ipv4_conf_all_rp_filter_value" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>

<Rule id="set_sysctl_net_ipv4_conf_default_rp_filter">
<title>Set net.ipv4.conf.default.rp_filter Kernel Runtime Parameter</title>
<description>The default setting for performing source validation
by reverse path should be:
<sub idref="sysctl_net_ipv4_conf_default_rp_filter_value" />for all interfaces
as appropriate.</description>
<rationale>This setting enables RFC-recommended source validation. It should not be used on machines which
are routers for very complicated networks, but is helpful for end hosts and routers serving small networks.</rationale>
<ident cce="3840-6" />
<oval id="sysctl_net_ipv4_conf_default_rp_filter" value="sysctl_net_ipv4_conf_default_rp_filter_value" />
<ref nist="AC-4, SC-5, SC-7" />
</Rule>

</Group>

</Group>

