<Group id="dns">
<title>DNS Server</title>
<description>Most organizations have an operational need to run at
least one nameserver. However, there are many common attacks
involving DNS server software, and this server software should 
be disabled on any system 
on which it is not needed.</description>

<Group id="disabling_dns_server">
<title>Disable DNS Server if Possible</title>
<description>
DNS software should be disabled on any machine which does not
need to be a nameserver. Note that the BIND DNS server software is
not installed on RHEL6 by default. The remainder of this section
discusses secure configuration of machines which must be
nameservers.
</description>

<Rule id="disable_dns_server">
<title>Disable DNS Server</title>
<description>
The <tt>named</tt> service can be disabled with following command:
<pre>
# chkconfig named off
</pre>
</description>
<rationale>
All network services involve some risk of compromise due to
implementation flaws and should be disabled if possible.
</rationale>
<ident cce="3578-2" />
<oval id="service_named_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>

<Rule id="uninstall_bind">
<title>Uninstall bind Package</title>
<description>To remove the <tt>bind</tt> package, which contains the <tt>named</tt> service, 
run the following command:
<pre>
# yum erase bind
</pre>
</description>
<rationale>
If there is no need to make DNS server software available, 
removing it provides a safeguard against its activation.
</rationale>
<ident cce="4219-2" />
<oval id="package_bind_removed" />
<ref nist="CM-6, CM-7" />
</Rule>

</Group> <!--<Group id="disabling_dns_server">-->

<Group id="dns_server_isolation">
<title>Isolate DNS from Other Services</title>
<description>This section discusses mechanisms for preventing the DNS server from interfering with other services. This is done both to protect the remainder of the network should a nameserver be compromised, and to make direct attacks on nameservers more difficult.</description>

<Rule id="dns_server_dedicated">
<title>Run DNS Software on Dedicated Servers if Possible</title>
<description>Since DNS is a high-risk service which must frequently be made available to the entire Internet, it is strongly
recommended that no other services be offered by machines which act as organizational DNS servers.</description>
<!--<ident cce="4219-2" />-->
<!--<oval id="dns_server_dedicated" />-->
<!--<ref nist="CM-6, CM-7" />-->
</Rule>

<Rule id="dns_server_chroot">
<title>Run DNS Software in a chroot Jail</title>
<description>Install the <tt>bind-chroot</tt> package:
<pre># yum install bind-chroot</pre>
Place a valid named.conf file inside the chroot jail:
<pre># cp /etc/named.conf /var/named/chroot/etc/named.conf
# chown root:root /var/named/chroot/etc/named.conf
# chmod 644 /var/named/chroot/etc/named.conf</pre>
Create and populate an appropriate zone directory within the jail, based on the options directive. If your <tt>named.conf</tt> includes:
<pre>options {
directory "/path/to/DIRNAME ";
...
}</pre>
then copy that directory and its contents from the original zone directory:
<pre># cp -r /path/to/DIRNAME /var/named/chroot/DIRNAME</pre>
Edit the file <tt>/etc/sysconfig/named</tt>. Add or correct the line:
<pre>ROOTDIR=/var/named/chroot</pre>
</description>
<rationale>Chroot jails are not foolproof. However, they serve to make it more difficult for a compromised program to be
used to attack the entire host. They do this by restricting a programâ€™s ability to traverse the directory upward,
so that files outside the jail are not visible to the chrooted process. Since RHEL supports a standard mechanism
for placing BIND in a chroot jail, you should take advantage of this feature.</rationale>
<warning category="general">If you are running BIND in a chroot jail, then you should use the jailed <tt>named.conf</tt> as the primary nameserver configuration file. That is, when this guide recommends editing <tt>/etc/named.conf</tt>, you should instead edit <tt>/var/named/chroot/etc/named.conf</tt>.
</warning>
<ident cce="3985-9, 4487-5, 4258-0" />
<!--<oval id="dns_server_chroot" />-->
<!--<ref nist="CM-6, CM-7" />-->
</Rule>

<Rule id="dns_server_firewall">
<title>Configure Firewalls to Protect the DNS Server</title>
<description>Edit the file <tt>/etc/sysconfig/iptables</tt>. Add the following lines, ensuring that they appear before the final LOG and DROP lines for the RH-Firewall-1-INPUT chain:
<pre>-A RH-Firewall-1-INPUT -m state --state NEW -p udp --dport 53 -j ACCEPT
-A RH-Firewall-1-INPUT -m state --state NEW -p tcp --dport 53 -j ACCEPT</pre>
</description>
<rationale>These lines are necessary in order to allow remote machines to contact the DNS server. If this server is only
available to the local network, it may be appropriate to insert a -s flag into this rule to allow traffic only from
packets on the local network.</rationale>
<!--<ident cce="3985-9, 4487-5, 4258-0" /> -->
<!--<oval id="dns_server_firewall" />-->
<!--<ref nist="CM-6, CM-7" />-->
</Rule>

</Group> <!--<Group id="dns_server_isolation">-->

<Group id="dns_server_protection">
<title>Protect DNS Data from Tampering or Attack</title>
<description>This section discusses DNS configuration options which make it more difficult for attackers to gain access to
private DNS data or to modify DNS data.</description>

</Group> <!--<Group id="dns_server_protection">-->

</Group> <!--<Group id="dns">-->
