<Profile id="ospp42-draft-rhel7">
<title>Protection Profile for General Purpose Operating Systems</title>
<description>This profile reflects mandatory configuration controls identified
in the NIAP Configuration Annex to the Protection Profile for General Purpose Operating
Systems (Protection Profile Version 4.2 draft). 

This Annex is consistent with CNSSI-1253, which requires US National Security
Systems to adhere to certain configuration parameters. Accordingly, configuration
guidance produced according to the requirements of this Annex is suitable for use
in US National Security Systems.
</description>

<select idref="installed_OS_is_certified" selected="true" />
<select idref="bootloader_audit_argument" selected="true" />
<select idref="service_auditd_enabled" selected="true" />
<select idref="grub2_enable_fips_mode" selected="true" />
<select idref="rpm_verify_hashes" selected="true" />
<select idref="selinux_all_devicefiles_labeled" selected="true" />
<select idref="selinux_confinement_of_daemons" selected="true" />
<select idref="selinux_policytype" selected="true" />
<select idref="selinux_state" selected="true" />
<select idref="audit_rules_immutable" selected="true" />


<!-- OSPP v4.1 config annex is available here:
     https://commoncriteria.github.io/pp/operatingsystem/configannex.html
-->

<!--
     ## BEGIN VARIABLE REFINEMENT
	CNSSI-1253 VALUE OR DOD-SPECIFIC VALUE -->
<refine-value idref="var_selinux_policy_name" selector="targeted" />
<refine-value idref="var_selinux_state" selector="enforcing" />



<!-- FMT_MOF_EXT.1: Configure Minimum Password Length to 12 Characters -->
<refine-value idref="var_password_pam_minlen" selector="12" />
<select idref="accounts_password_pam_minlen" selected="true" />
<select idref="accounts_password_minlen_login_defs" selected="true" />

<!-- FMT_MOF_EXT.1: Require at Least 1 Special Character in Password -->
<refine-value idref="var_password_pam_ocredit" selector="1" />
<select idref="accounts_password_pam_ocredit" selected="true" />

<!-- FMT_MOF_EXT.1: Require at Least 1 Numeric Character in Password -->
<refine-value idref="var_password_pam_dcredit" selector="1" />
<select idref="accounts_password_pam_dcredit" selected="true" />

<!-- FMT_MOF_EXT.1: Require at Least 1 Uppercase Character in Password -->
<refine-value idref="var_password_pam_ucredit" selector="1" />
<select idref="accounts_password_pam_ucredit" selected="true" />

<!-- FMT_MOF_EXT.1: Require at Least 1 Lowercase Character in Password -->
<refine-value idref="var_password_pam_lcredit" selector="1" />
<select idref="accounts_password_pam_lcredit" selected="true" />

<!-- FMT_MOF_EXT.1: Enable Screen Lock -->
<select idref="package_screen_installed" selected="true" />

<!-- FMT_MOF_EXT.1: Set Screen Lock Timeout Period to 30 Minutes or Less -->
<!-- ALSO: This is about screen locking, NOT AUTOMATED LOGOUT e.g. ssh timeout) -->
<select idref="dconf_gnome_screensaver_idle_activation_enabled" selected="true" />
<select idref="dconf_gnome_screensaver_idle_delay" selected="true" />
<select idref="dconf_gnome_screensaver_lock_delay" selected="true" />
<select idref="dconf_gnome_screensaver_lock_enabled" selected="true" />
<select idref="dconf_gnome_screensaver_mode_blank" selected="true" />
<select idref="dconf_gnome_screensaver_user_info" selected="true" />
<select idref="dconf_gnome_screensaver_user_locks" selected="true" />
<select idref="dconf_gnome_session_idle_user_locks" selected="true" />
<select idref="accounts_tmout" selected="true" />


<!-- FIA_AFL.1: Disable Unauthenticated Login (such as Guest Accounts) -->
<select idref="bootloader_password" selected="true" />
<select idref="bootloader_uefi_password" selected="true" />
<select idref="disable_interactive_boot" selected="true" />
<select idref="no_empty_passwords" selected="true" />
<select idref="require_singleuser_auth" selected="true" />
<select idref="service_debug-shell_disabled" selected="true" />
<select idref="sshd_disable_empty_passwords" selected="true" />
<select idref="sshd_disable_root_login" selected="true" />
<select idref="gnome_gdm_disable_automatic_login" selected="true" />
<select idref="gnome_gdm_disable_guest_login" selected="true" />
<select idref="sssd_offline_cred_expiration" selected="true" />
<select idref="sssd_memcache_timeout" selected="true" />
<select idref="disable_host_auth" selected="true" />
<select idref="sshd_disable_gssapi_auth" selected="true" />
<select idref="sshd_disable_kerb_auth" selected="true" />
<select idref="sshd_disable_rhosts_rsa" selected="true" />
<select idref="sshd_disable_rhosts" selected="true" />
<select idref="sshd_disable_user_known_hosts" selected="true" />



<!-- FMT_MOF_EXT.1: Set Maximum Number of Authentication Failures to 3 Within
     15 Minutes -->
<refine-value idref="var_accounts_passwords_pam_faillock_deny" selector="3" />
<refine-value idref="var_accounts_passwords_pam_faillock_fail_interval" selector="900" />
<refine-value idref="var_accounts_passwords_pam_faillock_unlock_time" selector="never" />
<refine-value idref="var_password_pam_retry" selector="3" />

<select idref="accounts_password_pam_retry" selected="true" />
<select idref="accounts_passwords_pam_faillock_deny_root" selected="true" />
<select idref="accounts_passwords_pam_faillock_deny" selected="true" />
<select idref="accounts_passwords_pam_faillock_interval" selected="true" />
<select idref="accounts_passwords_pam_faillock_unlock_time" selected="true" />
<select idref="dconf_gnome_login_retries" selected="true" />

<!-- FMT_MOF_EXT.1: Enable Host-Based Firewall -->
<select idref="service_firewalld_enabled" selected="true" />
<select idref="set_firewalld_default_zone" selected="true" />

<!-- FMT_MOF_EXT.1: Configure Name/Address of Remote Management Server From Which
     to Receive Configuration Settings -->
<!-- TO DO: -->

<!-- FAU_GEN.1.1.c: Configure the System to Offload Audit Records to a Log Server -->
<select idref="auditd_audispd_syslog_plugin_activated" selected="true" />
<select idref="auditd_audispd_configure_remote_server" selected="true" />
<select idref="rsyslog_remote_loghost" selected="true" />
<select idref="auditd_audispd_encrypt_sent_records" selected="true" />

<!-- FMT_MOF_EXT.1: Set Logon Warning Banner -->
<refine-value idref="login_banner_text" selector="usgcb_default" />
<select idref="sshd_enable_warning_banner" selected="true" />
<select idref="banner_etc_issue" selected="true" />
<select idref="dconf_gnome_banner_enabled" selected="true" />
<select idref="dconf_gnome_login_banner_text" selected="true" />

<!-- FAU_GEN.1.1.c: Audit All Logons (Successful/Unsuccessful) and Logoffs (Successful) -->
<!-- NOTE: This is default, non-configurable behavior. No config check needed beyond
     	   ensuring RHEL is being used -->
<select idref="audit_rules_login_events_faillock" selected="true" />
<select idref="audit_rules_login_events_lastlog" selected="true" />
<select idref="audit_rules_login_events_tallylog" selected="true" />


<!-- FAU_GEN.1.1.c: Audit File and Object Events (Unsuccessful) -->
<!--	(1) Create (Success/Failure) -->
<!-- TO DO:
     -a always,exit -F arch=b32 -S link,mknod,mkdir,symlink,mknodat,linkat,symlinkat -F exit=-EACCES -F key=creation
-a always,exit -F arch=b64 -S mkdir,creat,link,symlink,mknod,mknodat,linkat,symlinkat -F exit=-EACCES -F key=creation
-a always,exit -F arch=b32 -S link,mkdir,symlink,mkdirat -F exit=-EPERM -F key=creation
-a always,exit -F arch=b64 -S mkdir,link,symlink,mkdirat -F exit=-EPERM -F key=creation
-->
<select idref="audit_rules_unsuccessful_file_modification_creat" selected="true" />

<!-- 	(2) Access (Success/Failure) -->
<select idref="audit_rules_unsuccessful_file_modification_openat" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_open_by_handle_at" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_open" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_ftruncate" selected="true" />
<select idref="audit_rules_unsuccessful_file_modification_truncate" selected="true" />


<!--	(3) Delete (Success/Failure) -->
<!-- TO DO: Update with EACCES and EPERM -->
<select idref="audit_rules_file_deletion_events_renameat" selected="true" />
<select idref="audit_rules_file_deletion_events_rename" selected="true" />
<select idref="audit_rules_file_deletion_events_rmdir" selected="true" />
<select idref="audit_rules_file_deletion_events_unlinkat" selected="true" />
<select idref="audit_rules_file_deletion_events_unlink" selected="true" />

<!--	(4) Modify (Success/Failure) -->


<!--	(5) Permission Modification (Success/Failure) -->
<select idref="audit_rules_dac_modification_chmod" selected="true" />
<select idref="audit_rules_dac_modification_fchmodat" selected="true" />
<select idref="audit_rules_dac_modification_fchmod" selected="true" />
<select idref="audit_rules_dac_modification_fremovexattr" selected="true" />
<select idref="audit_rules_dac_modification_fsetxattr" selected="true" />
<select idref="audit_rules_dac_modification_lremovexattr" selected="true" />
<select idref="audit_rules_dac_modification_lsetxattr" selected="true" />
<select idref="audit_rules_dac_modification_removexattr" selected="true" />
<select idref="audit_rules_dac_modification_setxattr" selected="true" />
<select idref="audit_rules_execution_chcon" selected="true" />
<select idref="audit_rules_execution_restorecon" selected="true" />
<select idref="audit_rules_execution_semanage" selected="true" />
<select idref="audit_rules_execution_setsebool" selected="true" />
<select idref="audit_rules_mac_modification" selected="true" />

<!--	(6) Ownership Modification (Success/Failure) -->
<select idref="audit_rules_dac_modification_chown" selected="true" />
<select idref="audit_rules_dac_modification_fchownat" selected="true" />
<select idref="audit_rules_dac_modification_fchown" selected="true" />
<select idref="audit_rules_dac_modification_lchown" selected="true" />


<!-- FAU_GEN.1.1.c: Audit User and Group Management Events (Successful and Unsuccessful) -->
<!--	(1) User add, delete, modify, suspend, lock (Success/Failure) -->
<select idref="audit_rules_privileged_commands_passwd" selected="true" />
<select idref="audit_rules_privileged_commands_unix_chkpwd" selected="true" />
<select idref="audit_rules_privileged_commands_userhelper" selected="true" />
<select idref="audit_rules_privileged_commands_chage" selected="true" />
<select idref="audit_rules_privileged_commands_chsh" selected="true" />
<select idref="audit_rules_privileged_commands_pt_chown" selected="true" />
<select idref="audit_rules_sysadmin_actions" selected="true" />

<!--	(2) Group/Role add, delete, modify (Success/Failure) -->
<select idref="audit_rules_privileged_commands_gpasswd" selected="true" />
<select idref="audit_rules_privileged_commands_newgrp" selected="true" />
<select idref="audit_rules_usergroup_modification_group" selected="true" />
<select idref="audit_rules_usergroup_modification_gshadow" selected="true" />
<select idref="audit_rules_usergroup_modification_opasswd" selected="true" />
<select idref="audit_rules_usergroup_modification_passwd" selected="true" />
<select idref="audit_rules_usergroup_modification_shadow" selected="true" />


<!-- FAU_GEN.1.1.c: Audit Privilege or Role Escalation Events (Successful and Unsuccessful) -->
<select idref="audit_rules_privileged_commands_sudoedit" selected="true" />
<select idref="audit_rules_privileged_commands_sudo" selected="true" />
<select idref="audit_rules_privileged_commands_su" selected="true" />


<!-- FAU_GEN.1.1.c: Audit All Audit and Log Data Accesses (Successful and Unsuccessful) -->
<select idref="audit_rules_session_events" selected="true" />


<!-- FAU_GEN.1.1.c: Audit Cryptographic Verification of Software (Successful and Unsuccessful) -->
<select idref="ensure_redhat_gpgkey_installed" selected="true" />
<select idref="ensure_gpgcheck_globally_activated" selected="true" />
<select idref="ensure_gpgcheck_never_disabled" selected="true" />
<select idref="ensure_gpgcheck_local_packages" selected="true" />
<select idref="audit_rules_privileged_commands_ssh_keysign" selected="true" />

<!-- FAU_GEN.1.1.c: Audit Program Initiations (Successful and Unsuccessful) -->
<select idref="rsyslog_cron_logging" selected="true" />

<!-- FAU_GEN.1.1.c: Audit System Reboot, Restart, and Shutdown Events (Success/Failure) -->

<!-- FAU_GEN.1.1.c: Audit Kernel Module Loading and Unloading Events (Success/Failure -->
<select idref="audit_rules_kernel_module_loading_delete" selected="true" />
<select idref="audit_rules_kernel_module_loading_init" selected="true" />
<select idref="audit_rules_kernel_module_loading_insmod" selected="true" />
<select idref="audit_rules_kernel_module_loading_modprobe" selected="true" />
<select idref="audit_rules_kernel_module_loading_rmmod" selected="true" />

<!-- FMT_MOF_EXT.1: Enable Automatic Software Update -->
<select idref="security_patches_up_to_date" selected="true" />

</Profile>
