<?xml version="1.0" encoding="UTF-8"?>

<oval_definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd"
	xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:unx="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix"
	xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5">
	<generator>
		<oval:schema_version>5.4</oval:schema_version>
		<oval:timestamp>2010-07-08T11:19:35.419-04:00</oval:timestamp>
	</generator>

	<definitions>
		<definition version="1" class="inventory"
			id="oval:com.redhat.eap5.scap:def:599901">
			<metadata>
				<title>JBoss Enterprise Application Platform 5.1.0</title>
				<description>EAP Version should be 5.1.0</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:59990101" />
			</criteria>
		</definition>
		
		<definition version="1" class="inventory"
			id="oval:com.redhat.eap5.scap:def:599801">
			<metadata>
				<title>JBoss Enterprise Application Platform 5.1.2</title>
				<description>EAP Version should be 5.1.2</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:59980101" />
			</criteria>
		</definition>
		
		<definition version="1" class="inventory"
			id="oval:com.redhat.eap5.scap:def:599701">
			<metadata>
				<title>JBoss Enterprise Application Platform 5.1.1</title>
				<description>EAP Version should be 5.1.1</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:59970101" />
			</criteria>
		</definition>
		
		<definition version="1" class="inventory"
			id="oval:com.redhat.eap5.scap:def:599601">
			<metadata>
				<title>JBoss Enterprise Application Platform 5.0.0</title>
				<description>EAP Version should be 5.0.0</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:59960101" />
			</criteria>
		</definition>
		
		<definition version="1" class="inventory"
			id="oval:com.redhat.eap5.scap:def:600001">
			<metadata>
				<title>JBoss Enterprise Application Platform 5.0.1</title>
				<description>EAP Version should be 5.0.1</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:60000101" />
			</criteria>
		</definition>
		<!-- Removed for now
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:200101">
			<metadata>
				<title>JBoss Enterprise Application Platform should be the correct version</title>
				<description>Evaluated JBoss installation must be JBoss Enterprise Application Platform 5, Version 5.1.0 or 5.1.1</description>
			</metadata>
			<criteria operator="OR">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20010101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20010102" />
			</criteria>
		</definition>
		-->
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:200601">
			<metadata>
				<title>Ensure JMX Console is either secured or removed</title>
				<description>Ensure JMX Console is either secured or removed</description>
			</metadata>
			<criteria operator="OR">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20060101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20060102" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:200701">
			<metadata>
				<title>Ensure Web Console is either secured or removed</title>
				<description>Ensure Web Console is either secured or removed</description>
			</metadata>
			<criteria operator="OR">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20070101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20070102" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:200801">
			<metadata>
				<title>Ensure Admin Console is either secured or removed</title>
				<description>Ensure Admin Console is either secured or removed</description>
			</metadata>
			<criteria operator="OR">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20080101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20080102" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:200901">
			<metadata>
				<title>SNMP must not be deployed</title>
				<description>SNMP must not be deployed</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20090101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:201201">
			<metadata>
				<title>Disable AJP from JBoss Web</title>
				<description>All AJP Connectors should be removed from JBOSS_HOME/server/production/deploy/jbossweb.sar/server.xml.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20120101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:201301">
			<metadata>
				<title>Clustering High-Availability must be disabled</title>
				<description>Disable the HA Naming service interface via HTTP.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20130101" />
			</criteria>
		</definition>
			
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:201801">
			<metadata>
				<title>Ensure Technology Preview components are disabled</title>
				<description>PicketLink technology preview folder should be deleted.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20180101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:202401">
			<metadata>
				<title>Ensure all required information is displayed in Audit Logger</title>
				<description>The Security Audit Appender must log all identified information.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20240101" />
			</criteria>
		</definition>
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:203001">
			<metadata>
				<title>The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication</title>
				<description>The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authN</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20300101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20300102" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20300103" />
			</criteria>
		</definition>
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:203101">
			<metadata>
				<title>The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authorization</title>
				<description>The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20310101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20310102" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20310103" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:203201">
			<metadata>
				<title>The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authorization</title>
				<description>The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20320101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:204501">
			<metadata>
				<title>Ensure default HSQLDB is disabled</title>
				<description>All files for the default HSQLDB should be deleted.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20450101" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20450102" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20450103" />
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20450104" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:204601">
			<metadata>
				<title>Ensure HSQLDB Security Domain is removed</title>
				<description>Security Domain for the default HSQLDB should be removed.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20460101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:201901">
			<metadata>
				<title>Ensure Security Audit Appender is enabled</title>
				<description>The log4j configuration file must have an AUDIT appender uncommented.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20190101"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:202001">
			<metadata>
				<title>Ensure Security Audit Provider is enabled</title>
				<description>The log4j configuration file must have a security audit provider uncommented.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20200101"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:202101">
			<metadata>
				<title>Ensure Configure SecurityInterceptor logging level is set correctly</title>
				<description>SecurityInterceptor logging level should be set to TRACE and Reference the AUDIT Appender.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20210101"/>
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20210102"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:202201">
			<metadata>
				<title>Ensure logging is enabled for ServerImpl log messages</title>
				<description>Ensure logging is enabled for ServerImpl log messages.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20220101"/>
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20220102"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:202901">
			<metadata>
				<title>The JMXInvokerServlet servlet must be secured against web attacks</title>
				<description>The JMXInvokerServlet servlet must be secured against web attacks</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20290101"/>
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20290102"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:203801">
			<metadata>
				<title>The allRolesMode must be configured appropriately</title>
				<description>The allRolesMode within JBOSS_HOME/server/production/deploy/jbossweb.sar/server.xml must be set to strict. This requires the authenticated user to be assigned to one of the web-app/security-role/role-name roles in order to be authorized.</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20380101"/>
			</criteria>
		</definition>
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:204301">
			<metadata>
				<title>Configure Java Security Manager to use an environment specific policy</title>
				<description>The Java Security Manager is a crucial piece of the Java security infrastructure. JBoss Enterprise Application Platform should be configured to load a Java security policy that has been vetted for use in the environment. This precludes the use of the simple default policy that ships with JBoss, but does not preclude the use of preconfigured policy files like the security policy designed for use in a Common Criteria environment (See JBoss Common Criteria Configuration Guide for details).</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:20430101"/>
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:110301">
			<metadata>
				<title>Production applications should not log output to the JBoss console</title>
				<description></description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:11030101" />
			</criteria>
		</definition>
		
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:113001">
			<metadata>
				<title>Disable Hot Deployment in production</title>
				<description></description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:11300101" />
			</criteria>
		</definition>
		
		<!--Currently, this test only checks to see if the value is 1800-->
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:109601">
			<metadata>
				<title>DefaultCacheTimeout must be configured properly</title>
				<description></description>
			</metadata>
			<criteria>
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:10960101" />
			</criteria>
		</definition>
		
		<!--
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:300101">
			<metadata>
				<title>NOHTMLTITLE</title>
				<description>NOHTMLDESCRIPTION</description>
			</metadata>
			<criteria operator="AND">
				<criterion test_ref="oval:com.redhat.eap5.scap:tst:30010101" />
			</criteria>
		</definition>
		-->
		<!--
		<definition version="1" class="compliance"
			id="oval:com.redhat.eap5.scap:def:300201">
			<metadata>
				<title>Remove, rename, or comment out the default roles from production servers</title>
				<description>Remove, rename, or comment out the default role definitions in the default &lt;application-policy&gt; elements.</description>
			</metadata>
			<criteria operator="AND">
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020101" />
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020102" />
				</criteria>
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020201" /> 
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020202" /> 
				</criteria>
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020301" /> 
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020302" />
				</criteria>
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020401" />
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020402" />
				</criteria>
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020501" />
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020502" />
				</criteria>
				<criteria operator="OR">
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020601" />
					<criterion test_ref="oval:com.redhat.eap5.scap:tst:30020602" />
				</criteria>
			</criteria>				
		</definition>		-->
		
	</definitions>

	<tests>
		<!--
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:30010101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:30010101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:30010101" />
		</ind:textfilecontent54_test>
		-->
		<!--
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020101"
			version="1" check="all" check_existence="none_exist" comment="jbossws-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020101"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020201"
			version="1" check="all" check_existence="none_exist" comment="jmx-console-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020201"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020301"
			version="1" check="all" check_existence="none_exist" comment="messaging-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020301"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020401"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war\WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020401"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020501"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/admin-console.war/WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020501"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020601"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/management\console-mgr.sar\web-console.war\WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020601"/>
		</unx:file_test>-->
<!-- ============================================================================================================================================================================ -->
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:59990101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:59990101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:59990101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:59980101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:59980101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:59980101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:59970101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:59970101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:59970101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:59960101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:59960101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:59960101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:60000101"
			version="1" check="all" comment="Check EAP Version">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:60000101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:60000101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:20010101"
			version="1" check="all" comment="Check EAP Version 5.1.0">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20010101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20010101" />
		</ind:textfilecontent54_test>
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:20010102"
			version="1" check="all" comment="Check EAP Version 5.1.1">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20010101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20010102" />
		</ind:textfilecontent54_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20060101"
			version="1" check="all" check_existence="none_exist" comment="JMX Console is Removed">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20060101"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20060102" version="1" comment="JMX Console is Secured">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20060102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20060102" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20070101"
			version="1" check="all" check_existence="none_exist" comment="Web Console is Removed">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20070101"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20070102" version="1" comment="Web Console is Secured">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20070102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20070102" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20080101"
			version="1" check="all" check_existence="none_exist" comment="Admin Console is Removed">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20080101"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20080102" version="1" comment="Admin Console is Secured">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20080102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20080102" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20090101"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/production/deploy/snmp-adaptor.sar Should be Deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20090101"/>
		</unx:file_test>
						
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20120101" version="1" comment="AJP Must be Disabled">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20120101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20120101" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20130101"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/production/deploy/cluster/hajndi-jboss-beans.xml must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20130101"/>
		</unx:file_test>
				
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20180101"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/../picketlink must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20180101"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20240101" version="1" comment="Audit Logging Must Log all Information">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20240101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20240101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20300101" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20300101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20300101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20300102" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20300102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20300102" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20300103" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20300103" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20300103" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20310101" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20310101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20310101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20310102" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20310102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20310102" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20310103" version="1" comment="JMXServlet Must be Secured.">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20310103" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20310103" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20320101" version="1" comment="JBossWeb Realm Must Be Defined">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20320101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20320101" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20450101"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/production/deploy/hsqldb-ds.xml must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20450101"/>
		</unx:file_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20450102"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/common/lib/hsqldb.jar must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20450102"/>
		</unx:file_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20450103"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/common/lib/hsqldb-plugin.jar must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20450103"/>
		</unx:file_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:20450104"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/production/deploy/messaging/hsqldb-persistence-service.xml must be deleted">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:20450104"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20460101" version="1" comment="HSQLDB Security Domain must be removed">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20460101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20460101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20190101" version="1" comment="AUDIT appender must not be commented">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20190101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20190101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20200101" version="1" comment="AUDIT appender must not be commented">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20200101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20200101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20210101" version="1" comment="SecurityInterceptor logging level is set correctly">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20210101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20210101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20210102" version="1" comment="SecurityInterceptor references correct appender">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20210102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20210102" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20220101" version="1" comment="ServerImpl logging level is set correctly">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20220101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20220101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20220102" version="1" comment="ServerImpl references correct appender">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20220102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20220102" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20290101" version="1" comment="JMXInvokerServlet servlet must be secured">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20290101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20290101" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20290102" version="1" comment="JMXInvokerServlet servlet must be secured">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20290102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20290102" />
		</ind:xmlfilecontent_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:20380101" version="1" comment="allRolesMode is strict">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20380101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20380101" />
		</ind:xmlfilecontent_test>
		
		<!--<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:20600101"
			version="1" check="all" comment="Validate JBoss keystore exists and is in use">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20600101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20600101" />
		</ind:textfilecontent54_test>-->
		
		<!--<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:20600102"
			version="1" check="all" comment="Validate JBoss keystore exists and is in use">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20600102" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20600102" />
		</ind:textfilecontent54_test>-->
		
		<ind:textfilecontent54_test id="oval:com.redhat.eap5.scap:tst:20430101"
			version="1" check="all" comment="Java Security Manager to use security_ccpolicy">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:20430101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:20430101" />
		</ind:textfilecontent54_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:11030101" version="1" comment="No Console Logging">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:11030101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:11030101" />
		</ind:xmlfilecontent_test>
		
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:11300101"
			version="1" check="all" check_existence="none_exist" comment="Disable Hot Deploy">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:11300101"/>
		</unx:file_test>
		
		<ind:xmlfilecontent_test check="all"
			id="oval:com.redhat.eap5.scap:tst:10960101" version="1" comment="DefaultCacheTimeout Set Properly">
			<ind:object object_ref="oval:com.redhat.eap5.scap:obj:10960101" />
			<ind:state state_ref="oval:com.redhat.eap5.scap:ste:10960101" />
		</ind:xmlfilecontent_test>
		
	</tests>

	<objects>
		<ind:environmentvariable_object id="oval:com.redhat.eap5.scap:obj:9001"
			version="1">
			<ind:name>JBOSS_HOME</ind:name>
		</ind:environmentvariable_object>
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:59990101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:59980101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:59970101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:59960101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:60000101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:20010101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900101"/>
			<ind:filename>boot.log</ind:filename>
			<ind:pattern operation="pattern match">Release ID: JBoss \[EAP\] ([0-9\.]{3,5})</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20060101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900114"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20060102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900117" />
			<ind:filename>jboss-web.xml</ind:filename>
			<ind:xpath>boolean(/jboss-web/security-domain/text())</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20070101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900115"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20070102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900118" />
			<ind:filename>jboss-web.xml</ind:filename>
			<ind:xpath>boolean(/jboss-web/security-domain/text())</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20080101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900116"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20080102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900119" />
			<ind:filename>jboss-web.xml</ind:filename>
			<ind:xpath>boolean(/jboss-web/security-domain/text())</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20090101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900103"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
				
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20120101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900110" />
			<ind:filename>server.xml</ind:filename>
			<ind:xpath>boolean(/Server/Service/Connector[contains(@protocol,'AJP')]/@protocol)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20320101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900110" />
			<ind:filename>server.xml</ind:filename>
			<ind:xpath>boolean(/Server/Service[@name='jboss.web']/Engine[@name='jboss.web']/Realm[@className='org.jboss.web.tomcat.security.JBossWebRealm' and @certificatePrincipal='org.jboss.security.auth.certs.SubjectDNMapping'])</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20130101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900104"/>
			<unx:filename>hajndi-jboss-beans.xml</unx:filename>
		</unx:file_object>
				
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20180101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900105"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20240101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>/log4j:configuration/appender[@name="AUDIT"]/layout[@class="org.apache.log4j.PatternLayout"]/param[@name="ConversionPattern"]/@value</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20300101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900102" />
			<ind:filename>jmx-invoker-service.xml</ind:filename>
			<ind:xpath>boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthenticationInterceptor' and @securityDomain='java:/jaas/jmx-console'])</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20300102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>login-config.xml</ind:filename>
			<ind:xpath>/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20300103"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>login-config.xml</ind:filename>
			<ind:xpath>/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20310101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900102" />
			<ind:filename>jmx-invoker-service.xml</ind:filename>
			<ind:xpath>boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthorizationInterceptor' and @authorizingClass='org.jboss.jmx.connector.invoker.RolesAuthorization'])</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20310102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>login-config.xml</ind:filename>
			<ind:xpath>/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20310103"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>login-config.xml</ind:filename>
			<ind:xpath>/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20450101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900102"/>
			<unx:filename>hsqldb-ds.xml</unx:filename>
		</unx:file_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20450102"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900107"/>
			<unx:filename>hsqldb.jarl</unx:filename>
		</unx:file_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20450103"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900106"/>
			<unx:filename>hsqldb-plugin.jar</unx:filename>
		</unx:file_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:20450104"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900107"/>
			<unx:filename>hsqldb-persistence-service.xml</unx:filename>
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20460101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>login-config.xml</ind:filename>
			<ind:xpath>boolean(/policy/application-policy[@name="HsqlDbRealm"]/@name)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20190101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/appender[@name="AUDIT"]/@name)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20200101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/category[@name="org.jboss.security.audit.providers.LogAuditProvider"]/@name)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20210101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/category[@name="org.jboss.ejb.plugins.SecurityInterceptor"]/priority[@value="TRACE"]/@value)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20210102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/category[@name="org.jboss.ejb.plugins.SecurityInterceptor"]/appender-ref[@ref="AUDIT"]/@ref)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20220101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/category[@name="org.jboss.bootstrap.microcontainer"]/priority[@value="INFO"]/@value)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20220102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/category[@name="org.jboss.bootstrap.microcontainer"]/appender-ref[@ref="AUDIT"]/@ref)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20290101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900111" />
			<ind:filename>web.xml</ind:filename>
			<ind:xpath>boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'GET')])</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20290102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900111" />
			<ind:filename>web.xml</ind:filename>
			<ind:xpath>boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'POST')])</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:20380101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900110" />
			<ind:filename>server.xml</ind:filename>
			<ind:xpath>/Server/Service/Engine[@name="jboss.web"]/Realm/@allRolesMode</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<!--<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:20600101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900121"/>
			<ind:filename>security_cc.policy</ind:filename>
			<ind:pattern operation="pattern match">((?://)?keystore "file:\${jboss\.server\.home\.dir}/cc\.keystore";)</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:20600102"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900121"/>
			<ind:filename>security_cc.policy</ind:filename>
			<ind:pattern operation="pattern match">((?://)?keystorePasswordURL "file:\${jboss\.server\.home\.dir}/cc\.password";)</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>-->
		
		<ind:textfilecontent54_object id="oval:com.redhat.eap5.scap:obj:20430101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900121"/>
			<ind:filename>run.conf</ind:filename>
<!--			<ind:pattern operation="pattern match">((?:#*)JAVA_OPTS="\$JAVA_OPTS -Djava\.security\.manager -Djava\.security\.policy==\$JBOSS_HOME/bin/security_cc\.policy")</ind:pattern>-->
			<ind:pattern operation="pattern match">((?:#*)JAVA_OPTS="\$JAVA_OPTS -Djava\.security\.manager -Djava\.security\.policy==.*")</ind:pattern>
			<ind:instance datatype="int">1</ind:instance>
		</ind:textfilecontent54_object>
		
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:11030101"
			version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-log4j.xml</ind:filename>
			<ind:xpath>boolean(/log4j:configuration/root/appender-ref[@ref='CONSOLE']/@ref)</ind:xpath>
		</ind:xmlfilecontent_object>
		
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:11300101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900102"/>
			<unx:filename>hdscanner-jboss-beans.xml</unx:filename>
		</unx:file_object>
		
		<ind:xmlfilecontent_object id="oval:com.redhat.eap5.scap:obj:10960101" version="1">
			<ind:path var_ref="oval:com.redhat.eap5.scap:var:900108" />
			<ind:filename>jboss-service.xml</ind:filename>
			<ind:xpath>/server/mbean[@code='org.jboss.security.plugins.JaasSecurityManagerService' and @name='jboss.security:service=JaasSecurityManager']/attribute[@name='DefaultCacheTimeout']/text()</ind:xpath>
		</ind:xmlfilecontent_object>
		<!--
		<unx:file_object id="oval:com.redhat.eap5.scap:obj:30010101"
			version="1">
			<unx:path var_ref="oval:com.redhat.eap5.scap:var:900114"/>
			<unx:filename xsi:nil="true" />
		</unx:file_object>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020101"
			version="1" check="all" check_existence="none_exist" comment="jbossws-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020101"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020201"
			version="1" check="all" check_existence="none_exist" comment="jmx-console-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020201"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020301"
			version="1" check="all" check_existence="none_exist" comment="messaging-roles.properties exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020301"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020401"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war\WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020401"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020501"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/admin-console.war/WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020501"/>
		</unx:file_test>
		<unx:file_test id="oval:com.redhat.eap5.scap:tst:30020601"
			version="1" check="all" check_existence="none_exist" comment="JBOSS_HOME/server/[PROFILE]/deploy/management\console-mgr.sar\web-console.war\WEB-INF/web.xml exists">
			<unx:object object_ref="oval:com.redhat.eap5.scap:obj:30020601"/>
		</unx:file_test>
		-->
	</objects>

	<states>
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:59990101"
			version="1">
			<ind:subexpression>5.1.0</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:59980101"
			version="1">
			<ind:subexpression>5.1.2</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:59970101"
			version="1">
			<ind:subexpression>5.1.1</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:59960101"
			version="1">
			<ind:subexpression>5.0.0</ind:subexpression>
		</ind:textfilecontent54_state>
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:60000101"
			version="1">
			<ind:subexpression>5.0.1</ind:subexpression>
		</ind:textfilecontent54_state>	
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:20010101"
			version="1">
			<ind:subexpression>5.1.0</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:20010102"
			version="1">
			<ind:subexpression>5.1.1</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20060102"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20070102"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20080102"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20120101"
			version="1">
			<ind:value_of datatype="string">false</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20320101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
				
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20240101"
			version="1">
			<ind:value_of datatype="string">%d %-5p [%c] (%t:%x) %m%n</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20460101"
			version="1">
			<ind:value_of datatype="string">false</ind:value_of>
		</ind:xmlfilecontent_state>

		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20190101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20200101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20210101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20210102"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20220101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20220102"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20290101"
			version="1">
			<ind:value_of datatype="string">false</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20290102"
			version="1">
			<ind:value_of datatype="string">false</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20300101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20300102"
			version="1">
			<ind:value_of datatype="string">props/jmx-console-users.properties</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20300103"
			version="1">
			<ind:value_of datatype="string">props/jmx-console-roles.properties</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20310101"
			version="1">
			<ind:value_of datatype="string">true</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20310102"
			version="1">
			<ind:value_of datatype="string">props/jmx-console-users.properties</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20310103"
			version="1">
			<ind:value_of datatype="string">props/jmx-console-roles.properties</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:20380101"
			version="1">
			<ind:value_of datatype="string">strict</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<!--<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:20600101"
			version="1">
			<ind:subexpression operation="equals">keystore "file:${jboss.server.home.dir}/cc.keystore";</ind:subexpression>
		</ind:textfilecontent54_state>
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:20600102"
			version="1">
			<ind:subexpression operation="equals">keystorePasswordURL "file:${jboss.server.home.dir}/cc.password";</ind:subexpression>
		</ind:textfilecontent54_state>-->
		
		<ind:textfilecontent54_state id="oval:com.redhat.eap5.scap:ste:20430101"
			version="1">
			<!--<ind:subexpression operation="pattern match">JAVA_OPTS="$JAVA_OPTS -Djava.security.manager -Djava.security.policy==.*"</ind:subexpression>-->
			<ind:subexpression operation="pattern match">((?:#*)JAVA_OPTS="\$JAVA_OPTS -Djava\.security\.manager -Djava\.security\.policy==.*")</ind:subexpression>
		</ind:textfilecontent54_state>

		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:11030101"
			version="1">
			<ind:value_of datatype="string">false</ind:value_of>
		</ind:xmlfilecontent_state>
		
		<ind:xmlfilecontent_state id="oval:com.redhat.eap5.scap:ste:10960101"
			version="1">
			<ind:value_of datatype="string">1800</ind:value_of>	<!--Possibly use RegexCaptureFunctionType to search for 1800 or less in the string-->
		</ind:xmlfilecontent_state>
		
	</states>

	<variables>
		<constant_variable comment="server profile OVAL content is run against" datatype="string" version="1" id="oval:com.redhat.eap5.scap:var:900122">
			<value>production</value>
		</constant_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900101"
			version="1" datatype="string" comment="log location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/server/</literal_component>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900122"/>
				<literal_component>/log</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900102"
			version="1" datatype="string" comment="deploy location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/server/</literal_component>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900122"/>
				<literal_component>/deploy</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900103"
			version="1" datatype="string" comment="snmp-adaptor.sar location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/snmp-adaptor.sar</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900104"
			version="1" datatype="string" comment="cluster location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/cluster</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900105"
			version="1" datatype="string" comment="picketlink location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/../picketlink</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900106"
			version="1" datatype="string" comment="messaging location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/messaging</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900107"
			version="1" datatype="string" comment="common/lib location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/common/lib</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900108"
			version="1" datatype="string" comment="conf location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/server/</literal_component>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900122"/>
				<literal_component>/conf</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900109"
			version="1" datatype="string" comment="lib location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/server/</literal_component>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900122"/>
				<literal_component>/lib</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900110"
			version="1" datatype="string" comment="jbossweb.sar location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/jbossweb.sar</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900111"
			version="1" datatype="string" comment="httpha-invoker.sar/invoker.war/WEB-INF location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/httpha-invoker.sar/invoker.war/WEB-INF/</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900112"
			version="1" datatype="string" comment="deployers location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/server/</literal_component>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900122"/>
				<literal_component>/deployers</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900113"
			version="1" datatype="string" comment="jbossweb.deployer/META-INF location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900112"/>
				<literal_component>/jbossweb.deployer/META-INF</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900114"
			version="1" datatype="string" comment="JMX Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/jmx-console.war</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900115"
			version="1" datatype="string" comment="Admin Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/admin-console.war</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900116"
			version="1" datatype="string" comment="Web Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/management</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900117"
			version="1" datatype="string" comment="JMX Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900114"/>
				<literal_component>/WEB-INF</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900118"
			version="1" datatype="string" comment="Admin Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900115"/>
				<literal_component>/WEB-INF</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900119"
			version="1" datatype="string" comment="Web Console location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900116"/>
				<literal_component>/console-mgr.sar/web-console.war/WEB-INF</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900120"
			version="1" datatype="string" comment="httpha-invoker.sar/META-INF location">
			<concat>
				<variable_component var_ref="oval:com.redhat.eap5.scap:var:900102"/>
				<literal_component>/httpha-invoker.sar/META-INF</literal_component>
			</concat>
		</local_variable>
		
		<local_variable id="oval:com.redhat.eap5.scap:var:900121"
			version="1" datatype="string" comment="log location">
			<concat>
				<object_component object_ref="oval:com.redhat.eap5.scap:obj:9001" item_field="value" />
				<literal_component>/bin</literal_component>
			</concat>
		</local_variable>
		
	</variables>
</oval_definitions>
