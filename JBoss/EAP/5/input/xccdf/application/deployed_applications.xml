<Group id="deployed_applications" >
<title>Securing deployed applications</title>
<description>
The rules in this group are used to secure applications deployed on JBoss EAP. This includes applications that JBoss packages and deploys by default.
</description>

<Value id="login_banner_text" type="string" operator="equals" interactive="0">
<title>Login Banner Verbiage</title>
<description>Enter an appropriate login banner for your organization. Please note that new lines must
be expressed by the '\n' character and special characters like parentheses and quotation marks must be escaped with '\'.</description>
<!-- <value selector="any_text">.+</value> -->
<value selector="usgcb_default">--[\s\n]+WARNING[\s\n]+--[\s\n]*This[\s\n]+system[\s\n]+is[\s\n]+for[\s\n]+the[\s\n]+use[\s\n]+of[\s\n]+authorized[\s\n]+users[\s\n]+only.[\s\n]+Individuals[\s\n]*using[\s\n]+this[\s\n]+computer[\s\n]+system[\s\n]+without[\s\n]+authority[\s\n]+or[\s\n]+in[\s\n]+excess[\s\n]+of[\s\n]+their[\s\n]*authority[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+having[\s\n]+all[\s\n]+their[\s\n]+activities[\s\n]+on[\s\n]+this[\s\n]+system[\s\n]*monitored[\s\n]+and[\s\n]+recorded[\s\n]+by[\s\n]+system[\s\n]+personnel.[\s\n]+Anyone[\s\n]+using[\s\n]+this[\s\n]*system[\s\n]+expressly[\s\n]+consents[\s\n]+to[\s\n]+such[\s\n]+monitoring[\s\n]+and[\s\n]+is[\s\n]+advised[\s\n]+that[\s\n]*if[\s\n]+such[\s\n]+monitoring[\s\n]+reveals[\s\n]+possible[\s\n]+evidence[\s\n]+of[\s\n]+criminal[\s\n]+activity[\s\n]*system[\s\n]+personal[\s\n]+may[\s\n]+provide[\s\n]+the[\s\n]+evidence[\s\n]+of[\s\n]+such[\s\n]+monitoring[\s\n]+to[\s\n]+law[\s\n]*enforcement[\s\n]+officials.</value>
<value selector="dod_default">You[\s\n]+are[\s\n]+accessing[\s\n]+a[\s\n]+U.S.[\s\n]+Government[\s\n]+\(USG\)[\s\n]+Information[\s\n]+System[\s\n]+\(IS\)[\s\n]+that[\s\n]+is[\s\n]+provided[\s\n]+for[\s\n]+USG-authorized[\s\n]+use[\s\n]+only.[\s\n]*By[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+\(which[\s\n]+includes[\s\n]+any[\s\n]+device[\s\n]+attached[\s\n]+to[\s\n]+this[\s\n]+IS\),[\s\n]+you[\s\n]+consent[\s\n]+to[\s\n]+the[\s\n]+following[\s\n]+conditions\:[\s\n]*-[\s\n]*The[\s\n]+USG[\s\n]+routinely[\s\n]+intercepts[\s\n]+and[\s\n]+monitors[\s\n]+communications[\s\n]+on[\s\n]+this[\s\n]+IS[\s\n]+for[\s\n]+purposes[\s\n]+including,[\s\n]+but[\s\n]+not[\s\n]+limited[\s\n]+to,[\s\n]+penetration[\s\n]+testing,[\s\n]+COMSEC[\s\n]+monitoring,[\s\n]+network[\s\n]+operations[\s\n]+and[\s\n]+defense,[\s\n]+personnel[\s\n]+misconduct[\s\n]+\(PM\),[\s\n]+law[\s\n]+enforcement[\s\n]+\(LE\),[\s\n]+and[\s\n]+counterintelligence[\s\n]+\(CI\)[\s\n]+investigations.[\s\n]*-[\s\n]*At[\s\n]+any[\s\n]+time,[\s\n]+the[\s\n]+USG[\s\n]+may[\s\n]+inspect[\s\n]+and[\s\n]+seize[\s\n]+data[\s\n]+stored[\s\n]+on[\s\n]+this[\s\n]+IS.[\s\n]*-[\s\n]*Communications[\s\n]+using,[\s\n]+or[\s\n]+data[\s\n]+stored[\s\n]+on,[\s\n]+this[\s\n]+IS[\s\n]+are[\s\n]+not[\s\n]+private,[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+routine[\s\n]+monitoring,[\s\n]+interception,[\s\n]+and[\s\n]+search,[\s\n]+and[\s\n]+may[\s\n]+be[\s\n]+disclosed[\s\n]+or[\s\n]+used[\s\n]+for[\s\n]+any[\s\n]+USG-authorized[\s\n]+purpose.[\s\n]*-[\s\n]*This[\s\n]+IS[\s\n]+includes[\s\n]+security[\s\n]+measures[\s\n]+\(e.g.,[\s\n]+authentication[\s\n]+and[\s\n]+access[\s\n]+controls\)[\s\n]+to[\s\n]+protect[\s\n]+USG[\s\n]+interests[\s\n]+--[\s\n]+not[\s\n]+for[\s\n]+your[\s\n]+personal[\s\n]+benefit[\s\n]+or[\s\n]+privacy.[\s\n]*-[\s\n]*Notwithstanding[\s\n]+the[\s\n]+above,[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+does[\s\n]+not[\s\n]+constitute[\s\n]+consent[\s\n]+to[\s\n]+PM,[\s\n]+LE[\s\n]+or[\s\n]+CI[\s\n]+investigative[\s\n]+searching[\s\n]+or[\s\n]+monitoring[\s\n]+of[\s\n]+the[\s\n]+content[\s\n]+of[\s\n]+privileged[\s\n]+communications,[\s\n]+or[\s\n]+work[\s\n]+product,[\s\n]+related[\s\n]+to[\s\n]+personal[\s\n]+representation[\s\n]+or[\s\n]+services[\s\n]+by[\s\n]+attorneys,[\s\n]+psychotherapists,[\s\n]+or[\s\n]+clergy,[\s\n]+and[\s\n]+their[\s\n]+assistants.[\s\n]+Such[\s\n]+communications[\s\n]+and[\s\n]+work[\s\n]+product[\s\n]+are[\s\n]+private[\s\n]+and[\s\n]+confidential.[\s\n]+See[\s\n]+User[\s\n]+Agreement[\s\n]+for[\s\n]+details.</value>
<value selector="dod_short">I\'ve[\s\n]+read[\s\n]+\&amp;[\s\n]+consent[\s\n]+to[\s\n]+terms[\s\n]+in[\s\n]+IS[\s\n]+user[\s\n]+agreem\'t.</value>
<value selector="dss_odaa_default">[\s\n]+Use[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+constitutes[\s\n]+consent[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times.[\s\n]+This[\s\n]+is[\s\n]+a[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system.[\s\n]+All[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+and[\s\n]+related[\s\n]+equipment[\s\n]+are[\s\n]+intended[\s\n]+for[\s\n]+the[\s\n]+communication,[\s\n]+transmission,[\s\n]+processing,[\s\n]+and[\s\n]+storage[\s\n]+of[\s\n]+official[\s\n]+U.S.[\s\n]+Government[\s\n]+or[\s\n]+other[\s\n]+authorized[\s\n]+information[\s\n]+only.[\s\n]+All[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times[\s\n]+to[\s\n]+ensure[\s\n]+proper[\s\n]+functioning[\s\n]+of[\s\n]+equipment[\s\n]+and[\s\n]+systems[\s\n]+including[\s\n]+security[\s\n]+devices[\s\n]+and[\s\n]+systems,[\s\n]+to[\s\n]+prevent[\s\n]+unauthorized[\s\n]+use[\s\n]+and[\s\n]+violations[\s\n]+of[\s\n]+statutes[\s\n]+and[\s\n]+security[\s\n]+regulations,[\s\n]+to[\s\n]+deter[\s\n]+criminal[\s\n]+activity,[\s\n]+and[\s\n]+for[\s\n]+other[\s\n]+similar[\s\n]+purposes.[\s\n]+Any[\s\n]+user[\s\n]+of[\s\n]+a[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+should[\s\n]+be[\s\n]+aware[\s\n]+that[\s\n]+any[\s\n]+information[\s\n]+placed[\s\n]+in[\s\n]+the[\s\n]+system[\s\n]+is[\s\n]+subject[\s\n]+to[\s\n]+monitoring[\s\n]+and[\s\n]+is[\s\n]+not[\s\n]+subject[\s\n]+to[\s\n]+any[\s\n]+expectation[\s\n]+of[\s\n]+privacy.[\s\n]+If[\s\n]+monitoring[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+reveals[\s\n]+possible[\s\n]+evidence[\s\n]+of[\s\n]+violation[\s\n]+of[\s\n]+criminal[\s\n]+statutes,[\s\n]+this[\s\n]+evidence[\s\n]+and[\s\n]+any[\s\n]+other[\s\n]+related[\s\n]+information,[\s\n]+including[\s\n]+identification[\s\n]+information[\s\n]+about[\s\n]+the[\s\n]+user,[\s\n]+may[\s\n]+be[\s\n]+provided[\s\n]+to[\s\n]+law[\s\n]+enforcement[\s\n]+officials.[\s\n]+If[\s\n]+monitoring[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+reveals[\s\n]+violations[\s\n]+of[\s\n]+security[\s\n]+regulations[\s\n]+or[\s\n]+unauthorized[\s\n]+use,[\s\n]+employees[\s\n]+who[\s\n]+violate[\s\n]+security[\s\n]+regulations[\s\n]+or[\s\n]+make[\s\n]+unauthorized[\s\n]+use[\s\n]+of[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+appropriate[\s\n]+disciplinary[\s\n]+action.[\s\n]+Use[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+constitutes[\s\n]+consent[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times.</value>
</Value>

<Rule id="jboss_eap_jmx_console_secure_remove" severity="high">
<title>Ensure the JMX Console Is Secured Or Removed</title>
<description>
The JMX Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment.
</description>
<ocil clause="the jmx console is not secured or removed">
</ocil>
<rationale>
The JMX Console should require authentication or be removed. Failure to require authentication may allow unauthenticated users to invoke commands or gather information on the JBoss server.  This access can be leveraged to do many things, including loading additional code from a malicious source.
</rationale>


This rule can be checked for compliance by either:

<xhtml:ol>

<xhtml:li>
Determine the console is not deployed.
</xhtml:li>

<xhtml:ol>

<xhtml:li>
To determine if the JMX Console is deployed, check to see if the exploded WAR located is located here: JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/
</xhtml:li>


</xhtml:ol>

<xhtml:li>
If the console is deployed, it must require authentication. Review the defined &lt;security-domain&gt; for the console.
</xhtml:li>

<xhtml:ol>

<xhtml:li>
To determine if authentication is required, first check the JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain has been referenced (example: &lt;security-domain&gt;java:/jaas/jmx-console&lt;/security-domain&gt;).
</xhtml:li>

<xhtml:li>
Next, ensure that an &lt;application-policy&gt; element is defined that matches the &lt;security-domain&gt; referenced by the jboss-web.xml file. These &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>

</xhtml:li>


<xhtml:li>
Check the &lt;application-policy&gt; element to ensure it requires authentication. Example of a satisfactory element:
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;props/jmx-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;props/jmx-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

</xhtml:li>


</xhtml:ol>

<fixtext>

This rule can be made compliant by either:

<xhtml:ol>

<xhtml:li>
Require authentication for access to the JBoss JMX Console.
</xhtml:li>

<xhtml:ol>

<xhtml:li>
First, ensure that an &lt;application-policy&gt; element is defined that requires authentication. Default policies exist for jmx-console and web-console. Example of a satisfactory element:
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;props/jmx-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;props/jmx-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

These &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

JBOSS_HOME/server/[PROFILE]/conf/login-config.xml<xhtml:br/>

JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/META-INF/*-jboss-beans.xml<xhtml:br/>

JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/WEB-INF/*-jboss-beans.xml<xhtml:br/>

JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml

</xhtml:li>


<xhtml:li>
Next, check the JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain requiring authentication has been referenced (example: &lt;security-domain&gt;java:/jaas/jmx-console&lt;/security-domain&gt;). If no &lt;security-domain&gt; element exists, add it as a child of &lt;jboss-web&gt;.
</xhtml:li>

<xhtml:li>
Next, review the JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow side channel access to malicious users.
</xhtml:li>


<xhtml:li>
Finally, configure the usersProperties defined in the application policy to manage accounts. Example editing JBOSS_HOME/server/[PROFILE]/conf/props/jmx-console-users.properties: <xhtml:br/>

<xhtml:pre>
<xhtml:code>
# A sample users.properties file for use with the UsersRolesLoginModule
admin=1qaz!QAZ2wsx@WSX
</xhtml:code>

</xhtml:pre>

</xhtml:li>


</xhtml:ol>

<xhtml:li>
Remove the JBoss JMX Console from deployment.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To remove the JMX Console from deployment, delete the exploded WAR located here: JBOSS_HOME/server/[PROFILE]/deploy/jmx-console.war/
</xhtml:li>

</xhtml:ol>


</xhtml:ol>


</fixtext>
<ident cce="" />
<oval id="jboss_eap_jmx_console_secure_remove" />
<ref nist="AC-3" disa="ECAN-1,ECCD-1,ECCD-2,ECCR-2,ECIC-1,ECAN-1" cis="" />
</Rule>

<Rule id="jboss_eap_web_console_secure_remove" severity="high">
<title>Ensure the Web Console Is Secured Or Removed</title>
<description>
The Web Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment.
</description>
<ocil clause="the web console is not secured or removed">
</ocil>
<rationale>
Failure to secure the default consoles against unauthorized access can quickly lead to system compromise. The default consoles included with JBoss are a well-known attack vector that can be leveraged to load malicious code to be executed on the server.
</rationale>


This rule can be checked for compliance by either:

<xhtml:ol>

<xhtml:li>
Determine the console is not deployed.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To determine if the Web Console is deployed, check to see if the exploded SAR located is located here: JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/
</xhtml:li>

</xhtml:ol>

<xhtml:li>
If the console is deployed, it must require authentication. Review the defined &lt;security-domain&gt; for the console.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To determine if authentication is required, first check the JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain has been referenced (example: &lt;security-domain&gt;java:/jaas/web-console&lt;/security-domain&gt;).
</xhtml:li>

<xhtml:li>
Next, ensure that an &lt;application-policy&gt; element is defined that matches the &lt;security-domain&gt; referenced by the jboss-web.xml file. These &lt;application-policy&gt; can be defined
in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.
<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy//management/console-mgr.sar/web-console.war/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>

</xhtml:li>

<xhtml:li>
Check the &lt;application-policy&gt; element to ensure it requires authentication. Example of a satisfactory element:
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="web-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;web-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;web-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

</xhtml:li>

</xhtml:ol>


<fixtext>

This rule can be made compliant by either:

<xhtml:ol>

<xhtml:li>
Require authorization for access to the JBoss Web Console.
</xhtml:li>

<xhtml:ol>

<xhtml:li>
First, ensure that an &lt;application-policy&gt; element is defined that requires authentication. Default policies exist for jmx-console and web-console. Example of a satisfactory element:
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="web-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;web-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;web-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

These &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>

</xhtml:li>


<xhtml:li>
Next, check the JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain requiring authentication has been referenced (example: &lt;security-domain&gt;java:/jaas/web-console&lt;/security-domain&gt;). If no &lt;security-domain&gt; element exists, add it as a child of &lt;jboss-web&gt;.
</xhtml:li>


<xhtml:li>
Next, review the JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow sidechannel access to malicious users.
</xhtml:li>

<xhtml:li>
Finally, configure the usersProperties and rolesProperties files defined in the application policy to manage users and roles. Example editing JBOSS_HOME/server/[PROFILE]/conf/props/web-console-users.properties:
<xhtml:pre>
<xhtml:code>
# A sample users.properties file for use with the UsersRolesLoginModule
admin=1qaz!QAZ2wsx@WSX
</xhtml:code>

</xhtml:pre>

</xhtml:li>


</xhtml:ol>

<xhtml:li>
Remove the JBoss Web Console from deployment.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To remove the Web Console from deployment, delete the exploded SAR located here: JBOSS_HOME/server/[PROFILE]/deploy/management/
</xhtml:li>

</xhtml:ol>


</xhtml:ol>


</fixtext>
<ident cce="" />
<oval id="jboss_eap_web_console_secure_remove" />
<ref nist="AC-3" disa="ECAN-1,ECCD-1,ECCD-2,ECCR-2,ECIC-1,ECAN-1" cis="" />
</Rule>

<Rule id="jboss_eap_admin_console_secure_remove" severity="high">
<title>Ensure Administration Console Is Secured Or Removed</title>
<description>
The Administration Console application must be secured so it is accessible by trusted administrators only. If this
condition is not met, the application must be removed (deleted) from deployment.
</description>
<ocil clause="the administration console is not secured or removed">
</ocil>
<rationale>
Failure to secure the default consoles against unauthorized access can quickly lead to system compromise. The default consoles included with JBoss are a well-known attack vector that can be leveraged to load malicious code to be executed on the server.
</rationale>


This rule can be checked for compliance by either:

<xhtml:ol>

<xhtml:li>
Determine the console is not deployed.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To determine if the Administration Console is deployed, check to see if the exploded WAR located is located here: JBOSS_HOME/server/[PROFILE]/deploy/admin-console.war/
</xhtml:li>

</xhtml:ol>

<xhtml:li>
If the console is deployed, it must require authentication. Review the defined &lt;security-domain&gt; for the console.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To determine if authentication is required, first check the JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain has been referenced (example: &lt;security-domain&gt;java:/jaas/jmx-console&lt;/security-domain&gt;).
</xhtml:li>

<xhtml:li>
Next, ensure that an &lt;application-policy&gt; element is defined that matches the &lt;security-domain&gt; referenced by the jboss-web.xml file. These &lt;application-policy&gt; can be defined in the server
profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.
<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>

</xhtml:li>

<xhtml:li>
Check the &lt;application-policy&gt; element to ensure it requires authentication. Example of a satisfactory element (this example leverages the pre-existing jmx-console policy):
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;props/jmx-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;props/jmx-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

</xhtml:li>

<xhtml:li>
Finally, review the JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow sidechannel access to malicious users.
</xhtml:li>

<fixtext>

This rule can be made compliant by either:

<xhtml:ol>

<xhtml:li>
Require authorization for access to the JBoss Administration Console.
</xhtml:li>

<xhtml:ol>

<xhtml:li>
First, ensure that an &lt;application-policy&gt; element is defined that requires authentication. Default policies exist for jmx-console and web-console. Example of a satisfactory element:
<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;web-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;web-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

These &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>

</xhtml:li>


<xhtml:li>
Next, check the JBOSS_HOME/server/[PROFILE]/deploy/management/console-mgr.sar/web-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain requiring authentication has been referenced (example: &lt;security-domain&gt;java:/jaas/web-console&lt;/security-domain&gt;). If no &lt;security-domain&gt; element exists, add it as a child of &lt;jboss-web&gt;.
</xhtml:li>


<xhtml:li>
Next, review the JBOSS_HOME/server/[PROFILE]/deploy/Administration-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow sidechannel access to malicious users.
</xhtml:li>

<xhtml:li>
Finally, configure the usersProperties and rolesProperties files defined in the application policy to manage users and roles. Example editing JBOSS_HOME/server/[PROFILE]/conf/props/jmx-console-users.properties:
<xhtml:pre>
<xhtml:code>
# A sample users.properties file for use with the UsersRolesLoginModule
admin=1qaz!QAZ2wsx@WSX
</xhtml:code>

</xhtml:pre>

</xhtml:li>


</xhtml:ol>

<xhtml:li>
Remove the JBoss Administration Console from deployment.
</xhtml:li>

<xhtml:ol>
<xhtml:li>
To remove the Administration Console from deployment, delete the exploded SAR located here: JBOSS_HOME/server/[PROFILE]/deploy/admin-console.war/
</xhtml:li>

</xhtml:ol>


</xhtml:ol>


</fixtext>
<ident cce="" />
<oval id="jboss_eap_admin_console_secure_remove" />
<ref nist="AC-3" disa="ECAN-1,ECCD-1,ECCD-2,ECCR-2,ECIC-1,ECAN-1" cis="" />
</Rule>

<Rule id="jboss_eap_secure_JMXInvokerServlet" severity="high">
<title>Secure the JMXInvokerServlet Servlet</title>
<description>
The httpha-invoker.sar found in the deploy directory is a service that provides RMI/HTTP access for EJBs and the JNDI Naming service. By default older JBoss versions ship with a default set of &lt;http-method&gt; that allow attackers to bypass the security policy for JMX Invoker.
</description>
<ocil clause="it is not secure">
</ocil>
<rationale>
Removing the default &lt;http-method&gt; security constraints allows JBoss to apply configured security settings to all HTTP verbs instead of only those specified. This is a well-known attack vector and failing to remove these constraints may allow attackers to gain authenticated or unauthorized access to the JMXInvokerServlet.
</rationale>


Review JBOSS_HOME/server/[PROFILE]/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml to ensure the following lines have been removed:

<xhtml:pre>
<xhtml:code>
&lt;http-method&gt;GET&lt;/http-method&gt;
&lt;http-method&gt;POST&lt;/http-method&gt;
</xhtml:code>

</xhtml:pre>

<fixtext>
Within the JBOSS_HOME/server/[PROFILE]/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml file, the following lines must be removed from the web-app/security-constraint/web-resource-collection node:

<xhtml:pre>
<xhtml:code>
&lt;http-method&gt;GET&lt;/http-method&gt;
&lt;http-method&gt;POST&lt;/http-method&gt;
</xhtml:code>

</xhtml:pre>


</fixtext>
<ident cce="" />
<oval id="jboss_eap_secure_JMXInvokerServlet" />
<ref nist="AC-3" disa="ECAN-1,ECCD-1,ECCD-2,ECCR-2,ECIC-1,ECAN-1" cis="" />
</Rule>

<Rule id="jboss_eap_unprivileged_access_JMXInvokerServlet" severity="high">
<title>Prevent Unprivileged Access To The JMXInvokerServlet</title>
<description>
The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS.
</description>
<ocil clause="unprivileged or unauthenticated access to JMXInvokerServlet is allowed">
</ocil>
<rationale>
The JMXInvokerServlet should require authentication. Failure to require authentication may allow unauthenticated users to invoke commands on the JBoss server.  This access can be leveraged to do many things, including loading additional code from a malicious source.
</rationale>



<fixtext>

Open JBOSS_HOME/server/[PROFILE]/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:

<xhtml:pre>
<xhtml:code>
&lt;interceptors&gt;
&lt;interceptor code="org.jboss.jmx.connector.invoker.AuthenticationInterceptor" securityDomain="java:/jaas/jmx-console"/&gt;
&lt;/interceptors&gt;
</xhtml:code>

</xhtml:pre>


Next, ensure a valid authentication module is enabled for the security domain.  For example, the following elements exist within logon-config.xml and implement authentication using the UsersRolesLoginModule:

<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;props/jmx-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;props/jmx-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

NOTE: By default, this forces the invoker to authenticate against the jmx-console-users.properties file, located here: JBOSS_HOME/server/PROFILE/conf/prop/
<xhtml:br/>
NOTE: The securityDomain does not have to be called jmx-console.

</fixtext>
<ident cce="" />
<oval id="jboss_eap_unprivileged_access_JMXInvokerServlet" />
<ref nist="IA-2,IA-3" disa="EBRU-1,IAIA-1,IAIA-2,IAGA-1" cis="" />
</Rule>

<Rule id="jboss_eap_access_control_JMXInvokerServlet" severity="high">
<title>Configure Access Control for the JMXInvokerServlet Servlet</title>
<description>
The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization.
</description>
<ocil clause="">
</ocil>
<rationale>
The JMXInvokerServlet should require authorization. Failure to require authorization may allow unauthenticated users to invoke commands on the JBoss server.  This access can be leveraged to do many things, including loading additional code from a malicious source.
</rationale>

<fixtext>
Open JBOSS_HOME/server/[PROFILE]/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:

<xhtml:pre>
<xhtml:code>
&lt;interceptors&gt;
&lt;interceptor code="org.jboss.jmx.connector.invoker.AuthorizationInterceptor" authorizingClass="org.jboss.jmx.connector.invoker.RolesAuthorization"/&gt;
&lt;/interceptors&gt;
</xhtml:code>

</xhtml:pre>


Next, ensure a valid authorization module is enabled for the security domain.  For example, the following elements exist within logon-config.xml and implement authorization using the UsersRolesLoginModule:

<xhtml:pre>
<xhtml:code>
&lt;application-policy name="jmx-console"&gt;
&lt;authentication&gt;
&lt;login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule" flag="required"&gt;
&lt;module-option name="usersProperties"&gt;props/jmx-console-users.properties&lt;/module-option&gt;
&lt;module-option name="rolesProperties"&gt;props/jmx-console-roles.properties&lt;/module-option&gt;
&lt;/login-module&gt;
&lt;/authentication&gt;
&lt;/application-policy&gt;
</xhtml:code>

</xhtml:pre>

NOTE: By default, this forces the invoker to authenticate against the jmx-console-users.properties file, located here: JBOSS_HOME/server/PROFILE/conf/prop/<xhtml:br/>
NOTE: The securityDomain does not have to be called jmx-console.


</fixtext>
<ident cce="" />
<!--oval id="jboss_eap_access_control_JMXInvokerServlet" /-->
<ref nist="AC-3,AC-6" disa="ECAN-1,ECCD-1,ECCD-2,ECCR-2,ECIC-1,ECAN-1,ECLP-1" cis="" />
</Rule>

<Rule id="jboss_eap_system_banner_applications" severity="low">
<title>Display System Banner for Deployed Applications</title>
<description>
Upon accessing the system, a notification banner, consent to use, or policy warning banner should be displayed to alert system users of the system use details. This may include items such as implied consent to monitor, privacy practices, or liability waivers.
</description>
<ocil clause="it is not configured or does not exist">
</ocil>
<rationale>
Failing to provide adequate notification of system use details to users accessing the system can create legal troubles in the event of a civil lawsuit or criminal investigation.
</rationale>

<fixtext>
Create a system use notification message for all users who access the system. This can be done in a variety of ways, but a simple JavaScript alert(); containing a warning message will suffice. This warning banner should be presented to the user prior to accessing any deployed application - commercial applications, in-house applications, or applications deployed by JBoss. The contents of the system use notification should be clear, concise, in keeping with the organizational security policy, and should have been reviewed by the organization's legal team.

On DoD systems, the warning banner should read:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests—not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.


</fixtext>
<ident cce="" />
<!--oval id="jboss_eap_system_banner_applications" value="login_banner_text" /-->
<ref nist="AC-8" disa="ECWM-1" cis="" />
</Rule>

<Rule id="jboss_eap_classification_banner_applications" severity="low">
<title>Display Classification Banner for Deployed Applications</title>
<description>
Deployed applications should present classification banners at the header and footer of each page in accordance with the applicable DoD classification guide for the environment (or in accordance with local security policies).
</description>
<ocil clause="it is not configured or does not exist">
</ocil>
<rationale>
Prominent classification banners reduce the risk of inadvertent information disclosure or data spillage across different classification levels.
</rationale>

<fixtext>
Create system classification banners for all deployed applications. This can be done in a variety of ways, but using a simple linked JavaScript to create header/footer SPAN tags with inline CSS will fit the requirements.


</fixtext>
<ident cce="" />
<!--oval id="jboss_eap_classification_banner_applications" /-->
<ref nist="AC-8" disa="ECWM-1" cis="" />
</Rule>

<Rule id="jboss_eap_enable_password_hashing" severity="medium">
<title>Enable Password Hashing</title>
<description>
A Security Domain is a set of authentication, authorization, and mapping policies defined in XML and are available to applications at runtime using Java Naming and Directory Interface (JNDI).
</description>
<ocil clause="">
</ocil>
<rationale>
Failure to enable password hashing within a login module can result in plain-text exposure client passwords used for authentication.
</rationale>


To determine which &lt;application-policy&gt; are in use by deployed applications, search for &lt;security-domain&gt; elements within the following deployment descriptors:

JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/WEB-INF/jboss-web.xml<xhtml:br/>

JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/WEB-INF/jboss.xml


An &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>


The element below should be included within a deployed application's &lt;application-policy&gt;&lt;login-module&gt;:

<fixtext>

Add the following child element to any &lt;application-policy&gt;&lt;login-module&gt; in use:

<xhtml:pre>
<xhtml:code>
&lt;module-option name="hashUserPassword"&gt;true&lt;/module-option&gt;
</xhtml:code>

</xhtml:pre>

An &lt;application-policy&gt; can be defined in the server profile conf directory, in an application deployment descriptor, or directly deployed as an MBean.

<xhtml:ul>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/conf/login-config.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/META-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/[APPLICATION]/WEB-INF/*-jboss-beans.xml
</xhtml:li>

<xhtml:li>
JBOSS_HOME/server/[PROFILE]/deploy/*-jboss-beans.xml
</xhtml:li>

</xhtml:ul>


</fixtext>
<ident cce="" />
<!--oval id="jboss_eap_enable_password_hashing" /-->
<ref nist="SC-8,SC-9" disa="ECTM-1,ECTM-2,ECCT-1,ECCT-2,ECNK-1,ECNK-2" cis="" />
</Rule>

<Rule id="jboss_eap_enterprise_javabeans_spec" severity="medium">
<title>Enterprise JavaBeans Specification v2.1 must be strictly followed</title>
<description>
The programming restrictions mandated by the Enterprise JavaBeans Specification v2.1 must be strictly followed. For more information, refer to JSR-000153 Enterprise JavaBeans 2.1 specification. (Section 25.2, pages 562-564).
</description>
<ocil clause="">
</ocil>
<rationale>
Deployed applications should follow identified standards, procedures, and best practices. Compliance has many benefits, including helping applications stay interoperable with other programs and containers, implementing strong security and code standards, and improving performance and efficiency.

</rationale>



<xhtml:ul>
<xhtml:li>
An enterprise bean must not use read/write static fields. Using read-only static fields is allowed. Therefore, it is recommended that all static fields in the enterprise bean class be declared as final.
</xhtml:li>

<xhtml:li>
An enterprise bean must not use thread synchronization primitives to synchronize execution of multiple instances.
</xhtml:li>

<xhtml:li>
An enterprise bean must not use the AWT functionality to attempt to output information to a display, or to input information from a keyboard.
</xhtml:li>

<xhtml:li>
An enterprise bean must not use the java.io package to attempt to access files and directories in the file system.
</xhtml:li>

<xhtml:li>
An enterprise bean must not attempt to listen on a socket, accept connections on a socket, or use a socket for multicast.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to query a class to obtain information about the declared members that are not otherwise accessible to the enterprise bean because of the security rules of the Java language. The enterprise bean must not attempt to use the Reflection API to access information that the security rules of the Java programming language make unavailable.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to create a class loader; obtain the current class loader; set the context class loader; set security manager; create a new security manager; stop the JVM; or change the input, output, and error streams.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to set the socket factory used by ServerSocket, Socket, or the stream handler factory used by URL.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to manage threads. The enterprise bean must not attempt to start, stop, suspend, or resume a thread, or to change a thread’s priority or name. The enterprise bean must not attempt to manage thread groups.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to directly read or write a file descriptor.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to obtain the security policy information for a particular code source.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to load a native library.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to gain access to packages and classes that the usual rules of the Java programming language make unavailable to the enterprise bean.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to define a class in a package.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to access or modify the security configuration objects (Policy, Security, Provider, Signer, and Identity).
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to use the subclass and object substitution features of the Java Serialization Protocol.
</xhtml:li>

<xhtml:li>
The enterprise bean must not attempt to pass this as an argument or method result. The enterprise bean must pass the result of SessionContext.getEJBObject, Session-Context.getEJBLocalObject, EntityContext.getEJBObject,or Entity-Context.getEJBLocalObject instead.
</xhtml:li>

</xhtml:ul>

<fixtext>
Developers must follow Enterprise JavaBeans Specification v2.1.

</fixtext>
<ident cce="" />
<!--oval id="jboss_eap_enterprise_javabeans_spec" /-->
<ref nist="CM-6" disa="DCCS-1,DCCS-2,DCCT-1,ECSC-1,DCSS-1" cis="" />
</Rule>

</Group>
