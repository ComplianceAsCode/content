<Group id="eap6">
<title>JBoss Enterprise Application Platform 6</title>
<description>JBoss Enterprise Application Platform is a popular Java 
Enterprise Edition application server platform by Red Hat. It is based
on the open-source JBoss Application Server, Community Edition.
Leveraging robust container architecture, JBoss EAP is capable of
hosting a wide variety of applications - anything from simple, static
HTML pages all the way to distributed, transaction-based Java Enterprise
Edition applications. JBoss EAP is known for being dependable, fast,
flexible, and cost-effective. This section provides settings for
configuring the JBoss Enterprise Application Platform running on 
Red Hat Enterprise Linux systems.
</description>

<Value id="var_jboss_profile" type="string" operator="equals">
<title>JBoss Configuration Profile</title>
<description>Choose JBoss configuration name (string)</description>
<value>standalone</value>
<value selector="default">standalone</value>
<value selector="openshift">standalone-openshift</value>
</Value>

<Rule id="jboss_eap_configure_secure_management_access" severity="medium">
<title>Enable HTTPS for Management Sessions</title>
<description>
Follow the specific instructions in the Red Hat Security Guide for EAP version
6.3 to configure the management console for HTTPS.
<br/><br/>
This involves the following steps.
1. Create a keystore in JKS format.
2. Ensure the management console binds to HTTPS.
3. Create a new Security Realm.
4. Configure Management Interface to use new security realm.
5. Configure the management console to use the keystore.
6. Restart the EAP server.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss. Using the relevant OS commands and syntax, cd to the
<tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder. Run the <pre>jboss-cli</pre> script. Connect to the server and authenticate.
<br/><br/>
For a standalone configuration run the following command:
<pre>ls /core-service=management/management-interface=http-interface</pre>
<br/><br/>
If <pre>"secure-socket-binding"=undefined</pre>, this is a finding.
<br/><br/>
For a domain configuration run
the following command:
<pre>ls /host=master/core-service=management/management-interface=http-interface</pre>
<br/><br/>
If <tt>secure-port</tt> is undefined, this is a finding.
</ocil>
<rationale>
Types of management interfaces utilized by the JBoss EAP application server
include web-based HTTP interfaces as well as command line-based management
interfaces. In the event remote HTTP management is required, the access must be
via HTTPS.
<br/><br/>
This requirement is in conjunction with the requirement to isolate
all management access to a restricted network.
</rationale>
<ident cce="80450-0" />
<oval id="jboss_eap_configure_secure_management_access" value="var_jboss_profile" />
<ref srg="SRG-APP-000014-AS-000009" disa="68" nist="" stigid="JBOS-AS-000010"/>
</Rule>

<Rule id="jboss_eap_configure_https" severity="medium">
<title>Enable HTTPS for JBoss Web Interface</title>
<description>
Follow procedure "4.4. Configure the JBoss Web Server to use HTTPS."
The detailed procedure is found in the JBoss EAP 6.3 Security Guide available at
the vendor's site, RedHat.com. An overview of steps is provided here.
<br/><br/>
1. Obtain or generate DoD-approved SSL certificates.
2. Configure the SSL certificate using your certificate values.
3. Set the SSL protocol to TLS V1.1 or V1.2.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
<br/><br/>
Using the relevant OS commands and syntax, cd to the
<tt>&lt;JBOSS_HOME&gt;/bin/</tt> folder
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Review the web subsystem and ensure that HTTPS is enabled.
Run the command:
<br/><br/>
For a managed domain:
<pre>ls /profile=<i>PROFILE_NAME</i>/subsystem=web/connector=</pre>
For a standalone system:
<pre>ls /subsystem=web/connector=</pre>
<br/><br/>
If <tt>https</tt> is not returned, this is a finding.
</ocil>
<rationale>
Encryption is critical for protection of remote access sessions. If encryption
is not being used for integrity, malicious users may gain the ability to modify
the application server configuration. The use of cryptography for ensuring
integrity of remote access sessions mitigates that risk.
<br/><br/>
Application servers
utilize a web management interface and scripted commands when allowing remote
access. Web access requires the use of TLS, and scripted access requires using
ssh or some other form of approved cryptography. Application servers must have a
capability to enable a secure remote admin capability.
<br/><br/>
FIPS 140-2 approved TLS
versions include TLS V1.0 or greater.
<br/><br/>
FIPS 140-2 approved TLS versions must be
enabled, and non-FIPS-approved SSL versions must be disabled.
<br/><br/>
NIST SP 800-52
specifies the preferred configurations for government systems.
</rationale>
<ident cce="80451-8" />
<oval id="jboss_eap_configure_https" value="var_jboss_profile" />
<ref srg="SRG-APP-000015-AS-000010" disa="1453" nist="" stigid="JBOS-AS-000015"/>
</Rule>

<Rule id="jboss_eap_configure_host_access_restrictions" severity="high">
<title>Configure Host Access Restrictions for Applications</title>
<description>
Configure the Java security manager to enforce access restrictions to the host
system resources in accordance with application design and resource
requirements.
</description>
<ocil clause="it is not">
Obtain documentation from the admin that identifies the applications hosted on
the JBoss server as well as the corresponding rights the application requires.
For example, if the application requires network socket permissions and file
write permissions, those requirements should be documented.
<br/><br/>
1. Identify the
JBoss installation as either domain or standalone and review the relevant
configuration file.
For domain installs: <tt>JBOSS_HOME/bin/domain.conf</tt>
For
standalone installs: <tt>JBOSS_HOME/bin/standalone.conf</tt>
<br/><br/>
2. Identify the location
and name of the security policy by reading the JAVA_OPTS flag
<pre>-Djava.security.policy=<i>file name</i></pre>
where <i>file name</i> will indicate name and
location of security policy. If the application uses a policy URL, obtain URL
and policy file from system admin.
<br/><br/>
3. Review security policy and ensure hosted
applications have the appropriate restrictions placed on them as per documented
application functionality requirements.
<br/><br/>
If the security policy does not
restrict application access to host resources as per documented requirements,
this is a finding.
</ocil>
<rationale>
The Java Security Manager is a java class that manages the external boundary of
the Java Virtual Machine (JVM) sandbox, controlling how code executing within
the JVM can interact with resources outside the JVM.
<br/><br/>
The JVM requires a
security policy in order to restrict application access. A properly configured
security policy will define what rights the application has to the underlying
system. For example, rights to make changes to files on the host system or to
initiate network sockets in order to connect to another system.
</rationale>
<ident cce="80452-6" />
<oval id="jboss_eap_configure_host_access_restrictions" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000025"/>
</Rule>

<Rule id="jboss_eap_configure_security_manager" severity="high">
<title>Enable the Java Security Manager</title>
<description>
For a domain installation:
Enable the respective JAVA_OPTS flag in both the
domain.conf and the domain.conf.bat files.
<br/><br/>
For a standalone installation:
Enable the respective JAVA_OPTS flag in both the standalone.conf and the
standalone.conf.bat files.
</description>
<ocil clause="it is not">
To determine if the Java Security Manager is enabled for JBoss, you must
examine the startup commands. JBoss can be configured to run in either
<tt>domain</tt> or a <tt>standalone</tt> mode. <i>JBOSS_HOME</i> is the variable
home directory for the JBoss installation. Use relevant OS commands to navigate
the file system.
<br/><br/>
A. For a managed domain installation, review the domain.conf
and domain.conf.bat files:
<br/><br/>
<pre>JBOSS_HOME/bin/domain.conf
JBOSS_HOME/bin/domain.conf.bat</pre>
<br/><br/>
In domain.conf file, ensure there is a JAVA_OPTS
flag that loads the Java Security Manager as well as a relevant Java Security
policy.  The following is an example:
<br/><br/>
<pre>JAVA_OPTS="$JAVA_OPTS
-Djava.security.manager -Djava.security.policy==$PWD/server.policy
-Djboss.home.dir=/path/to/JBOSS_HOME -Djboss.modules.policy-
permissions=true"</pre>
<br/><br/>
In domain.conf.bat file, ensure JAVA_OPTS flag is set.
The following is an example:
<br/><br/>
set <pre>JAVA_OPTS="%JAVA_OPTS%
-Djava.security.manager -Djava.security.policy==/path/to/server.policy
-Djboss.home.dir=/path/to/JBOSS_HOME -Djboss.modules.policy-
permissions=true"</pre>
<br/><br/>
B. For a standalone installation, review the
standalone.conf and standalone.conf.bat files:
<br/><br/>
<pre>
JBOSS_HOME/bin/standalone.conf
JBOSS_HOME/bin/standalone.conf.bat
</pre>
<br/><br/>
In the standalone.conf file, ensure the
JAVA_OPTS flag is set. The following is an example:
<br/><br/>
<pre>
JAVA_OPTS="$JAVA_OPTS
-Djava.security.manager -Djava.security.policy==$PWD/server.policy
-Djboss.home.dir=$JBOSS_HOME -Djboss.modules.policy-permissions=true"</pre>
<br/><br/>
In
the standalone.conf.bat file, ensure the JAVA_OPTS flag is set. The following
is an example:
<br/><br/>
set <pre>JAVA_OPTS="%JAVA_OPTS% -Djava.security.manager
-Djava.security.policy==/path/to/server.policy -Djboss.home.dir=%JBOSS_HOME%
-Djboss.modules.policy-permissions=true"</pre>
<br/><br/>
If the security manager is not
enabled and a security policy not defined, this is a finding.
</ocil>
<rationale>
The Java Security Manager is a java class that manages the external boundary of
the Java Virtual Machine (JVM) sandbox, controlling how code executing within
the JVM can interact with resources outside the JVM.
<br/><br/>
The Java Security Manager
uses a security policy to determine whether a given action will be
permitted or
denied.
<br/><br/>
To protect the host system, the JBoss application server must be run
within the Java Security Manager.
</rationale>
<ident cce="80453-4" />
<oval id="jboss_eap_configure_security_manager" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000030"/>
</Rule>

<Rule id="jboss_eap_enable_rbac" severity="high">
<title>Enable Role Based Access Control (RBAC)</title>
<description>
Run the following command.
<pre>&lt;JBOSS_HOME&gt;/bin/jboss-cli.sh -c -> connect -> cd
/core-service=management/access-authorization :write-attribute(name=provider,
value=rbac)</pre>
<br/><br/>
Restart JBoss.
<br/><br/>
Map users to roles by running the following
command. Upper-case words are variables.
<br/><br/>
<pre>role-mapping=ROLENAME/include=ALIAS:add(name-USERNAME, type=USER ROLE)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the
<pre>&lt;JBOSS_HOME&gt;/bin/</pre>
folder. Run the jboss-cli script.
Connect to the server and authenticate.
<br/><br/>
Run the following command:
<br/><br/>
For standalone servers:
<pre>ls /core-service=management/access=authorization/</pre>
<br/><br/>
For managed domain
installations:
<pre>ls /host=master/core-service=management/access=authorization/</pre>
<br/><br/>
If the <tt>provider</tt>
attribute is not set to <tt>rbac</tt>, this is a finding.
</ocil>
<rationale>
By default, the JBoss server is not configured to utilize role based access
controls (RBAC). RBAC provides the capability to restrict user access to their
designated management role, thereby limiting access to only the JBoss
functionality that they are supposed to have. Without RBAC, the JBoss server is
not able to enforce authorized access according to role.
</rationale>
<ident cce="80454-2" />
<oval id="jboss_eap_enable_rbac" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024,SRG-APP-000340-AS-000185" disa="213,2235"
nist="" stigid="JBOS-AS-000035"/>
</Rule>

<Rule id="jboss_eap_configure_user_roles" severity="medium">
<title>Configure JBoss User Roles</title>
<description>
Document approved management users and their roles. Configure the application
server to use RBAC and ensure users are placed into the appropriate roles.
</description>
<ocil clause="it is not">
Review the <tt>mgmt-users.properties</tt> file.  Also review the <tt>&lt;management /&gt;</tt> section
in the standalone.xml or domain.xml configuration files. The relevant xml file
will depend on if the JBoss server is configured in standalone or domain mode.
Ensure all users listed in these files are approved for management access to the
JBoss server and are in the appropriate role.
<br/><br/>
For domain configurations:
<pre>
&lt;JBOSS_HOME&gt;/domain/configuration/mgmt-users.properties.
&lt;JBOSS_HOME&gt;/domain/configuration/domain.xml
</pre>
<br/><br/>
For standalone configurations:
<pre>
&lt;JBOSS_HOME&gt;/standalone/configuration/mgmt-users.properties.
&lt;JBOSS_HOME&gt;/standalone/configuration/standalone.xml
</pre>
<br/><br/>
If the users listed are
not in the appropriate role, this is a finding.
</ocil>
<rationale>
Security realms are a series of mappings between users and passwords and users
and roles. There are 2 JBoss security realms provided by default; they are
<tt>management realm</tt> and <tt>application realm</tt>.
<br/><br/>
Management realm
stores authentication information for the management API, which provides
functionality for the web-based management console and the management command
line interface (CLI).
<br/><br/>
mgmt-groups.properties stores user to group mapping for
the ManagementRealm but only when role-based access controls (RBAC) is enabled.
If management users are not in the appropriate role, unauthorized access to
JBoss resources can occur.
</rationale>
<ident cce="80455-9" />
<oval id="jboss_eap_configure_user_roles" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000040"/>
</Rule>

<Rule id="jboss_eap_configure_application_authentication" severity="high">
<title>Remove Silent Authentication - Application Security Realm</title>
<description>
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Remove the local element from the Application Realm.
For standalone servers, run
the following command:
<pre>/core-service=management/securityrealm=ApplicationRealm/authentication=local:remove</pre>
<br/><br/>
For managed domain installations,
run the following command:
<pre>/host=HOST_NAME/core-service=management/securityrealm=ApplicationRealm/authentication=local:remove</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the
<tt>&lt;JBOSS_HOME&gt;/bin/</tt> folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Verify that Silent Authentication has been removed from the default Application
security realm.
Run the following command.
<br/><br/>
For standalone servers, run the following command:
<pre>ls /core-service=management/securityrealm=ApplicationRealm/authentication</pre>
<br/><br/>
For managed domain installations, run the following command:
<pre>ls /host=HOST_NAME/core-service=management/securityrealm=ApplicationRealm/authentication</pre>
<br/><br/>
If <tt>local</tt> is returned, this is a finding.
</ocil>
<rationale>
Silent Authentication is a configuration setting that allows local OS users
access to the JBoss server and a wide range of operations without specifically
authenticating on an individual user basis. By default $localuser is a
Superuser. This introduces an integrity and availability vulnerability and
violates best practice requirements regarding accountability.
</rationale>
<ident cce="80456-7" />
<oval id="jboss_eap_configure_application_authentication" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000045"/>
</Rule>

<Rule id="jboss_eap_configure_management_authentication" severity="high">
<title>Remove Silent Authentication - Management Security Realm</title>
<description>
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <pre>&lt;JBOSS_HOME&gt;/bin/</pre>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Remove the local element from the Management Realm.
For standalone servers run
the following command:
<pre>/core-service=management/securityrealm=ManagementRealm/authentication=local:remove</pre>
<br/><br/>
For managed domain installations run the following command:
<pre>/host=HOST_NAME/core-service=management/securityrealm=ManagementRealm/authentication=local:remove</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Verify that Silent Authentication has been removed from the default Management
security realm.
Run the following command.
<br/><br/>
For standalone servers run the
following command:
<pre>ls /core-service=management/securityrealm=ManagementRealm/authentication</pre>
<br/><br/>
For
managed domain installations run the following command:
<pre>ls /host=HOST_NAME/core-service=management/securityrealm=ManagementRealm/authentication</pre>
<br/><br/>
If <tt>local</tt> is returned, this is a finding.
</ocil>
<rationale>
Silent Authentication is a configuration setting that allows local OS users
access to the JBoss server and a wide range of operations without specifically
authenticating on an individual user basis. By default $localuser is a
Superuser. This introduces an integrity and availability vulnerability and
violates best practice requirements regarding accountability.
</rationale>
<ident cce="80457-5"/>
<oval id="jboss_eap_configure_management_authentication" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000050"/>
</Rule>

<Rule id="jboss_eap_configure_security_realm" severity="high">
<title>Secure the JBoss Management Interfaces</title>
<description>
Identify the security realm used for management of the system. By default,
this is called <tt>Management Realm</tt>.
<br/><br/>
If a management security realm is not
already available, reference the Jboss EAP 6.3 system administration guide for
instructions on how to create a security realm for management purposes. Create
the management realm, and assign authentication and authorization access
restrictions to the management realm.
<br/><br/>
Assign the management interfaces to the management realm.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <pre>&lt;JBOSS_HOME&gt;/bin/</pre>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Identify the management interfaces. To identity the management interfaces, run
the following command:
<br/><br/>
For standalone servers:
<pre>ls /core-service=management/management-interface=</pre>
<br/><br/>
For managed domain installations:
<pre>ls /host=HOST_NAME/core-service=management/management-interface=</pre>
<br/><br/>
By default,
JBoss provides two management interfaces; they are named <tt>NATIVE-INTERFACE</tt>
and <tt>HTTP-INTERFACE</tt>. The system may or may not have both
interfaces enabled. For each management interface listed as a result of the
previous command, append the name of the management interface to the end of the
following command.
<br/><br/>
For a standalone system:
<br/><br/>
<pre>ls /core-service=management/management-interface=&lt;MANAGEMENT INTERFACE NAME&gt;</pre>
<br/><br/>
For a managed domain:
<pre>ls /host=HOST_NAME/core-service=management/management-interface=&lt;MANAGEMENT INTERFACE NAME&gt;</pre>
<br/><br/>
If the <pre>security-realm=</pre> attribute is not
associated with a management realm, this is a finding.
</ocil>
<rationale>
JBoss utilizes the concept of security realms to secure the management
interfaces used for JBoss server administration. If the security realm
attribute is omitted or removed from the management interface definition, access
to that interface is no longer secure. The JBoss management interfaces must be
secured.
</rationale>
<ident cce="80458-3"/>
<oval id="jboss_eap_configure_security_realm" value="var_jboss_profile" />
<ref srg="SRG-APP-000033-AS-000024" disa="213" nist="" stigid="JBOS-AS-000075"/>
</Rule>

<Rule id="jboss_eap_configure_auditing" severity="medium">
<title>Configure JBoss Auditing and Logging</title>
<description>
Launch the jboss-cli management interface.
Connect to the server by typing
<tt>connect</tt>, authenticate as a user in the Superuser role, and run the
following command:
<br/><br/>
For a Managed Domain configuration:
<pre>host=master/server/<i>SERVERNAME</i>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
<br/><br/>
For a Standalone
configuration:
<pre>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
Run the command:
<br/><br/>
For a Managed Domain
configuration:
<pre>ls host=master/server/<i>SERVERNAME</i>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
<br/><br/>
For a Standalone configuration:
<pre>ls /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
<br/><br/>
If <pre>"enabled" =.</pre>, this is
a finding.
</ocil>
<rationale>
Log records can be generated from various components within the JBoss
application server. The minimum list of logged events should be those
pertaining to access and authentication events to the management interface as
well as system startup and shutdown events.
<br/><br/>
By default, JBoss does not log
management interface access but does provide a default file handler. This
handler needs to be enabled. Configuring this setting meets several STIG
auditing requirements.
</rationale>
<ident cce="80459-1"/>
<oval id="jboss_eap_configure_auditing" value="var_jboss_profile" />
<ref srg="SRG-APP-000089-AS-000050,SRG-APP-000092-AS-000053,SRG-APP-000095-AS-000056,SRG-APP-000096-AS-000059,SRG-APP-000096-AS-000060,SRG-APP-000098-AS-000061,SRG-APP-000099-AS-000062,SRG-APP-000495-AS-000220,SRG-APP-000499-AS-000224,SRG-APP-000499-AS-000224,SRG-APP-000503-AS-000228,SRG-APP-000504-AS-000229,SRG-APP-000505-AS-000230,SRG-APP-000506-AS-000231,SRG-APP-000509-AS-000234"
disa="130,131,132,133,134,169,172,1464" nist="" stigid="JBOS-AS-000080"/>
</Rule>

<Rule id="jboss_eap_configure_auditor_roles" severity="medium">
<title>Configure JBoss Auditor Role</title>
<description>
Obtain documented approvals from ISSM, and assign the appropriate personnel
into the <pre>Auditor</pre> role.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
Run the command:
<br/><br/>
For a Managed Domain
configuration:
<pre>ls host=master/server/<i>SERVERNAME</i>/core-service=management/access=authorization/role-mapping=Auditor/include=</pre>
<br/><br/>
For a Standalone configuration:
<pre>ls /core-service=management/access=authorization/role-mapping=Auditor/include=</pre>
<br/><br/>
If
the list of users in the Auditors group is not approved by the ISSM, this is a
finding.
</ocil>
<rationale>
The JBoss server must be configured to select which personnel are assigned the
role of selecting which loggable events are to be logged.
In JBoss, the role
designated for selecting auditable events is the <tt>Auditor</tt> role.
The
personnel or roles that can select loggable events are only the ISSM (or
individuals or roles appointed by the ISSM).
</rationale>
<ident cce="80460-9"/>
<oval id="jboss_eap_configure_auditor_roles" value="var_jboss_profile" />
<ref srg="SRG-APP-000090-AS-000051" disa="171" nist="" stigid="JBOS-AS-000085"/>
</Rule>

<Rule id="jboss_eap_configure_logging_level" severity="medium">
<title>Configure JBoss Logging Level</title>
<description>
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
<br/><br/>
The PROFILE NAMEs included with a
Managed Domain JBoss configuration are:
<tt>default</tt>, <tt>full</tt>, <tt>full-ha</tt>, or <tt>ha</tt>
For a Managed Domain configuration, you must check
each profile name:
<br/><br/>
For each PROFILE NAME, run the command:
<pre>/profile=<i>PROFILE NAME</i>/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)</pre>
<br/><br/>
For a Standalone configuration:
<pre>/subsystem=logging/root-logger=ROOT:write-attribute(name=level,value=INFO)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
<br/><br/>
The PROFILE NAMEs included with a
Managed Domain JBoss configuration are:
<tt>default</tt>, <tt>full</tt>, <tt>full-ha</tt>, or <tt>ha</tt>
For a Managed Domain configuration, you must check
each profile name:
<br/><br/>
For each PROFILE NAME, run the command:
<pre>ls /profile=<i>PROFILE NAME</i>/subsystem=logging/root-logger=ROOT</pre>
<br/><br/>
If ROOT logger
<tt>level</tt> is not set to INFO, DEBUG or TRACE
This is a finding for each
<i>PROFILE NAME</i> (default, full, full-ha and ha)
<br/><br/>
For a Standalone configuration:
<pre>ls /subsystem=logging/root-logger=ROOT</pre>
<br/><br/>
If "level" not = INFO, DEBUG or TRACE, this is a finding.
</ocil>
<rationale>
800 records less data and may result in an insufficient amount of information
being logged by the ROOT logger. This can result in failed forensic
investigations. The ROOT logger level must be INFO level or lower to provide
adequate log information.
</rationale>
<ident cce="80461-7"/>
<oval id="jboss_eap_configure_logging_level" value="var_jboss_profile" />
<ref srg="SRG-APP-000100-AS-000063" disa="1487" nist="" stigid="JBOS-AS-000135"/>
</Rule>

<Rule id="jboss_eap_configure_log_permissions" severity="medium">
<title>Configure JBoss Log Permissions</title>
<description>
Configure the OS file permissions on the application server to protect log
information from unauthorized access.
</description>
<ocil clause="it is not">
Examine the log file locations and inspect the file permissions. Interview the
system admin to determine log file locations. The default location for the log
files is:
<br/><br/>
Standalone configuration:
<pre>
&lt;JBOSS_HOME&gt;/standalone/log/
</pre>
<br/><br/>
Managed
Domain configuration:
<pre>
&lt;JBOSS_HOME&gt;/domain/servers/<i>servername</i>/log/
&lt;JBOSS_HOME&gt;/domain/log/
</pre>
<br/><br/>
Review the file permissions for the log file
directories. The method used for identifying file permissions will be based
upon the OS the EAP server is installed on.
<br/><br/>
Identify all users with file
permissions that allow them to read, modify, or delete log files.
<br/><br/>
Request documentation from
system admin that identifies the users who are authorized to read, modify, or delete log files.
<br/><br/>
If
unauthorized users are allowed to read, modify, or delete log files, or if documentation that
identifies the users who are authorized to read, modify, or delete log files is missing, this is a
finding.
</ocil>
<rationale>
If log data were to become compromised, then competent forensic analysis and
discovery of the true source of potentially malicious system activity is
difficult, if not impossible, to achieve.
<br/><br/>
When not configured to use a
centralized logging solution like a syslog server, the JBoss EAP application
server writes log data to log files that are stored on the OS; appropriate file
permissions must be used to restrict access.
<br/><br/>
Log information includes all
information (e.g., log records, log settings, transaction logs, and log reports)
needed to successfully log information system activity. Application servers must
protect log information from unauthorized access.
</rationale>
<ident cce="80462-5"/>
<oval id="jboss_eap_configure_log_permissions" value="var_jboss_profile" />
<ref srg="SRG-APP-000118-AS-000078,SRG-APP-000119-AS-000079,SRG-APP-000120-AS-000080"
disa="162,163,164" nist="" stigid="JBOS-AS-000165"/>
</Rule>

<Rule id="jboss_eap_configure_offloading_max" severity="medium">
<title>Configure JBoss Log Off-Loading Frequency</title>
<description>
Configure the application server to off-load log records every seven days onto
a different system or media from the system being logged.
</description>
<ocil clause="it is not">
Interview the system admin and obtain details on how the log files are being
off-loaded to a different system or media.
<br/><br/>
If the log files are not off-loaded
a minimum of every 7 days, this is a finding.
</ocil>
<rationale>
JBoss logs by default are written to the local file system. A centralized
logging solution like syslog should be used whenever possible; however, any log
data stored to the file system needs to be off-loaded. JBoss EAP does not
provide an automated backup capability. Instead, reliance is placed on OS or
third-party tools to back up or off-load the log files.
<br/><br/>
Protection of log data
includes assuring log data is not accidentally lost or deleted. Off-loading log
records to a different system or onto separate media from the system the
application server is actually running on helps to assure that, in the event of
a catastrophic system failure, the log records will be retained.
</rationale>
<ident cce="80463-3"/>
<oval id="jboss_eap_configure_offloading_max" value="var_jboss_profile" />
<ref srg="SRG-APP-000125-AS-000084" disa="1348" nist="" stigid="JBOS-AS-000195"/>
</Rule>

<Rule id="jboss_eap_configure_user_permissions" severity="medium">
<title>Configure mgmt-users.properties File Permissions</title>
<description>
Configure the file permissions to allow access to authorized users only.
Owner can be full access. Group can be full access. 
All others must have execute
permissions only.
</description>
<ocil clause="it is not">
The mgmt-users.properties files are located in the standalone or domain
configuration folder.
<br/><br/>
<pre>
&lt;JBOSS_HOME&gt;/domain/configuration/mgmt-users.properties.
&lt;JBOSS_HOME&gt;/standalone/configuration/mgmt-users.properties.
</pre>
<br/><br/>
Identify users who
have access to the files using relevant OS commands.
<br/><br/>
Obtain documentation from
system admin identifying authorized users.
<br/><br/>
Owner can be full access. Group can be full access.
All others must have execute permissions only.
<br/><br/>
If the file
permissions are not configured so as to restrict access to only authorized
users, or if documentation that identifies authorized users is missing, this is
a finding.
</ocil>
<rationale>
The mgmt-users.properties file contains the password hashes of all users who
are in a management role and must be protected. Application servers have the
ability to specify that the hosted applications utilize shared libraries. The
application server must have a capability to divide roles based upon duties
wherein one project user (such as a developer) cannot modify the shared library
code of another project user. The application server must also be able to
specify that non-privileged users cannot modify any shared library code at
all.
</rationale>
<ident cce="80464-1"/>
<oval id="jboss_eap_configure_user_permissions" value="var_jboss_profile" />
<ref srg="SRG-APP-000133-AS-000092" disa="1499" nist="" stigid="JBOS-AS-000210"/>
</Rule>

<Rule id="jboss_eap_restrict_jboss_account" severity="high">
<title>Restrict the JBoss Account</title>
<description>
Use the relevant OS commands to restrict JBoss user account from interactively
logging on to the console of the JBoss system.
<br/><br/>
For Windows systems, use GPO.
For UNIX like systems using ssh DenyUsers <i>account id</i> or follow established
procedure for restricting access.
</description>
<ocil clause="it is not">
Identify the user account used to run the JBoss server. Use relevant OS
commands to determine logon rights to the system. This account should not have
full shell/interactive access to the system.
<br/><br/>
If the user account used to
operate JBoss can log on interactively, this is a finding.
</ocil>
<rationale>
JBoss does not require admin rights to operate and should be run as a regular
user. In addition, if the user account was to be compromised and the account
was allowed interactive logon rights, this would increase the risk and attack
surface against the JBoss system. The right to interactively log on to the
system using the JBoss account should be limited according to the OS
capabilities.
</rationale>
<ident cce="80465-8"/>
<oval id="jboss_eap_restrict_jboss_account" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000220"/>
</Rule>

<Rule id="jboss_eap_disable_analytics" severity="medium">
<title>Disable Google Analytics</title>
<description>
Using the EAP web console, log on using admin credentials.
On the bottom right-hand side of the screen, select <tt>Settings</tt>,
uncheck the <tt>Enable Data Usage Collection</tt> box, and save the
configuration.
</description>
<ocil clause="it is not">
Open the EAP web console by pointing a web browser to
<pre>HTTPS://<i>SERVERNAME</i>:9443</pre>
or <pre>HTTP://<i>SERVERNAME</i>:9990</pre>
<br/><br/>
Log on to the admin console using admin
credentials.
On the bottom right-hand side of the screen, select <tt>Settings</tt>.
If the <tt>Enable Data Usage Collection</tt> box is checked, this is a
finding.
</ocil>
<rationale>
The Google Analytics feature aims to help Red Hat EAP team understand how
customers are using the console and which parts of the console matter the most
to the customers. This information will, in turn, help the team to adapt the
console design, features, and content to the immediate needs of the customers.
Sending analytical data to the vendor introduces risk of unauthorized data
exfiltration. This capability must be disabled.
</rationale>
<ident cce="80466-6"/>
<oval id="jboss_eap_disable_analytics" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000225"/>
</Rule>

<Rule id="jboss_eap_unprivileged_mode" severity="high">
<title>Restrict JBoss Account</title>
<description>
Run the JBoss server with non-admin rights.
</description>
<ocil clause="it is not">
The script that is used to start JBoss determines the mode in which JBoss will
operate, which will be in either in standalone mode or domain mode. Both
scripts are installed by default in the <tt>&lt;JBOSS_HOME&gt;/bin/</tt> folder.
<br/><br/>
In addition
to running the JBoss server as an interactive script launched from the command
line, JBoss can also be started as a service.
<br/><br/>
The scripts used to start JBoss are:
Red Hat:
<pre>
standalone.sh
domain.sh
</pre>
<br/><br/>
Windows:
<pre>
standalone.bat
domain.bat
</pre>
<br/><br/>
Use the relevant OS commands to determine JBoss ownership.
<br/><br/>
When running as a process:
Red Hat: <pre>ps -ef|grep -i jboss</pre>.
Windows: <pre>services.msc</pre>.
Search for the JBoss process, which by default is named <tt>JBOSSEAP6</tt>.
<br/><br/>
If
the user account used to launch the JBoss script or start the JBoss process has
admin rights on the system, this is a finding.
</ocil>
<rationale>
JBoss EAP application server can be run as the OS admin, which is not advised.
Running the application server with admin privileges increases the attack
surface by granting the application server more rights than it requires in order
to operate. If the server is compromised, the attacker will have the same
rights as the application server, which in that case would be admin rights. The
JBoss EAP server must not be run as the admin user.
</rationale>
<ident cce="80467-4"/>
<oval id="jboss_eap_unprivileged_mode" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000230"/>
</Rule>

<Rule id="jboss_eap_remove_quickstarts" severity="medium">
<title>Remove JBoss Quickstarts</title>
<description>
Delete the QuickStarts folder.
</description>
<ocil clause="it is not">
Examine the <tt>&lt;JBOSS_HOME&gt;</tt> folder. If a <tt>jboss-eap-6.3.0-GA-quickstarts</tt> folder
exits, this is a finding.
</ocil>
<rationale>
JBoss QuickStarts are demo applications that can be deployed quickly. Demo
applications are not written with security in mind and often open new attack
vectors. QuickStarts must be removed.
</rationale>
<ident cce="80468-2"/>
<oval id="jboss_eap_remove_quickstarts" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000235"/>
</Rule>

<Rule id="jboss_eap_remove_jmx" severity="medium">
<title>Remove the JMX Subsystem</title>
<description>
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
<br/><br/>
For a Managed Domain configuration you
must check each profile name:
<br/><br/>
For each PROFILE NAME, run the command:
<pre>/profile=<i>PROFILE NAME</i>/subsystem=jmx/remoting-connector=jmx:remove</pre>
For a Standalone configuration:
<pre>/subsystem=jmx/remoting-connector=jmx:remove</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script to start the Command Line Interface (CLI).
Connect to the server and authenticate.
<br/><br/>
For a Managed Domain configuration, you
must check each profile name:
<br/><br/>
For each <i>PROFILE NAME</i>, run the command:
<pre>ls /profile=<i>PROFILE NAME</i>/subsystem=jmx/remoting-connector</pre>
<br/><br/>
For a Standalone
configuration:
<pre>ls /subsystem=jmx/remoting-connector</pre>
<br/><br/>
If <tt>jmx</tt> is returned, this is a finding.
</ocil>
<rationale>
The JMX subsystem allows you to trigger JDK and application management
operations remotely. In a managed domain configuration, the JMX subsystem is
removed by default. For a standalone configuration, it is enabled by default and
must be removed.
</rationale>
<ident cce="80469-0"/>
<oval id="jboss_eap_remove_jmx" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000240"/>
</Rule>

<Rule id="jboss_eap_disable_replace_welcome_page" severity="low">
<title>Disable or Replace the JBoss Welcome Page</title>
<description>
Use the Management CLI script <pre>$JBOSS_HOME/bin/jboss-cli.sh</pre> to run the following
command. You may need to change the profile to modify a different managed domain
profile, or remove the <pre>/profile=default</pre> portion of the command for a
standalone server.
<br/><br/>
<pre>/profile=default/subsystem=web/virtual-server=default-host:writeattribute(name=enable-welcome-root,value.)</pre>
<br/><br/>
To configure
your web application to use the root context (/) as its URL address, modify the
applications jboss-web.xml, which is located in the applications <tt>META-INF/</tt> or
<tt>WEB-INF/</tt> directory. Replace its <tt>&lt;context-root&gt;</tt> directive with one that looks
like the following:
<br/><br/>
<pre>
<jboss-web>
    <context-root>/</context-root>
</jboss-web>
</pre>
</description>
<ocil clause="it is not">
Use a web browser and browse to <pre>HTTP://JBOSS SERVER IP ADDRESS:8080</pre>
<br/><br/>
If the
JBoss Welcome page is displayed, this is a finding.
</ocil>
<rationale>
The Welcome to JBoss web page provides a redirect to the JBoss admin console,
which, by default, runs on TCP 9990 as well as redirects to the Online User
Guide and Online User Groups hosted at locations on the Internet. The welcome
page is unnecessary and should be disabled or replaced with a valid web
page.
</rationale>
<ident cce="80470-8"/>
<oval id="jboss_eap_disable_replace_welcome_page" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000245"/>
</Rule>

<Rule id="jboss_eap_remove_unnecessary_apps" severity="medium">
<title>Remove Unnecessary Applications</title>
<description>
Identify, authorize, and document all applications that are deployed to the
application server. Remove unauthorized applications.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
<pre>ls /deployment</pre>
<br/><br/>
The list of deployed applications is displayed.
Have the system admin identify the applications listed and confirm they are
approved applications.
<br/><br/>
If the system admin cannot provide documentation proving
their authorization for deployed applications, this is a finding.
</ocil>
<rationale>
Extraneous services and applications running on an application server expands
the attack surface and increases risk to the application server. Securing any
server involves identifying and removing any unnecessary services and, in the
case of an application server, unnecessary and/or unapproved applications.
</rationale>
<ident cce="80471-6"/>
<oval id="jboss_eap_remove_unnecessary_apps" value="var_jboss_profile" />
<ref srg="SRG-APP-000141-AS-000095" disa="381" nist="" stigid="JBOS-AS-000250"/>
</Rule>

<Rule id="jboss_eap_configure_ports" severity="medium">
<title>Configure JBoss Management and Application Ports</title>
<description>
Open the EAP web console by pointing a web browser to <pre>HTTPS://<i>Servername</i>:9990</pre>
Log on to the admin console using admin credentials
Select the
<tt>Configuration</tt> tab
Expand the <tt>General Configuration</tt> sub
system by clicking on the <tt>+</tt>
Select <tt>Socket Binding</tt>
Select the
<tt>View</tt> option next to <tt>standard-sockets</tt>
Select
<tt>Inbound</tt>
<br/><br/>
Select the port that needs to be reconfigured and select
<tt>Edit</tt>.
</description>
<ocil clause="it is not">
Open the EAP web console by pointing a web browser to <pre>HTTPS://<i>Servername</i>:9443</pre>
or <pre>HTTP://<i>Servername</i>:9990</pre>
<br/><br/>
Log on to the admin console using admin credentials
Select the <tt>Configuration</tt> tab
Expand the <tt>General Configuration</tt> sub system by clicking on the <tt>+</tt>
Select <tt>Socket Binding</tt>
Select the <tt>View</tt> option next to <tt>standard-sockets</tt>
Select <tt>Inbound</tt>
<br/><br/>
Review the configured ports and
determine if they are all approved by the PPSM CAL.
<br/><br/>
If all the ports are not
approved by the PPSM CAL, this is a finding.
</ocil>
<rationale>
Some networking protocols may not meet organizational security requirements to
protect data and components.
<br/><br/>
Application servers natively host a number of
various features, such as management interfaces, httpd servers and message
queues. These features all run on TCPIP ports. This creates the potential that
the vendor may choose to utilize port numbers or network services that have been
deemed unusable by the organization. The application server must have the
capability to both reconfigure and disable the assigned ports without adversely
impacting application server operation capabilities.
</rationale>
<ident cce="80472-4"/>
<oval id="jboss_eap_configure_ports" value="var_jboss_profile" />
<ref srg="SRG-APP-000142-AS-000014" disa="382" nist="" stigid="JBOS-AS-000255"/>
</Rule>

<Rule id="jboss_eap_configure_ldap" severity="medium">
<title>Configure LDAP</title>
<description>
Follow steps in section 11.8 - Management Interface Security in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
<br/><br/>
1. Create an outbound connection to the LDAP server.
2. Create an LDAP-enabled security realm.
3. Reference the new security domain in the Management Interface.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
<br/><br/>
To obtain the list of security realms run the command:
<pre>ls /core-service=management/security-realm=</pre>
<br/><br/>
Review each security realm using the
command:
<pre>ls /core-service=management/security-realm=<i>SECURITY_REALM_NAME</i>/authentication</pre>
<br/><br/>
If this command does not
return a security realm that uses LDAP for authentication, this is a finding.
</ocil>
<rationale>
To assure accountability and prevent unauthorized access, application server
users must be uniquely identified and authenticated. This is typically
accomplished via the use of a user store that is either local (OS-based) or
centralized (Active Directory/LDAP) in nature. It should be noted that JBoss
does not specifically mention Active Directory since AD is LDAP aware.
<br/><br/>
To
ensure accountability and prevent unauthorized access, the JBoss Server must be
configured to utilize a centralized authentication mechanism.
</rationale>
<ident cce="80473-2"/>
<oval id="jboss_eap_configure_ldap" value="var_jboss_profile" />
<ref srg="SRG-APP-000148-AS-000101" disa="764" nist="" stigid="JBOS-AS-000260"/>
</Rule>

<Rule id="jboss_eap_configure_multifactor_authentication" severity="medium">
<title>Configure Multi-Factor Authentication</title>
<description>
Configure the application server to authenticate privileged users via
multifactor/certificate-based authentication mechanisms when using network
access to the management interface.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Follow these steps:
1. Identify the security realm assigned to the management
interfaces by using the following command:
<br/><br/>
For standalone systems:
<pre>ls /core-service=management/management-interface=<i>INTERFACE-NAME</i></pre>
<br/><br/>
For
managed domain systems:
<pre>ls /host=master/core-service=management/management-interface=<i>INTERFACE-NAME</i></pre>
<br/><br/>
Document the name of the security-realm associated with each management interface.
<br/><br/>
2. Review the security realm
using the command:
<br/><br/>
For standalone systems:
<pre>ls /core-service=management/security-realm=<i>SECURITY_REALM_NAME</i>/authentication</pre>
<br/><br/>
For managed domains:
<pre>ls /host=master/core-service=management/security-realm=<i>SECURITY_REALM_NAME</i>/authentication</pre>
<br/><br/>
If the command in step 2 does
not return a security realm that uses certificates for authentication, this is a
finding.
</ocil>
<rationale>
Multifactor authentication creates a layered defense and makes it more
difficult for an unauthorized person to access the application server. If one
factor is compromised or broken, the attacker still has at least one more
barrier to breach before successfully breaking into the target. Unlike a simple
username/password scenario where the attacker could gain access by knowing both
the username and password without the user knowing his account was compromised,
multifactor authentication adds the requirement that the attacker must have
something from the user, such as a token, or to biometrically be the user.
Multifactor authentication is defined as: using two or more factors to achieve
authentication.
<br/><br/>
Factors include:
(i) something a user knows (e.g.,
password/PIN);
(ii) something a user has (e.g., cryptographic identification
device, token); or
(iii) something a user is (e.g., biometric). A CAC or PKI
Hardware Token meets this definition.
<br/><br/>
A privileged account is defined as an
information system account with authorizations of a privileged user. These
accounts would be capable of accessing the web management interface.
<br/><br/>
When
accessing the application server via a network connection, administrative access
to the application server must be PKI Hardware Token enabled or a DoD-approved
soft certificate.
</rationale>
<ident cce="80474-0"/>
<oval id="jboss_eap_configure_multifactor_authentication" value="var_jboss_profile" />
<ref srg="SRG-APP-000149-AS-000102" disa="765" nist="" stigid="JBOS-AS-000265"/>
</Rule>

<Rule id="jboss_eap_remove_group_accounts" severity="medium">
<title>Remove JBoss Group Acount Access</title>
<description>
Configure the application server so required users are individually
authenticated by creating individual user accounts. Utilize an LDAP server that
is configured according to DOD policy.
</description>
<ocil clause="it is not">
If the application server management interface is configured to use LDAP
authentication this requirement is NA.
<br/><br/>
Determine the mode in which the JBoss
server is operating by authenticating to the OS, changing to the
<tt>&lt;JBOSS_HOME&gt;/bin/</tt> folder and executing the <pre>jboss-cli</pre> script.
Connect to the
server and authenticate.
Run the command: <pre>ls</pre> and examine the <tt>launch-type</tt> setting.
<br/><br/>
User account information is stored in the following
files for a JBoss server configured in standalone mode. The command line flags
passed to the <tt>standalone</tt> startup script determine the standalone
operating mode:
<pre>
&lt;JBOSS_HOME&gt;/standalone/configuration/standalone.xml
&lt;JBOSS_HOME&gt;/standalone/configuration/standalone-full.xml
&lt;JBOSS_HOME&gt;/standalone/configuration/standalone.-full-ha.xml
&lt;JBOSS_HOME&gt;/standalone/configuration/standalone.ha.xml
</pre>
<br/><br/>
For a Managed Domain:
<pre>
&lt;JBOSS_HOME&gt;/domain/configuration/domain.xml
</pre>
<br/><br/>
Review both files for generic or
shared user accounts.
<br/><br/>
Open each xml file with a text editor and locate the
&lt;management-interfaces&gt; section.
Review the <pre>&lt;user name = "xxxxx"&gt;</pre> sub-
section where <pre>xxxxx</pre> will be a user name.
<br/><br/>
Have the system
administrator identify the user of each user account.
<br/><br/>
If user accounts are not
assigned to individual users, this is a finding.
</ocil>
<rationale>
To assure individual accountability and prevent unauthorized access,
application server users (and any processes acting on behalf of application
server users) must be individually identified and authenticated.
<br/><br/>
A group
authenticator is a generic account used by multiple individuals. Use of a group
authenticator alone does not uniquely identify individual users.
<br/><br/>
Application
servers must ensure that individual users are authenticated prior to
authenticating via role or group authentication. This is to ensure that there is
non-repudiation for actions taken.
</rationale>
<ident cce="80475-7"/>
<oval id="jboss_eap_remove_group_accounts" value="var_jboss_profile" />
<ref srg="SRG-APP-000153-AS-000104" disa="770" nist="" stigid="JBOS-AS-000275"/>
</Rule>

<Rule id="jboss_eap_configure_management_network" severity="medium">
<title>Separate JBoss Management Network</title>
<description>
Refer to Section 4.9 of the JBoss EAP 6.3 Installation guide for detailed
instructions on how to start JBoss as a service.
<br/><br/>
Use the following command line
parameters to assign the management interface to a specific management network.
These command line flags must be added both when starting JBoss as a service and
when starting from the command line.
<br/><br/>
Substitute your actual network address for
the 10.x.x.x addresses provided as an example below.
<br/><br/>
For a standalone
configuration:
<pre>
JBOSS_HOME/bin/standalone.sh -bmanagement=10.2.2.1 -b 10.1.1.1
JBOSS_HOME/bin/domain.sh -bmanagement=10.2.2.1 -b 10.1.1.1
</pre>
<br/><br/>
If a management
network is not available, you may substitute localhost/127.0.0.1 for management
address. This will force you to manage the JBoss server from the local host.
</description>
<ocil clause="it is not">
Obtain documentation and network drawings from system admin that shows the
network interfaces on the JBoss server and the networks they are configured for.
If a management network is not used, you may substitute localhost/127.0.0.1 for
management address. If localhost/127.0.0.1 is used for management interface,
this is not a finding.
<br/><br/>
From the JBoss server open the web-based admin console
by pointing a browser to <pre>HTTP://127.0.0.1:9990</pre>.
Log on to the management console
with admin credentials.
Select <tt>RUNTIME</tt>.
Expand <tt>STATUS</tt> by clicking on <tt>+</tt>.
Expand <tt>PLATFORM</tt> by clicking on <tt>+</tt>.
In the <tt>Environment</tt> tab, click the <tt>&gt;</tt>
arrow until you see the <tt>jboss.bind.properties</tt> and the
<pre>jboss.bind.properties.management</pre> values.
<br/><br/>
If the
jboss.bind.properties and the jboss.bind.properties.management do not have
different IP network addresses assigned, this is a finding.
<br/><br/>
Review the network
documentation. If access to the management IP address is not restricted, this
is a finding.
</ocil>
<rationale>
JBoss provides multiple interfaces for accessing the system. By default,
these are called public and management. Allowing non-
management traffic to access the JBoss management interface increases the
chances of a security compromise. The JBoss server must be configured to bind
the management interface to a network that controls access. This is usually a
network that has been designated as a management network and has restricted
access. Similarly, the public interface must be bound to a network that is not
on the same segment as the management interface.
</rationale>
<ident cce="80476-5"/>
<oval id="jboss_eap_configure_management_network" value="var_jboss_profile" />
<ref srg="SRG-APP-000158-AS-000108" disa="778" nist="" stigid="JBOS-AS-000285"/>
</Rule>

<Rule id="jboss_eap_configure_management_ldap" severity="medium">
<title>Configure LDAP for Management Interfaces</title>
<description>
Follow steps in section 11.8 - Management Interface Security in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
<br/><br/>
1. Create an outbound connection to the LDAP server.
2. Create an LDAP-enabled security realm.
3. Reference the new security domain in the Management Interface.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Obtain the list of management interfaces by running the command:
<pre>ls /core-service=management/management-interface</pre>
<br/><br/>
Identify the security realm used
by each management interface configuration by running the command:
<pre>ls /core-service=management/management-interface=<i>MANAGEMENT-INTERFACE-NAME</i></pre>
Determine if the security realm assigned to the management interface uses LDAP
for authentication by running the command:
<pre>ls /core-service=management/security-realm=<i>SECURITY_REALM_NAME</i>/authentication</pre>
<br/><br/>
If the security
realm assigned to the management interface does not utilize LDAP for
authentication, this is a finding.
</ocil>
<rationale>
JBoss EAP provides a security realm called ManagementRealm. By default, this
realm uses the mgmt-users.properties file for authentication. Using file-based
authentication does not allow the JBoss server to be in compliance with a wide
range of user management requirements such as automatic disabling of inactive
accounts as per DoD policy. To address this issue, the management interfaces
used to manage the JBoss server must be associated with a security realm that
provides centralized authentication management. Examples are AD or LDAP.
Management of user identifiers is not applicable to shared information system
accounts (e.g., guest and anonymous accounts). It is commonly the case that a
user account is the name of an information system account associated with an
individual.
</rationale>
<ident cce="80477-3"/>
<oval id="jboss_eap_configure_management_ldap" value="var_jboss_profile" />
<ref srg="SRG-APP-000163-AS-000111" disa="795" nist="" stigid="JBOS-AS-000290"/>
</Rule>

<Rule id="jboss_eap_configure_keystore" severity="medium">
<title>Enable the JBoss Keystore</title>
<description>
Configure the application server to use the java keystore and JBoss vault as
per section 11.13.1 -Password Vault System in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
<br/><br/>
1. Create a java keystore.
2. Mask the keystore password and initialize the password vault.
3. Configure JBoss to use the password vault.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
<pre>ls /core-service=vault</pre>
<br/><br/>
If <pre>code=undefined</pre> and <pre>module=undefined</pre>,
this is a finding.
</ocil>
<rationale>
JBoss EAP 6 has a Password Vault to encrypt sensitive strings, store them in an
encrypted keystore, and decrypt them for applications and verification systems.
Plain-text configuration files, such as XML deployment descriptors, need to
specify passwords and other sensitive information. Use the JBoss EAP Password
Vault to securely store sensitive strings in plain-text files.
</rationale>
<ident cce="80478-1"/>
<oval id="jboss_eap_configure_keystore" value="var_jboss_profile" />
<ref srg="SRG-APP-000171-AS-000119" disa="196" nist="" stigid="JBOS-AS-000295"/>
</Rule>

<Rule id="jboss_eap_encrypt_keystore_passwords" severity="medium">
<title>Encrypt JBoss Keystore Passwords</title>
<description>
Configure the application server to mask the java keystore password as per the
procedure described in section 11.13.3 -Password Vault System in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
</description>
<ocil clause="it is not">
The default location for the keystore used by the JBoss vault is the
<tt>&lt;JBOSS_HOME&gt;/vault/</tt> folder.
<br/><br/>
If a vault keystore has been created, by default it
will be in the file: <tt>&lt;JBOSS_HOME&gt;/vault/vault.keystore</tt>. The file stores a
single key, with the default alias vault, which will be used to store encrypted
strings, such as passwords, for JBoss EAP.
<br/><br/>
Have the system admin provide the
procedure used to encrypt the keystore password that unlocks the keystore.
<br/><br/>
If
the system administrator is unable to demonstrate or provide written process
documentation on how to encrypt the keystore password, this is a finding.
</ocil>
<rationale>
Access to the JBoss Password Vault must be secured, and the password used to
access must be encrypted. There is a specific process used to generate the
encrypted password hash. This process must be followed in order to store the
password in an encrypted format.
<br/><br/>
The admin must utilize this process in order
to ensure the Keystore password is encrypted.
</rationale>
<ident cce="80479-9"/>
<oval id="jboss_eap_encrypt_keystore_passwords" value="var_jboss_profile" />
<ref srg="SRG-APP-000171-AS-000119" disa="196" nist="" stigid="JBOS-AS-000300"/>
</Rule>

<Rule id="jboss_eap_require_password_access" severity="medium">
<title>Require Password Authentication</title>
<description>
Configure the LDAP Security Realm using default settings that sets <tt>allow-empty-values</tt>
to <tt>..</tt> LDAP Security Realm creation is described in
section 11.9 -Add an LDAP Security Realm in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
<pre>ls /core-service=management/security-realm=ldap_security_realm/authentication=ldap</pre>
<br/><br/>
If <pre>allow-empty-passwords=true</pre>, this is a finding.
</ocil>
<rationale>
Passwords need to be protected at all times, and encryption is the standard
method for protecting passwords during transmission. If passwords are not
encrypted, they can be plainly read (i.e., clear text) and easily compromised.
Application servers have the capability to utilize either certificates (tokens)
or user IDs and passwords in order to authenticate. When the application server
transmits or receives passwords, the passwords must be encrypted.
</rationale>
<ident cce="80480-7"/>
<oval id="jboss_eap_require_password_access" value="var_jboss_profile" />
<ref srg="SRG-APP-000172-AS-000120" disa="197" nist="" stigid="JBOS-AS-000305"/>
</Rule>

<Rule id="jboss_eap_use_secure_ldap_port" severity="medium">
<title>Use Secure Standard LDAP Port</title>
<description>
Follow steps in section 11.8 - Management Interface Security in the
JBoss_Enterprise_Application_Platform-6.3
-Administration_and_Configuration_Guide-en-US document.
<br/><br/>
1. Create an outbound connection to the LDAP server.
2. Create an LDAP-enabled security realm.
3. Reference the new security domain in the Management Interface.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
<br/><br/>
Run the following command:
<br/><br/>
For standalone servers:
<pre>ls /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=ldap_connection</pre>
<br/><br/>
For managed domain installations:
<pre>ls /socket-binding-group=<i>PROFILE</i>/remote-destination-outbound-socket-binding=</pre>
<br/><br/>
The default port for secure LDAP is 636.
<br/><br/>
If 636 or secure LDAP protocol is not utilized, this is a finding.
</ocil>
<rationale>
Passwords need to be protected at all times, and encryption is the standard
method for protecting passwords during transmission.
<br/><br/>
Application servers have
the capability to utilize LDAP directories for authentication. If LDAP
connections are not protected during transmission, sensitive authentication
credentials can be stolen. When the application server utilizes LDAP, the LDAP
traffic must be encrypted.
</rationale>
<ident cce="80481-5"/>
<oval id="jboss_eap_use_secure_ldap_port" value="var_jboss_profile" />
<ref srg="SRG-APP-000172-AS-000121" disa="197" nist="" stigid="JBOS-AS-000310"/>
</Rule>

<Rule id="jboss_eap_secure_keystore_permissions" severity="medium">
<title>Restrict Access to the JBoss Keystore</title>
<description>
Configure the application server OS file permissions on the corresponding
private key to restrict access to authorized accounts or roles.
</description>
<ocil clause="it is not">
The default location for the keystore used by the JBoss vault is the
<tt>&lt;JBOSS_HOME&gt;/vault/</tt> folder.
<br/><br/>
If a vault keystore has been created, by default it
will be in the file: <tt>&lt;JBOSS_HOME&gt;/vault/vault.keystore</tt>. The file stores a
single key, with the default alias vault, which will be used to store encrypted
strings, such as passwords, for JBoss EAP.
<br/><br/>
Browse to the JBoss vault folder
using the relevant OS commands.
Review the file permissions and ensure only
system administrators and JBoss users are allowed access.
<br/><br/>
Owner can be full access. Group can be full access.
All others must be restricted to execute access
or no permission.
<br/><br/>
If non-system administrators are allowed to access the
<tt>&lt;JBOSS_HOME&gt;/vault/</tt>
folder, this is a finding.
</ocil>
<rationale>
The cornerstone of the PKI is the private key used to encrypt or digitally sign
information.
<br/><br/>
If the private key is stolen, this will lead to the compromise of
the authentication and non-repudiation gained through PKI because the attacker
can use the private key to digitally sign documents and can pretend to be the
authorized user.
<br/><br/>
Both the holders of a digital certificate and the issuing
authority must protect the computers, storage devices, or whatever they use to
keep the private keys. Java-based application servers utilize the Java keystore,
which provides storage for cryptographic keys and certificates. The keystore is
usually maintained in a file stored on the file system.
</rationale>
<ident cce="80482-3"/>
<oval id="jboss_eap_secure_keystore_permissions" value="var_jboss_profile" />
<ref srg="SRG-APP-000176-AS-000125" disa="186" nist="" stigid="JBOS-AS-000320"/>
</Rule>

<Rule id="jboss_eap_service_separate_networks" severity="medium">
<title>Use Separate Management and Application Networks</title>
<description>
Start the application server with a <tt>-bmanagement</tt> and a <tt>-b</tt> flag so that admin
management functionality and hosted applications are separated.
<br/><br/>
Refer to
section 4.9 in the JBoss EAP 6.3 Installation Guide for specific instructions on
how to start the JBoss server as a service.
</description>
<ocil clause="it is not">
If JBoss is not started with separate management and public interfaces, this is
a finding.
<br/><br/>
Review the network design documents to identify the IP address space
for the management network.
<br/><br/>
Use relevant OS commands and administrative
techniques to determine how the system administrator starts the JBoss server.
This includes interviewing the system admin, using the <pre>ps -ef|grep</pre>
command for UNIX like systems or checking command line flags and properties on
batch scripts for Windows systems.
<br/><br/>
Ensure the startup syntax used to start
JBoss specifies a management network address and a public network address.
<br/><br/>
The
<tt>-b</tt> flag specifies the public address space.
The
<tt>-bmanagement</tt> flag specifies the management address space.
<br/><br/>
Example:
<pre>
&lt;JBOSS_HOME&gt;/bin/standalone.sh -bmanagement 10.10.10.35 -b 192.168.10.25
</pre>
<br/><br/>
If
JBoss is not started with separate management and public interfaces, this is a
finding.
</ocil>
<rationale>
The application server consists of the management interface and hosted
applications. By separating the management interface from hosted applications,
the user must authenticate as a privileged user to the management interface
before being presented with management functionality. This prevents non-
privileged users from having visibility to functions not available to the user.
By limiting visibility, a compromised non-privileged account does not offer
information to the attacker or functionality and information needed to further
the attack on the application server.
<br/><br/>
JBoss is designed to operate with
separate application and management interfaces.
The JBoss server is started via
a script. To start the JBoss server in domain mode, the admin will execute the
/bin/domain.sh or domain.bat script.
<br/><br/>
To start the JBoss server in standalone
mode, the admin will execute /bin/standalone.bat or standalone.sh.
<br/><br/>
Command line
flags are used to specify which network address is used for management and which
address is used for public/application access.
</rationale>
<ident cce="80483-1"/>
<oval id="jboss_eap_service_separate_networks" value="var_jboss_profile" />
<ref srg="SRG-APP-000211-AS-000146" disa="1082" nist="" stigid="JBOS-AS-000355"/>
</Rule>

<Rule id="jboss_eap_file_permissions" severity="medium">
<title>Configure JBoss Application File Permissions</title>
<description>
Configure file permissions on the JBoss folder to protect from unauthorized
access.
</description>
<ocil clause="it is not">
By default, JBoss installs its files into a folder called <tt>jboss-eap-6.3</tt>.
This folder by default is stored within the home folder of the JBoss user
account. The installation process, however, allows for the override of default
values to obtain folder and user account information from the system admin.
<br/><br/>
Log
on with a user account with JBoss access and permissions.
<br/><br/>
Navigate to the <tt>Jboss-eap-6.3</tt>
folder using the relevant OS commands for either a UNIX-
like OS or a Windows OS.
<br/><br/>
Examine the permissions of the JBoss folder.
<br/><br/>
Owner can be full access. Group can be full access.
All others must be restricted to
execute access or no permission.
<br/><br/>
If the JBoss folder is world readable or world
writeable, this is a finding.
</ocil>
<rationale>
The JBoss EAP Application Server is a Java-based AS. It is installed on the OS
file system and depends upon file system access controls to protect application
data at rest. The file permissions set on the JBoss EAP home folder must be
configured so as to limit access to only authorized people and processes. The
account used for operating the JBoss server and any designated administrative or
operational accounts are the only accounts that should have access.
<br/><br/>
When data
is written to digital media such as hard drives, mobile computers,
external/removable hard drives, personal digital assistants, flash/thumb drives,
etc., there is risk of data loss and data compromise. Steps must be taken to
ensure data stored on the device is protected.
</rationale>
<ident cce="80484-9"/>
<oval id="jboss_eap_file_permissions" value="var_jboss_profile" />
<ref srg="SRG-APP-000231-AS-000133" disa="1199" nist="" stigid="JBOS-AS-000400"/>
</Rule>

<Rule id="jboss_eap_logs_permissions" severity="medium">
<title>Configure JBoss Log Directory Permissions</title>
<description>
Configure file permissions on the JBoss log folder to protect from unauthorized
access.
</description>
<ocil clause="it is not">
If the JBoss log folder is installed in the default location and
AS-000133-JBOSS-00079 is not a finding, the log folders are protected and this
requirement is not a finding.
<br/><br/>
By default, JBoss installs its log files into a
sub-folder of the <pre>jboss-eap-6.3</pre> home folder.
Using a UNIX like OS
example, the default location for log files is:
<br/><br/>
<pre>
JBOSS_HOME/standalone/log
JBOSS_HOME/domain/log
</pre>
<br/><br/>
For a standalone configuration:
<tt>JBOSS_HOME/standalone/log/server.log</tt> Contains all server log messages,
including server startup messages.
<br/><br/>
For a domain configuration:
<tt>JBOSS_HOME/domain/log/hostcontroller.log</tt>
Host Controller boot log. Contains log
messages related to the startup of the host controller.
<tt>JBOSS_HOME/domain/log/processcontroller.log</tt>
Process controller boot log.
Contains log messages related to the startup of the process controller.
<tt>JBOSS_HOME/domain/servers/SERVERNAME/log/server.log</tt>
The server log for the named
server. Contains all log messages for that server, including server startup
messages.
<br/><br/>
Log on with an OS user account with JBoss access and permissions.
Navigate to the <tt>Jboss-eap-6.3</tt> folder using the relevant OS commands
for either a UNIX like OS or a Windows OS.
<br/><br/>
Examine the permissions of the JBoss logs folders.
<br/><br/>
Owner can be full access. Group can be full access.
All others must be restricted.
<br/><br/>
If the JBoss log folder is world readable or world
writeable, this is a finding.
</ocil>
<rationale>
If the application provides too much information in error logs and
administrative messages to the screen, this could lead to compromise. The
structure and content of error messages need to be carefully considered by the
organization and development team. The extent to which the information system is
able to identify and handle error conditions is guided by organizational policy
and operational requirements.
<br/><br/>
Application servers must protect the error
messages that are created by the application server. All application server
users' accounts are used for the management of the server and the applications
residing on the application server. All accounts are assigned to a certain role
with corresponding access rights. The application server must restrict access to
error messages so only authorized users may view them. Error messages are
usually written to logs contained on the file system. The application server
will usually create new log files as needed and must take steps to ensure that
the proper file permissions are utilized when the log files are created.
</rationale>
<ident cce="80485-6"/>
<oval id="jboss_eap_logs_permissions" value="var_jboss_profile" />
<ref srg="SRG-APP-000267-AS-000170" disa="1314" nist="" stigid="JBOS-AS-000425"/>
</Rule>

<Rule id="jboss_eap_disable_domain_admin_console" severity="medium">
<title>Disable Network Access to the Admin Console</title>
<description>
Run the <pre>&lt;JBOSS_HOME&gt;/bin/jboss-clii</pre> command line interface utility.
Connect to
the JBoss server and run the following command.
<pre>/core-service=management/management-interface=httpinterface/:write-attribute(name=console-enabled,value.)</pre>
<br/><br/>
Successful command execution returns
<pre>{"outcome" => success"}</pre>,
and future attempts to access the management console via web
browser at <tt><i>SERVERNAME</i>:9990</tt> will result in no access to the admin console.
</description>
<ocil clause="it is not">
Log on to each of the JBoss domain member servers.
<br/><br/>
Note: Sites that manage
systems using the JBoss Operations Network client require HTTP interface access.
It is acceptable that the management console alone be disabled rather than
disabling the entire interface itself.
<br/><br/>
Run the <pre>&lt;JBOSS_HOME&gt;/bin/jboss-cli</pre>
command line interface utility and connect to the JBoss server.
Run the
following command:
<pre>ls /core-service=management/management-interface=httpinterface/</pre>
<br/><br/>
If <pre>console-enabled=true</pre>, this is a finding.
</ocil>
<rationale>
When configuring JBoss application servers into a domain configuration, HTTP
management capabilities are not required on domain member servers as management
is done via the server that has been designated as the domain controller.
Leaving HTTP management capabilities enabled on domain member servers increases
the attack surfaces; therefore, management services on domain member servers
must be disabled and management services performed via the domain
controller.
</rationale>
<ident cce="80486-4"/>
<oval id="jboss_eap_disable_domain_admin_console" value="var_jboss_profile" />
<ref srg="SRG-APP-000316-AS-000199" disa="2322" nist="" stigid="JBOS-AS-000470"/>
</Rule>

<Rule id="jboss_eap_audit_privileged_actions" severity="medium">
<title>Audit JBoss Privileged Actions</title>
<description>
Launch the jboss-cli management interface substituting standalone or domain for
<i>CONFIG</i> based upon the server installation.
<br/><br/>
<pre>&lt;JBOSS_HOME&gt;/<i>CONFIG/</i>/bin/jboss-cli</pre>
<br/><br/>
connect to the server and run the following command:
<br/><br/>
<pre>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
<pre>/core-service=management/access=audit:read-resource(recursive=true)</pre>
<br/><br/>
Under the <pre>"logger" => {audit-log}</pre> section of
the returned response:
If <pre>"enabled" =>.</pre>, this is a finding
</ocil>
<rationale>
In order to be able to provide a forensic history of activity, the application
server must ensure users who are granted a privileged role or those who utilize
a separate distinct account when accessing privileged functions or data have
their actions logged.
<br/><br/>
If privileged activity is not logged, no forensic logs
can be used to establish accountability for privileged actions that occur on the
system.
</rationale>
<ident cce="80487-2"/>
<oval id="jboss_eap_audit_privileged_actions" value="var_jboss_profile" />
<ref srg="SRG-APP-000343-AS-000030" disa="2234" nist="" stigid="JBOS-AS-000480"/>
</Rule>

<Rule id="jboss_eap_configure_syslog" severity="medium">
<title>Enable Logging to syslog</title>
<description>
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run
the command:
<br/><br/>
Standalone configuration:
<pre>ls /subsystem=logging/syslog-handler=</pre>
<br/><br/>
Domain configuration:
<pre>ls /profile=default/subsystem=logging/syslog-handler=</pre>
<br/><br/>
If no values are returned, this is a finding.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
Standalone configuration:
<pre>ls /subsystem=logging/syslog-handler=</pre>
<br/><br/>
Domain configuration:
<pre>ls /profile=<i>specify</i>/subsystem=logging/syslog-handler=</pre>
Where <i>specify</i> = the
selected application server profile of; default,full, full-ha or ha.
<br/><br/>
If no values are returned, this is a finding.
</ocil>
<rationale>
Information system logging capability is critical for accurate forensic
analysis. Log record content that may be necessary to satisfy the requirement of
this control includes, but is not limited to, time stamps, source and
destination IP addresses, user/process identifiers, event descriptions,
application-specific events, success/fail indications, filenames involved,
access control or flow control rules invoked.
<br/><br/>
Off-loading is a common process
in information systems with limited log storage capacity.
<br/><br/>
Centralized
management of log records provides for efficiency in maintenance and management
of records, as well as the backup and archiving of those records. Application
servers and their related components are required to off-load log records onto a
different system or media than the system being logged.
</rationale>
<ident cce="80488-0"/>
<oval id="jboss_eap_configure_syslog" value="var_jboss_profile" />
<ref srg="SRG-APP-000358-AS-000064" disa="1851" nist="" stigid="JBOS-AS-000505"/>
</Rule>

<Rule id="jboss_eap_disable_automatic_deployment" severity="medium">
<title>Disable Automatic Deployment</title>
<description>
Determine the JBoss server configuration as being either standalone or domain.
Launch the relevant jboss-cli management interface substituting standalone or
domain for <i>CONFIG</i>
<br/><br/>
<pre>&lt;JBOSS_HOME&gt;/<i>CONFIG</i>/bin/jboss-cli</pre>
<br/><br/>
connect to the server and run the command:
<pre>/subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-enabled,value.)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run
the command:
<br/><br/>
<pre>ls /subsystem=deployment-scanner/scanner=default</pre>
<br/><br/>
If <pre>"scan-enabled"=true</pre>, this is a finding.
</ocil>
<rationale>
When dealing with access restrictions pertaining to change control, it should
be noted that any changes to the software and/or application server
configuration can potentially have significant effects on the overall security
of the system.
<br/><br/>
Access restrictions for changes also include application
software libraries.
<br/><br/>
If the application server provides automatic code
deployment capability, (where updates to applications hosted on the application
server are automatically performed, usually by the developers' IDE tool), it
must also provide a capability to restrict the use of automatic application
deployment. Automatic code deployments are allowable in a development
environment, but not in production.
</rationale>
<ident cce="80489-8"/>
<oval id="jboss_eap_disable_automatic_deployment" value="var_jboss_profile" />
<ref srg="SRG-APP-000380-AS-000088" disa="1813" nist="" stigid="JBOS-AS-000545"/>
</Rule>

<Rule id="jboss_eap_log_deployments" severity="medium">
<title>Log Application Deployments</title>
<description>
Launch the jboss-cli management interface substituting standalone or domain for
<i>CONFIG</i> based upon the server installation.
<br/><br/>
<pre>&lt;JBOSS_HOME&gt;/<i>CONFIG</i>/bin/jboss-cli</pre>
<br/><br/>
connect to the server and run the following command:
<br/><br/>
<pre>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre>
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Run the command:
<br/><br/>
<pre>ls /core-service=management/access=audit/logger=audit-log</pre>
<br/><br/>
If <pre>"enabled" =.</pre>, this is a finding.
</ocil>
<rationale>
Without logging the enforcement of access restrictions against changes to the
application server configuration, it will be difficult to identify attempted
attacks, and a log trail will not be available for forensic investigation for
after-the-fact actions. Configuration changes may occur to any of the modules
within the application server through the management interface, but logging of
actions to the configuration of a module outside the application server is not
logged.
<br/><br/>
Enforcement actions are the methods or mechanisms used to prevent
unauthorized changes to configuration settings. Enforcement action methods may
be as simple as denying access to a file based on the application of file
permissions (access restriction). Log items may consist of lists of actions
blocked by access restrictions or changes identified after the fact.
</rationale>
<ident cce="80490-6"/>
<oval id="jboss_eap_log_deployments" value="var_jboss_profile" />
<ref srg="SRG-APP-000381-AS-000089" disa="1814" nist="" stigid="JBOS-AS-000550"/>
</Rule>

<Rule id="jboss_eap_use_approved_ca_cert" severity="medium">
<title>Use Approved DoD Certificate Authorities</title>
<description>
Locate the cacerts file for the JVM. This can be done using the appropriate
find command for the OS and change to the directory where the cacerts file is
located.
<br/><br/>
Remove the certificates that have a CA that is non-DoD approved, and
import DoD CA-approved certificates.
</description>
<ocil clause="it is not">
Locate the cacerts file for the JVM. This can be done using the appropriate
find command for the OS and change to the directory where the cacerts file is
located.
<br/><br/>
To view the certificates stored within this file, execute the java
command <pre>keytool -list -v -keystore ./cacerts</pre>.
Verify that the Certificate
Authority (CA) for each certificate is DoD-approved.
<br/><br/>
If any certificates have a
CA that are not DoD-approved, this is a finding.
</ocil>
<rationale>
Untrusted Certificate Authorities (CA) can issue certificates, but they may be
issued by organizations or individuals that seek to compromise DoD systems or by
organizations with insufficient security controls. If the CA used for verifying
the certificate is not a DoD-approved CA, trust of this CA has not been
established.
<br/><br/>
The DoD will only accept PKI certificates obtained from a DoD-
approved internal or external certificate authority. Reliance on CAs for the
establishment of secure sessions includes, for example, the use of SSL/TLS
certificates. The application server must only allow the use of DoD PKI-
established certificate authorities for verification.
</rationale>
<ident cce="80491-4"/>
<oval id="jboss_eap_use_approved_ca_cert" value="var_jboss_profile" />
<ref srg="SRG-APP-000427-AS-000264" disa="2470" nist="" stigid="JBOS-AS-000625"/>
</Rule>

<Rule id="jboss_eap_configure_ha_lb" severity="medium">
<title>Configure Load Balancing (LB) or High Availability (HA)</title>
<description>
Configure the application server to provide LB or HA services for the hosted
application.
</description>
<ocil clause="it is not">
Interview the system admin and determine if the applications hosted on the
application server are mission critical and require load balancing (LB) or high
availability (HA).
<br/><br/>
If the applications do not require LB or HA, this
requirement is NA.
<br/><br/>
If the documentation shows the LB or HA services are being
provided by another system other than the application server, this requirement
is NA.
<br/><br/>
If applications require LB or HA, request documentation from the system
admin that identifies what type of LB or HA configuration has been implemented
on the application server.
<br/><br/>
Ask the system admin to identify the components that
require protection. Some options are included here as an example. Bear in mind
the examples provided are not complete and absolute and are only provided as
examples. The components being made redundant or HA by the application server
will vary based upon application availability requirements.
<br/><br/>
Examples are:
Instances of the Application Server
Web Applications
Stateful, stateless and
entity Enterprise Java Beans (EJBs)
Single Sign On (SSO) mechanisms
Distributed
Cache
HTTP sessions
JMS and Message Services.
<br/><br/>
If the hosted application
requirements specify LB or HA and the JBoss server has not been configured to
offer HA or LB, this is a finding.
</ocil>
<rationale>
A MAC I system is a system that handles data vital to the organization's
operational readiness or effectiveness of deployed or contingency forces. A MAC
I system must maintain the highest level of integrity and availability. By HA
clustering the application server, the hosted application and data are given a
platform that is load-balanced and provides high availability.
</rationale>
<ident cce="80492-2"/>
<oval id="jboss_eap_configure_ha_lb" value="var_jboss_profile" />
<ref srg="SRG-APP-000435-AS-000069" disa="2385" nist="" stigid="JBOS-AS-000640"/>
</Rule>

<Rule id="jboss_eap_use_tls" severity="medium">
<title>Use Approves TLS version</title>
<description>
Reference section 4.6 of the JBoss EAP 6.3 Security Guide located on the Red
Hat vendor's web site for step-by-step instructions on establishing SSL
encryption on JBoss.
<br/><br/>
The overall steps include:
<br/><br/>
1. Add an HTTPS connector.
2. Configure the SSL encryption certificate and keys.
3. Set the protocol to TLS V1.1 or V1.2.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Validate that the TLS protocol is used for HTTPS connections.
Run the command:
<pre>ls /subsystem=web/connector=https/ssl=configuration</pre>
<br/><br/>
If a TLS V1.1 or V1.2 protocol is not returned, this is a finding.
</ocil>
<rationale>
Preventing the disclosure of transmitted information requires that the
application server take measures to employ some form of cryptographic mechanism
in order to protect the information during transmission. This is usually
achieved through the use of Transport Layer Security (TLS).
<br/><br/>
JBoss relies on
the underlying SSL implementation running on the OS. This can be either Java
based or OpenSSL. The SSL protocol setting determines which SSL protocol is
used. SSL has known security vulnerabilities, so TLS should be used instead.
If data is transmitted unencrypted, the data then becomes vulnerable to
disclosure. The disclosure may reveal user identifier/password combinations,
website code revealing business logic, or other user personal information.
<br/><br/>
FIPS 140-2 approved TLS versions include TLS V1.0 or greater.
<br/><br/>
TLS must be enabled,
and non-FIPS-approved SSL versions must be disabled. NIST SP 800-52 specifies
the preferred configurations for government systems.
</rationale>
<ident cce="80493-0"/>
<oval id="jboss_eap_use_tls" value="var_jboss_profile" />
<ref srg="SRG-APP-000439-AS-000155" disa="2418" nist="" stigid="JBOS-AS-000650"/>
</Rule>

<Rule id="jboss_eap_use_approved_ciphers" severity="medium">
<title>Use Approved Ciphers</title>
<description>
Reference section 4.6 of the JBoss EAP 6.3 Security Guide located on the Red
Hat vendor's website for step-by-step instructions on establishing SSL
encryption on JBoss.
<br/><br/>
The overall steps include:
<br/><br/>
1. Add an HTTPS connector.
2. Configure the SSL encryption certificate and keys.
3. Set the Cipher to an approved algorithm.
</description>
<ocil clause="it is not">
Log on to the OS of the JBoss server with OS permissions that allow access to
JBoss.
Using the relevant OS commands and syntax, cd to the <tt>&lt;JBOSS_HOME&gt;/bin/</tt>
folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
Validate that the TLS protocol is used for HTTPS connections.
Run the command:
<pre>ls /subsystem=web/connector=https/ssl=configuration</pre>
<br/><br/>
Review the
cipher suites. The following suites are acceptable as per NIST 800-52r1 section
3.3.1 - Cipher Suites. Refer to the NIST document for a complete list of
acceptable cipher suites. The source NIST document and approved encryption
algorithms/cipher suites are subject to change and should be referenced.
<pre>
AES_128_CBC
AES_256_CBC
AES_128_GCM
AES_128_CCM
AES_256_CCM
</pre>
<br/><br/>
If the cipher
suites utilized by the TLS server are not approved by NIST as per 800-52r1, this
is a finding.
</ocil>
<rationale>
Preventing the disclosure or modification of transmitted information requires
that application servers take measures to employ approved cryptography in order
to protect the information during transmission over the network. This is usually
achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPSec
tunnel.
<br/><br/>
If data in transit is unencrypted, it is vulnerable to disclosure and
modification. If approved cryptographic algorithms are not used, encryption
strength cannot be assured.
<br/><br/>
FIPS 140-2 approved TLS versions include TLS V1.0
or greater.
<br/><br/>
TLS must be enabled, and non-FIPS-approved SSL versions must be
disabled. NIST SP 800-52 specifies the preferred configurations for government
systems.
</rationale>
<ident cce="80494-8"/>
<oval id="jboss_eap_use_approved_ciphers" value="var_jboss_profile" />
<ref srg="SRG-APP-000440-AS-000167" disa="2421" nist="" stigid="JBOS-AS-000655"/>
</Rule>

<Rule id="jboss_eap_vendor_supported" severity="high">
<title>JBoss Version Is Vendor Supported</title>
<description>
Obtain vendor support from Red Hat.
</description>
<ocil clause="it is not">
Interview the system admin and have them either show documented proof of
current support, or have them demonstrate their ability to access the Red Hat
Enterprise Support portal.
<br/><br/>
Verify Red Hat support includes coverage for the
JBoss product.
<br/><br/>
If there is no current and active support from the vendor, this
is a finding.
</ocil>
<rationale>
The JBoss product is available as Open Source; however, the Red Hat vendor
provides updates, patches and support for the JBoss product. It is imperative
that patches and updates be applied to JBoss in a timely manner as many attacks
against JBoss focus on unpatched systems. It is critical that support be
obtained and made available.
</rationale>
<ident cce="80495-5"/>
<oval id="jboss_eap_vendor_supported" value="var_jboss_profile" />
<ref srg="SRG-APP-000456-AS-000266" disa="2605" nist="" stigid="JBOS-AS-000680"/>
</Rule>

<Rule id="jboss_eap_system_up_to_date" severity="high">
<title>JBoss System Is Patched</title>
<description>
Configure the operating system and the application server to use a patch
management system or process that ensures security-relevant updates are
installed within the time period directed by the ISSM.
</description>
<ocil clause="it is not">
Interview the system admin and obtain details on their patch management
processes as it relates to the OS and the Application Server.
<br/><br/>
If there is no
active, documented patch management process in use for these components, this is
a finding.
</ocil>
<rationale>
The JBoss product is available as Open Source; however, the Red Hat vendor
provides updates, patches and support for the JBoss product. It is imperative
that patches and updates be applied to JBoss in a timely manner as many attacks
against JBoss focus on unpatched systems. It is critical that support be
obtained and made available.
</rationale>
<ident cce="80496-3"/>
<oval id="jboss_eap_system_up_to_date" value="var_jboss_profile" />
<ref srg="SRG-APP-000456-AS-000266" disa="2605" nist="" stigid="JBOS-AS-000685"/>
</Rule>

<Rule id="jboss_eap_use_dod_approved_certs" severity="medium">
<title>Use DoD Approved Certificates</title>
<description>
Configure the application server to use DoD- or CNSS-approved Class 3 or Class
4 PKI certificates.
</description>
<ocil clause="it is not">
Interview the administrator to determine if JBoss is using certificates for
PKI. If JBoss is not performing any PKI functions, this finding is NA.
<br/><br/>
The CA
certs are usually stored in a file called cacerts located in the directory
<tt>$JAVA_HOME/lib/security</tt>. If the file is not in this location, use a search
command to locate the file, or ask the administrator where the certificate store
is located.
<br/><br/>
Open a dos shell or terminal window and change to the location of
the certificate store. To view the certificates within the certificate store,
run the command (in this example, the keystore file is cacerts.):
<pre>keytool -list -v -keystore ./cacerts</pre>
<br/><br/>
Locate the <pre>OU</pre> field for each certificate
within the keystore. The field should contain either <pre>DoD</pre> or
<pre>CNSS</pre> as the Organizational Unit (OU).
<br/><br/>
If the OU does not show that
the certificates are DoD or CNSS supplied, this is a finding.
</ocil>
<rationale>
Class 3 PKI certificates are used for servers and software signing rather than
for identifying individuals. Class 4 certificates are used for business-to-
business transactions. Utilizing unapproved certificates not issued or approved
by DoD or CNS creates an integrity risk. The application server must utilize
approved DoD or CNS Class 3 or Class 4 certificates for software signing and
business-to-business transactions.
</rationale>
<ident cce="80497-1"/>
<oval id="jboss_eap_use_dod_approved_certs" value="var_jboss_profile" />
<ref srg="SRG-APP-000514-AS-000137" disa="2450" nist="" stigid="JBOS-AS-000730"/>
</Rule>

<Rule id="jboss_eap_roll_over_transfer_logs" severity="medium">
<title>Roll Over and Transfer JBoss Logs</title>
<description>
Open the web-based management interface by opening a browser and pointing it to
<tt>HTTPS://<i>EAP_SERVER</i>:9990/</tt>
<br/><br/>
Authenticate as a user with Admin rights.
Navigate
to the <tt>Configuration</tt> tab.
Expand <tt>+</tt> Subsystems.
Expand <tt>+</tt> Core.
Select
<tt>Logging</tt>.
Select the <tt>Handler</tt> tab.
Select <tt>Periodic</tt>.
<br/><br/>
If a
periodic file handler does not exist, reference JBoss admin guide for
instructions on how to create a file handler that will rotate logs on a daily
basis.
Create scripts that package and off-load log data at least weekly.
</description>
<ocil clause="it is not">
If the JBoss server is configured to use a Syslog Handler, this is not a
finding.
<br/><br/>
Log on to the OS of the JBoss server with OS permissions that allow
access to JBoss.
Using the relevant OS commands and syntax, cd to the
<tt>&lt;JBOSS_HOME&gt;/bin/</tt> folder.
Run the <pre>jboss-cli</pre> script.
Connect to the server and authenticate.
<br/><br/>
Determine if there is a periodic rotating file handler.
<br/><br/>
For a
domain configuration run the following command; where <i>SERVERNAME</i> is a variable
for all of the servers in the domain. Usually <tt>server-one</tt>, <tt>server-two</tt>, etc.:
<br/><br/>
<pre>ls /host=master/server=<i>SERVERNAME</i>/subsystem=logging/periodic-rotating-file-handler=</pre>
<br/><br/>
For a standalone configuration run the command:
<pre>ls /subsystem=logging/periodic-rotating-file-handler=</pre>
<br/><br/>
If the command does not return <tt>FILE</tt>, this is a finding.
<br/><br/>
Review the
<tt>&lt;JBOSS_HOME&gt;/standalone/log</tt> folder for the existence of rotated logs, and ask
the admin to demonstrate how rotated logs are packaged and transferred to
another system on at least a weekly basis.
</ocil>
<rationale>
Information stored in one location is vulnerable to accidental or incidental
deletion or alteration. Protecting log data is important during a forensic
investigation to ensure investigators can track and understand what may have
occurred. Off-loading should be set up as a scheduled task but can be
configured to be run manually, if other processes during the off-loading are
manual.
<br/><br/>
Off-loading is a common process in information systems with limited log
storage capacity.
</rationale>
<ident cce="80498-9"/>
<oval id="jboss_eap_roll_over_transfer_logs" value="var_jboss_profile" />
<ref srg="SRG-APP-000515-AS-000203" disa="1851" nist="" stigid="JBOS-AS-000735"/>
</Rule>

</Group>
