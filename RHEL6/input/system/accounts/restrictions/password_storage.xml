<Group id="password_storage">
<title>Verify Proper Storage and Existence of Password
Hashes</title>
<description>
By default, password hashes for local accounts are stored
in the second field (colon-separated) in
<tt>/etc/shadow</tt>. This file should be readable only by
processes running with root credentials, preventing users from
casually accessing others' password hashes and attempting
to crack them.
However, it remains possible to misconfigure the system
and store password hashes
in world-readable files such as <tt>/etc/passwd</tt>, or
to even store passwords themselves in plaintext on the system.
Using system-provided tools for password change/creation
should allow administrators to avoid such misconfiguration.
</description>

<Rule id="no_empty_passwords" severity="high">
<title>Prevent Log In to Accounts With Empty Password</title>
<description>If an account is configured for password authentication
but does not have an assigned password, it may be possible to log
into the account without authentication. Ensuring that the <tt>nullok</tt>
option is <b>NOT</b> used in the <tt>/etc/pam.d/system-auth-ac</tt>
prevents logins with empty passwords.
<br /><br />
To verify manually, the following command can be used:
<pre># grep nullok /etc/pam.d/system-auth /etc/pam.d/system-auth-ac</pre>
If this produces any output, fix the problem by removing any instance
of <tt>nullok</tt> in <tt>/etc/pam.d/system-auth-ac</tt>.
</description>
<rationale>
If an account has an empty password, anybody may log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational
environments.
</rationale>
<ident cce="4238-2" />
<oval id="accounts_pam_no_nullok" />
<ref nist="AC-3, CM-6, IA-5" />
</Rule>

<Rule id="no_hashes_outside_shadow">
<title>Verify All Account Password Hashes are Shadowed</title>
<description>To ensure that no password hashes are stored in
<tt>/etc/passwd</tt>, the following command should have no output:
<pre># awk -F: '($2 != "x") {print}' /etc/passwd</pre>
</description>
<rationale>
The hashes for all user account passwords should be stored in
the file <tt>/etc/shadow</tt> and never in <tt>/etc/passwd</tt>,
which is readable by all users.
</rationale>
<ident cce="14300-8" />
<oval id="accounts_password_all_shadowed" />
<ref nist="IA-5" disa="196" />
</Rule>

<Rule id="no_netrc_files">
<title>Verify No netrc Files Exist</title>
<description>The <tt>.netrc</tt> files contain login information
used to auto-login into FTP servers and reside in the user's home
directory. These files may contain unencrypted passwords to
remote FTP servers making them susceptible to access by unauthorized
users and should not be used. 
</description>
<rationale>
Unencrypted passwords for remote FTP servers may be stored in <tt>.netrc</tt>
files. DoD policy requires passwords be encrypted in storage and not used
in access scripts.
</rationale>
<ocil>Check the system for the existence of <tt>.netrc</tt> files by
running the following command:
<pre># find / -name .netrc</pre>

Output indicates the presense of <tt>.netrc</tt> files. Remove <tt>.netrc</tt>
files wherever possible. If <tt>.netrc</tt> files are required for
mission functionality their existence and risk mitigation steps should be
documented.</ocil>
<ident cce="TODO" />
<oval id="TODO" />
<ref nist="IA-5" disa="196" />
</Rule>

</Group>

