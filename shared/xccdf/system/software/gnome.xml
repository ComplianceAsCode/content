<Group id="gnome">
<title>GNOME Desktop Environment</title>
<description>
GNOME is a graphical desktop environment bundled with many Linux distributions that
allow users to easily interact with the operating system graphically rather than
textually. The GNOME Graphical Display Manager (GDM) provides login, logout, and user
switching contexts as well as display server management.
<br/><br/>
GNOME is developed by the GNOME Project and is considered the default
Red Hat Graphical environment.
<br/><br/>
For more information on GNOME and the GNOME Project, see <b><weblink-macro link="https://www.gnome.org"/></b>
</description>

<Rule id="enable_dconf_user_profile" severity="high" prodtype="rhel7">
<title>Configure GNOME3 DConf User Profile</title>
<description>
By default, DConf provides a standard user profile. This profile contains a list
of DConf configuration databases. The user profile and database always take the
highest priority. As such the DConf User profile should always exist and be
configured correctly. 
<br /><br />
To make sure that the user profile is configured correctly, the <tt>/etc/dconf/profile/user</tt> should be set as follows:
<pre>user-db:user
system-db:local
system-db:site
system-db:distro
</pre>
</description>
<ocil clause="DConf User profile does not exist or is not configured correctly">
To verify that the DConf User profile is configured correctly, run the following
command:
<pre>$ cat /etc/dconf/profile/user</pre>
The output should show the following:
<pre>user-db:user
system-db:local
system-db:site
system-db:distro</pre>
</ocil>
<rationale>
Failure to have a functional DConf profile prevents GNOME3 configuration settings
from being enforced for all users and allows various security risks.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="27446-4" />
<oval id="enable_dconf_user_profile" />
</Rule>

<Group id="gnome_login_screen">
<title>Configure GNOME Login Screen</title>
<description>In the default GNOME3 desktop, the login is displayed after system boot
and can display user accounts, allow users to reboot the system, and allow users to
login automatically and/or with a guest account. The login screen should be configured
to prevent such behavior.
<br /><br />
For more information about enforcing preferences in the GNOME3 environment using the DConf
configuration system, see <b><weblink-macro link="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Desktop_Migration_and_Administration_Guide/index.html"/></b> and the man page <tt>dconf(1)</tt>.
</description>

<Rule id="gnome_gdm_disable_automatic_login" severity="high" prodtype="rhel7">
<title>Disable GDM Automatic Login</title>
<description>The GNOME Display Manager (GDM) can allow users to automatically login without
user interaction or credentials. User should always be required to authenticate themselves
to the system that they are authorized to use. To disable user ability to automatically
login to the system, set the <tt>AutomaticLoginEnable</tt> to <tt>false</tt> in the
<tt>[daemon]</tt> section in <tt>/etc/gdm/custom.conf</tt>. For example:
<pre>[daemon]
AutomaticLoginEnable=false</pre>
</description>
<ocil clause="GDM allows users to automatically login">
To verify that automatic logins are disabled, run the following command:
<pre>$ grep -Pzoi "^\[daemon]\\nautomaticlogin.*" /etc/gdm/custom.conf</pre>
The output should show the following:
<pre>[daemon]
AutomaticLoginEnable=false</pre>
</ocil>
<rationale>
Failure to restrict system access to authenticated users negatively impacts operating
system security.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80104-3" />
<oval id="gnome_gdm_disable_automatic_login" />
<ref prodtype="rhel7" nist="CM-6(b)" disa="366" ossrg="SRG-OS-000480-GPOS-00229" stigid="010440"
cui="3.1.1" />
</Rule>

<Rule id="gnome_gdm_disable_guest_login" severity="high" prodtype="rhel7">
<title>Disable GDM Guest Login</title>
<description>The GNOME Display Manager (GDM) can allow users to login without credentials
which can be useful for public kiosk scenarios. Allowing users to login without credentials
or "guest" account access has inherent security risks and should be disabled. To do disable
timed logins or guest account access, set the <tt>TimedLoginEnable</tt> to <tt>false</tt> in
the <tt>[daemon]</tt> section in <tt>/etc/gdm/custom.conf</tt>. For example:
<pre>[daemon]
TimedLoginEnable=false</pre>
</description>
<ocil clause="GDM allows a guest to login without credentials">
To verify that timed logins are disabled, run the following command:
<pre>$ grep -Pzoi "^\[daemon]\\ntimedlogin.*" /etc/gdm/custom.conf</pre>
The output should show the following:
<pre>[daemon]
TimedLoginEnable=false</pre>
</ocil>
<rationale>
Failure to restrict system access to authenticated users negatively impacts operating
system security.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80105-0" />
<oval id="gnome_gdm_disable_guest_login" />
<ref prodtype="rhel7" nist="CM-6(b)" disa="366" ossrg="SRG-OS-000480-GPOS-00229" stigid="010450"
cui="3.1.1" />
</Rule>

<Rule id="dconf_gnome_disable_user_list" severity="medium" prodtype="rhel7">
<title>Disable the GNOME3 Login User List</title>
<description>In the default graphical environment, users logging
directly into the system are greeted with a login screen that displays
all known users. This functionality should be disabled by setting
<tt>disable-user-list</tt> to <tt>true</tt>.
<br /><br />
To disable, add or edit <tt>disable-user-list</tt> to 
<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
disable-user-list=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/disable-user-list</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="disable-user-list has not been configured or is not disabled">
To ensure the user list is disabled, run the following command:
<pre>$ grep disable-user-list /etc/dconf/db/gdm.d/*</pre>
The output should be <tt>true</tt>.
To ensure that users cannot enable displaying the user list, run the following:
<pre>$ grep disable-user-list /etc/dconf/db/gdm.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/login-screen/disable-user-list</tt>
</ocil>
<rationale>Leaving the user list enabled is a security risk since it allows anyone
with physical access to the system to quickly enumerate known user accounts
without logging in.</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80106-8" />
<oval id="dconf_gnome_disable_user_list" />
<ref prodtype="rhel7" nist="AC-23" />
</Rule>

<Rule id="dconf_gnome_disable_restart_shutdown" severity="high" prodtype="rhel7">
<title>Disable the GNOME3 Login Restart and Shutdown Buttons</title>
<description>In the default graphical environment, users logging
directly into the system are greeted with a login screen that allows
any user, known or unknown, the ability the ability to shutdown or restart
the system. This functionality should be disabled by setting 
<tt>disable-restart-buttons</tt> to <tt>true</tt>.
<br /><br />
To disable, add or edit <tt>disable-restart-buttons</tt> to
<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
disable-restart-buttons=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/disable-restart-buttons</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="disable-restart-buttons has not been configured or is not disabled">
To ensure disable and restart on the login screen are disabled, run the following command:
<pre>$ grep disable-restart-buttons /etc/dconf/db/gdm.d/*</pre>
The output should be <tt>true</tt>.
To ensure that users cannot enable disable and restart on the login screen, run the following:
<pre>$ grep disable-restart-buttons /etc/dconf/db/gdm.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/login-screen/disable-restart-buttons</tt>
</ocil>
<rationale>
A user who is at the console can reboot the system at the login screen. If restart or shutdown buttons
are pressed at the login screen, this can create the risk of short-term loss of availability of systems
due to reboot.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80107-6" />
<oval id="dconf_gnome_disable_restart_shutdown" />
<ref prodtype="rhel7" nist="AC-6" disa="366" ossrg="SRG-OS-000480-GPOS-00227" stigid="TBD" 
cui="3.1.2" />
</Rule>

<Rule id="dconf_gnome_enable_smartcard_auth" severity="medium" prodtype="rhel7">
<title>Enable the GNOME3 Login Smartcard Authentication</title>
<description>In the default graphical environment, smart card authentication
can be enabled on the login screen by setting <tt>enable-smartcard-authentication</tt>
to <tt>true</tt>.
<br /><br />
To enable, add or edit <tt>enable-smartcard-authentication</tt> to
<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
enable-smartcard-authentication=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/enable-smartcard-authentication</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="enable-smartcard-authentication has not been configured or is disabled">
To ensure smart card authentication on the login screen is enabled, run the following command:
<pre>$ grep enable-smartcard-authentication /etc/dconf/db/gdm.d/*</pre>
The output should be <tt>true</tt>.
To ensure that users cannot disable smart card authentication on the login screen, run the following:
<pre>$ grep enable-smartcard-authentication /etc/dconf/db/gdm.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/login-screen/enable-smartcard-authentication</tt>
</ocil>
<rationale>
Smart card login provides two-factor authentication stronger than
that provided by a username and password combination. Smart cards leverage PKI
(public key infrastructure) in order to provide and verify credentials.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80108-4" />
<oval id="dconf_gnome_enable_smartcard_auth" />
<ref prodtype="rhel7" disa="765,766,767,768,771,772,884" pcidss="Req-8.3" />
</Rule>

<Rule id="dconf_gnome_login_retries" severity="medium" prodtype="rhel7">
<title>Set the GNOME3 Login Number of Failures</title>
<description>In the default graphical environment, the GNOME3 login 
screen and be configured to restart the authentication process after 
a configured number of attempts. This can be configured by setting
<tt>allowed-failures</tt> to <tt>3</tt> or less.
<br /><br />
To enable, add or edit <tt>allowed-failures</tt> to
<tt>/etc/dconf/db/gdm.d/00-security-settings</tt>. For example:
<pre>[org/gnome/login-screen]
allowed-failures=3</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/login-screen/allowed-failures</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="allowed-failures is not equal to or less than the expected value">
To ensure the login screen resets after a specified number of failures,
run the following command:
<pre>$ grep allowed-failures /etc/dconf/db/gdm.d/*</pre>
The output should be <tt>3</tt> or less.
To ensure that users cannot change or configure the resets after a specified
number of failures on the login screen, run the following:
<pre>$ grep allowed-failures /etc/dconf/db/gdm.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/login-screen/allowed-failures</tt>
</ocil>
<rationale>
Setting the password retry prompts that are permitted on a per-session basis to a low value
requires some software, such as SSH, to re-connect. This can slow down and
draw additional attention to some types of password-guessing attacks.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80109-2" />
<ref prodtype="rhel7" cui="3.1.8" />
<oval id="dconf_gnome_login_retries" />
</Rule>


</Group>

<Group id="gnome_screen_locking">
<title>Configure GNOME Screen Locking</title>
<description>In the default GNOME3 desktop, the screen can be locked
by selecting the user name in the far right corner of the main panel and
selecting <b>Lock</b>.
<br /><br />
The following sections detail commands to enforce idle activation of the screensaver,
screen locking, a blank-screen screensaver, and an idle activation time.
<br /><br />
Because users should be trained to lock the screen when they
step away from the computer, the automatic locking feature is only
meant as a backup.
<br /><br />
The root account can be screen-locked; however, the root account should
<i>never</i> be used to log into an X Windows environment and should only
be used to for direct login via console in emergency circumstances.
<br /><br />
For more information about enforcing preferences in the GNOME3 environment using the DConf
configuration system, see <b><weblink-macro link="http://wiki.gnome.org/dconf"/></b> and
the man page <tt>dconf(1)</tt>. For Red Hat specific information on configuring DConf
settings, see <b><weblink-macro link="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Desktop_Migration_and_Administration_Guide/part-Configuration_and_Administration.html"/></b>
</description>

<Value id="inactivity_timeout_value" type="number" operator="equals">
<title>Inactivity timeout</title>
<description>Choose allowed duration of inactive SSH connections, shells, and X sessions</description>
<value>900</value>
<value selector="5_minutes">300</value>
<value selector="10_minutes">600</value>
<value selector="15_minutes">900</value>
</Value>

<Rule id="dconf_gnome_screensaver_idle_delay" severity="medium" prodtype="rhel7">
<title>Set GNOME3 Screensaver Inactivity Timeout</title>
<description>
The idle time-out value for inactivity in the GNOME3 desktop is configured via the <tt>idle-delay</tt>
setting must be set under an appropriate configuration file(s) in the <tt>/etc/dconf/db/local.d</tt> directory
and locked in <tt>/etc/dconf/db/local.d/locks</tt> directory to prevent user modification.
<br /><br/>
For example, to configure the system for a 15 minute delay, add the following to
<tt>/etc/dconf/db/local.d/00-security-settings</tt>:
<pre>[org/gnome/desktop/session]
idle-delay='uint32 900'</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/session/idle-delay</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="idle-delay is not equal to or less than the expected value">
To check the current idle time-out value, run the following command:
<pre>$ gsettings get org.gnome.desktop.session idle-delay</pre>
If properly configured, the output should be <tt>'uint32 <sub idref="inactivity_timeout_value"/>'</tt>.
To ensure that users cannot change the screensaver inactivity timeout setting, run the following:
<pre>$ grep idle-delay /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/desktop/session/idle-delay</tt>
</ocil>
<rationale>
A session time-out lock is a temporary action taken when a user stops work and moves away from
the immediate physical vicinity of the information system but does not logout because of the
temporary nature of the absence. Rather than relying on the user to manually lock their operating
system session prior to vacating the vicinity, GNOME3 can be configured to identify when
a user's session has idled and take action to initiate a session lock.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80110-0" />
<oval id="dconf_gnome_screensaver_idle_delay" value="inactivity_timeout_value" />
<ref prodtype="rhel7" nist="AC-11(a)" disa="57" pcidss="Req-8.1.8"
ossrg="SRG-OS-000029-GPOS-00010" stigid="010070" cjis="5.5.5" cui="3.1.10" />
</Rule>

<Rule id="dconf_gnome_screensaver_idle_activation_enabled" severity="medium" prodtype="rhel7">
<title>Enable GNOME3 Screensaver Idle Activation</title>
<description>
To activate the screensaver in the GNOME3 desktop after a period of inactivity,
add or set <tt>idle-activation-enabled</tt> to <tt>true</tt> in 
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/screensaver]
idle_activation_enabled=true</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/idle-activation-enabled</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="idle_activation_enabled is not enabled or configured">
To check the screensaver mandatory use status, run the following command:
<pre>$ gsettings get org.gnome.desktop.screensaver idle-activation-enabled</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot disable the screensaver idle inactivity setting, run the following:
<pre>$ grep idle-activation-enabled /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/desktop/screensaver/idle-activation-enabled</tt>
</ocil>
<rationale>
A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate
physical vicinity of the information system but does not logout because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity,
GNOME desktops can be configured to identify when a user's session has idled and take action to initiate the
session lock.
<br/><br/>
Enabling idle activation of the screensaver ensures the screensaver will
be activated after the idle delay.  Applications requiring continuous,
real-time screen display (such as network management products) require the
login session does not have administrator rights and the display station is located in a
controlled-access area.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80111-8" />
<oval id="dconf_gnome_screensaver_idle_activation_enabled" />
<ref prodtype="rhel7" nist="AC-11(a)" disa="57" ossrg="SRG-OS-000029-GPOS-00010" stigid="010100" pcidss="Req-8.1.8"
cjis="5.5.5" cui="3.1.10" />
</Rule>

<Rule id="dconf_gnome_screensaver_lock_enabled" severity="medium" prodtype="rhel7">
<title>Enable GNOME3 Screensaver Lock After Idle Period</title>
<description>
To activate locking of the screensaver in the GNOME3 desktop when it is activated,
add or set <tt>lock-enabled</tt> to <tt>true</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/screensaver]
lock-enabled=true
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/lock-enabled</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="screensaver locking is not enabled and/or has not been set or configured correctly">
To check the status of the idle screen lock activation, run the following command:
<pre>$ gsettings get org.gnome.desktop.screensaver lock-enabled</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot change how long until the the screensaver locks, run the following:
<pre>$ grep lock-enabled /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output for <tt>lock-enabled</tt> should be <tt>/org/gnome/desktop/screensaver/lock-enabled</tt>
</ocil>
<rationale>
A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity
of the information system but does not want to logout because of the temporary nature of the absense.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80112-6" />
<oval id="dconf_gnome_screensaver_lock_enabled" />
<ref prodtype="rhel7" nist="AC-11(b)" disa="56" pcidss="Req-8.1.8"
ossrg="SRG-OS-000028-GPOS-00009,OS-SRG-000030-GPOS-00011" stigid="010060"
cjis="5.5.5" cui="3.1.10" />
</Rule>

<Rule id="dconf_gnome_screensaver_lock_delay" severity="medium" prodtype="rhel7">
<title>Set GNOME3 Screensaver Lock Delay After Activation Period</title>
<description>
To activate the locking delay of the screensaver in the GNOME3 desktop when 
the screensaver is activated, add or set <tt>lock-delay</tt> to <tt>uint32 0</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/screensaver]
lock-delay=uint32 0
</pre>
Once the setting has been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/lock-delay</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="the screensaver lock delay has not been set or configured correctly">
To check that the screen locks immediately when activated, run the following command:
<pre>$ gsettings get org.gnome.desktop.screensaver lock-delay</pre>
If properly configured, the output should be <tt>'uint32 0'</tt>.
<br /><br/>
To ensure that users cannot change how long until the the screensaver locks, run the following:
<pre>$ grep lock-delay /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output for <tt>lock-delay</tt> should be <tt>/org/gnome/desktop/screensaver/lock-delay</tt>
</ocil>
<rationale>
A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity
of the information system but does not want to logout because of the temporary nature of the absense.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80370-0" />
<oval id="dconf_gnome_screensaver_lock_delay" />
<ref prodtype="rhel7" nist="AC-11(a)" disa="56" pcidss="Req-8.1.8"
ossrg="OS-SRG-000029-GPOS-00010" stigid="010110" cui="3.1.10" />
</Rule>

<Rule id="dconf_gnome_screensaver_mode_blank" prodtype="rhel7">
<title>Implement Blank Screensaver</title>
<description>
To set the screensaver mode in the GNOME3 desktop to a blank screen,
add or set <tt>picture-uri</tt> to <tt>string ''</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/screensaver]
picture-uri=string ''
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/picture-uri</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="it is not set or configured properly">
To ensure the screensaver is configured to be blank, run the following command:
<pre>$ gsettings get org.gnome.desktop.screensaver picture-uri</pre>
If properly configured, the output should be <tt>''</tt>.

To ensure that users cannot set the screensaver background, run the following:
<pre>$ grep picture-uri /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/desktop/screensaver/picture-uri</tt>
</ocil>
<rationale>
Setting the screensaver mode to blank-only conceals the
contents of the display from passersby.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80113-4" />
<oval id="dconf_gnome_screensaver_mode_blank" />
<ref prodtype="rhel7" nist="AC-11(b)" disa="60" pcidss="Req-8.1.8" cjis="5.5.5" cui="3.1.10" />
</Rule>

<Rule id="dconf_gnome_screensaver_user_info" prodtype="rhel7">
<title>Disable Full User Name on Splash Shield</title>
<description>
By default when the screen is locked, the splash shield will show the user's
full name. This should be disabled to prevent casual observers from seeing
who has access to the system. This can be disabled by adding or setting
<tt>show-full-name-in-top-bar</tt> to <tt>false</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/screensaver]
show-full-name-in-top-bar=false
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/show-full-name-in-top-bar</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="it is not set or configured properly">
To ensure the splash screen is configured not to show user name, run the following command:
<pre>$ gsettings get org.gnome.desktop.screensaver show-full-name-in-top-bar</pre>
If properly configured, the output should be <tt>false</tt>.
To ensure that users cannot enable user name on the lock screen, run the following:
<pre>$ grep show-full-name-in-top-bar /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/desktop/screensaver/show-full-name-in-top-bar</tt>
</ocil>
<rationale>
Setting the splash screen to not reveal the logged in user's name
conceals who has access to the system from passersby.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80114-2" />
<oval id="dconf_gnome_screensaver_user_info" />
</Rule>

<Rule id="dconf_gnome_session_user_locks" prodtype="rhel7">
<title>Ensure Users Cannot Change GNOME3 Session Settings</title>
<description>
If not already configured, ensure that users cannot change GNOME3 session idle and lock settings
by adding <tt>/org/gnome/desktop/screensaver/lock-delay</tt> and <tt>/org/gnome/desktop/session/idle-delay</tt> to <tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/screensaver/lock-delay
/org/gnome/desktop/session/idle-delay</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="GNOME3 session settings are not locked or configured properly">
To ensure that users cannot change session idle and lock settings, run the following:
<pre>$ grep 'lock-delay\|idle-delay' /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should return <tt>/org/gnome/desktop/screensaver/lock-delay</tt>
abd <tt>/org/gnome/desktop/session/idle-delay</tt>.
</ocil>
<rationale>
A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate
physical vicinity of the information system but does not logout because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity,
GNOME desktops can be configured to identify when a user's session has idled and take action to initiate the
session lock. As such, users should not be allowed to change session settings.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80371-8" />
<oval id="dconf_gnome_session_user_locks" />
<ref prodtype="rhel7" nist="AC-11(a)" disa="57"
ossrg="SRG-OS-00029-GPOS-0010" stigid="010081" cui="3.1.10"/>
</Rule>

</Group>

<Group id="gnome_system_settings">
<title>GNOME System Settings</title>
<description>
GNOME provides configuration and functionality to a graphical desktop environment
that changes grahical configurations or allow a user to perform
actions that users normally would not be able to do in non-graphical mode such as
remote access configuration, power policies, Geo-location, etc.
Configuring such settings in GNOME will prevent accidential graphical configuration
changes by users from taking place.
</description>

<Rule id="dconf_gnome_disable_ctrlaltdel_reboot" severity="high" prodtype="rhel7">
<title>Disable Ctrl-Alt-Del Reboot Key Sequence in GNOME3</title>
<description>
By default, <tt>GNOME</tt> will reboot the system if the <tt>Ctrl-Alt-Del</tt>
key sequence is pressed.
<br/><br/>
To configure the system to ignore the <tt>Ctrl-Alt-Del</tt> key sequence from the
Graphical User Interface (GUI) instead of rebooting the system, add or set 
<tt>logout</tt> to <tt>string ''</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/settings-daemon/plugins/media-keys]
logout=string ''
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/settings-daemon/plugins/media-keys/logout</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="GNOME3 is configured to reboot when Ctrl-Alt-Del is pressed">
To ensure the system is configured to ignore the Ctrl-Alt-Del sequence,
run the following command:
<pre>$ gsettings get org.gnome.settings-daemon.plugins.media-keys logout</pre>
If properly configured, the output should be <tt>''</tt>.
To ensure that users cannot enable the Ctrl-Alt-Del sequence, run the following:
<pre>$ grep logout /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/settings-daemon/plugins/media-keys/logout</tt>
</ocil>
<rationale>
A locally logged-in user who presses Ctrl-Alt-Del, when at the console,
can reboot the system. If accidentally pressed, as could happen in
the case of mixed OS environment, this can create the risk of short-term
loss of availability of systems due to unintentional reboot.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_ctrlaltdel_reboot" />
<ident prodtype="rhel7" cce="80124-1" />
<ref prodtype="rhel7" nist="AC-6" disa="366" ossrg="SRG-OS-000480-GPOS-00227" stigid="TBD"
cui="3.1.2" />
</Rule>

<Rule id="dconf_gnome_disable_user_admin" severity="high" prodtype="rhel7">
<title>Disable User Administration in GNOME3</title>
<description>
By default, <tt>GNOME</tt> will allow all users to have some administratrion
capability. This should be disabled so that non-administrative users are not making
configuration changes. To configure the system to disable user administration
capability in the Graphical User Interface (GUI), add or set
<tt>user-administration-disabled</tt> to <tt>true</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/desktop/lockdown]
user-administration-disabled=true
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/lockdown/user-administration-disabled</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="user administration is not configured or disabled">
To ensure the GUI does not allow user administratrion capabilities to all users,
run the following command:
<pre>$ gsettings get org.gnome.desktop.lockdown user-administration-disabled</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot enable user administration, run the following:
<pre>$ grep user-administration /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/desktop/lockdown/user-administration-disabled</tt>
</ocil>
<rationale>
Allowing all users to have some administratrive capabilities to the system through
the Graphical User Interface (GUI) when they would not have them otherwise could allow
unintended configuration changes as well as a nefarious user the capability to make system
changes such as adding new accounts, etc.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_user_admin" />
<ident prodtype="rhel7" cce="80115-9" />
<ref prodtype="rhel7" cui="3.1.5" />
</Rule>

<Rule id="dconf_gnome_disable_power_settings" severity="medium" prodtype="rhel7">
<title>Disable Power Settings in GNOME3</title>
<description>
By default, <tt>GNOME</tt> enables a power profile designed for mobile devices
with battery usage. While useful for mobile devices, this setting should be disabled
for all other systems. To configure the system to disable the power setting, add or set
<tt>active</tt> to <tt>false</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/settings-daemon/plugins/power]
active=false
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/settings-daemon/plugins/power</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="power settings are enabled and are not disabled">
To ensure that the GUI power settings are not active, run the following command:
<pre>$ gsettings get org.gnome.settings-daemon.plugins.power active</pre>
If properly configured, the output should be <tt>false</tt>.
To ensure that users cannot enable the power settings, run the following:
<pre>$ grep power /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/settings-daemon/plugins/power/active</tt>
</ocil>
<rationale>
Power settings should not be enabled on systems that are not mobile devices.
Enabling power settings on non-mobile devices could have unintended processing
consequences on standard systems.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_power_settings" />
<ident prodtype="rhel7" cce="80116-7" />
</Rule>

<Rule id="dconf_gnome_disable_geolocation" severity="medium" prodtype="rhel7">
<title>Disable Geolocation in GNOME3</title>
<description>
<tt>GNOME</tt> allows the clock and applications to track and access location 
information. This setting should be disabled as applications should not track
system location. To configure the system to disable location tracking, add or set
<tt>enabled</tt> to <tt>false</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/system/location]
enabled=false
</pre>
To configure the clock to disable location tracking, add or set
<tt>geolocation</tt> to <tt>false</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/clocks]
geolocation=false
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/system/location/enabled
/org/gnome/clocks/geolocation</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="geolocation is enabled and not disabled">
To ensure that system location tracking is not active, run the following command:
<pre>$ gsettings get org.gnome.system.location enabled
$ gsettings get org.gnome.clocks geolocation</pre>
If properly configured, the output should be <tt>false</tt>.
To ensure that users cannot enable system location tracking, run the following:
<pre>$ grep location /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/system/location/enabled</tt> and <tt>/org/gnome/clocks/geolocation</tt>.
</ocil>
<rationale>
Power settings should not be enabled on systems that are not mobile devices.
Enabling power settings on non-mobile devices could have unintended processing
consequences on standard systems.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_geolocation" />
<ident prodtype="rhel7" cce="80117-5" />
</Rule>

</Group>

<Group id="gnome_network_settings">
<title>GNOME Network Settings</title>
<description>
GNOME network settings that apply to the graphical interface.
</description>

<Rule id="dconf_gnome_disable_wifi_create" severity="medium" prodtype="rhel7">
<title>Disable WIFI Network Connection Creation in GNOME3</title>
<description>
<tt>GNOME</tt> allows users to create ad-hoc wireless connections through the
<tt>NetworkManager</tt> applet. Wireless connections should be disabled by
adding or setting <tt>disable-wifi-create</tt> to <tt>true</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/nm-applet]
disable-wifi-create=true
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/nm-applet/disable-wifi-create</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="WIFI connections can be created through GNOME">
To ensure that WIFI connections caanot be created, run the following command:
<pre>$ gsettings get org.gnome.nm-applet disable-wifi-create</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot enable WIFI connection creation, run the following:
<pre>$ grep wifi-create /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/nm-applet/disable-wifi-create</tt>
</ocil>
<rationale>
Wireless network connections should not be allowed to be configured by general
users on a given system as it could open the system to backdoor attacks.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_wifi_create" />
<ident prodtype="rhel7" cce="80118-3" />
<ref prodtype="rhel7" cui="3.1.16" />
</Rule>

<Rule id="dconf_gnome_disable_wifi_notification" severity="medium" prodtype="rhel7">
<title>Disable WIFI Network Notification in GNOME3</title>
<description>
By default, <tt>GNOME</tt> disables WIFI notification. This should be permanently set
so that users do not connect to a wireless network when the system finds one.
While useful for mobile devices, this setting should be disabled for all other systems.
To configure the system to disable the WIFI notication, add or set
<tt>suppress-wireless-networks-available</tt> to <tt>true</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/nm-applet]
suppress-wireless-networks-available=true
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/nm-applet/suppress-wireless-networks-available</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="wireless network notification is enabled and not disabled">
To ensure that wireless network notification is disabled, run the following command:
<pre>$ gsettings get org.gnome.nm-applet suppress-wireless-networks-available</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot enable wireless notification, run the following:
<pre>$ grep wireless-networks-available /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/nm-applet/suppress-wireless-networks-available</tt>
</ocil>
<rationale>
Wireless network connections should not be allowed to be configured by general
users on a given system as it could open the system to backdoor attacks.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_disable_wifi_notification" />
<ident prodtype="rhel7" cce="80119-1" />
<ref prodtype="rhel7" cui="3.1.16" />
</Rule>

</Group>

<Group id="gnome_remote_access_settings">
<title>GNOME Remote Access Settings</title>
<description>
GNOME remote access settings that apply to the graphical interface.
</description>

<Rule id="dconf_gnome_remote_access_credential_prompt" severity="medium" prodtype="rhel7">
<title>Require Credential Prompting for Remote Access in GNOME3</title>
<description>
By default, <tt>GNOME</tt> does not require credentials when using <tt>Vino</tt> for
remote access. To configure the system to require remote credentials, add or set
<tt>authentication-methods</tt> to <tt>['vnc']</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/Vino]
authentication-methods=['vnc']
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/Vino/authentication-methods</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="wireless network notification is enabled and not disabled">
To ensure that remote access requires credentials, run the following command:
<pre>$ gsettings get org.gnome.Vino authentication-methods</pre>
If properly configured, the output should be <tt>false</tt>.
To ensure that users cannot disable credentials for remote access, run the following:
<pre>$ grep authentication-methods /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/Vino/authentication-methods</tt>
</ocil>
<rationale>
Username and password prompting is required for remote access. Otherwise, non-authorized
and nefarious users can access the system freely.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_remote_access_credential_prompt" />
<ident prodtype="rhel7" cce="80120-9" />
<ref prodtype="rhel7" cui="3.1.12" />
</Rule>

<Rule id="dconf_gnome_remote_access_encryption" severity="medium" prodtype="rhel7">
<title>Require Encryption for Remote Access in GNOME3</title>
<description>
By default, <tt>GNOME</tt> requires encryption when using <tt>Vino</tt> for remote access.
To prevent remote access encryption from being disabled, add or set
<tt>require-encryption</tt> to <tt>true</tt> in
<tt>/etc/dconf/db/local.d/00-security-settings</tt>. For example:
<pre>[org/gnome/Vino]
require-encryption=true
</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/Vino/require-encryption</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="remote access connections are not encrypted">
To ensure that remote access connections are encrypted, run the following command:
<pre>$ gsettings get org.gnome.Vino require-encrpytion</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot disable encrypted remote connections, run the following:
<pre>$ grep require-encryption /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be
<tt>/org/gnome/Vino/require-encryption</tt>
</ocil>
<rationale>
Open X displays allow an attacker to capture keystrokes and to execute commands
remotely.
</rationale>
<platform idref="cpe:/a:machine" />
<oval id="dconf_gnome_remote_access_encryption" />
<ident prodtype="rhel7" cce="80121-7" />
<ref prodtype="rhel7" nist="CM-2(1)(b)" disa="366" ossrg="SRG-OS-000480-GPOS-00227"
stigid="TBD" cui="3.1.13" />
</Rule>

</Group>

<Group id="gnome_media_settings">
<title>GNOME Media Settings</title>
<description>
GNOME media settings that apply to the graphical interface.
</description>

<Rule id="dconf_gnome_disable_automount" prodtype="rhel7">
<title>Disable GNOME3 Automounting</title>
<description>The system's default desktop environment, GNOME3, will mount
devices and removable media (such as DVDs, CDs and USB flash drives) whenever
they are inserted into the system. To disable automount and autorun within GNOME3, add or set
<tt>automount</tt> to <tt>false</tt>, <tt>automount-open</tt> to <tt>false</tt>, and
<tt>autorun-never</tt> to <tt>true</tt> in <tt>/etc/dconf/db/local.d/00-security-settings</tt>.
For example:
<pre>[org/gnome/desktop/media-handling]
automount=false
automount-open=false
autorun-never=true</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/media-handling/automount
/org/gnome/desktop/media-handling/auto-open
/org/gnome/desktop/media-handling/autorun-never</pre>
After the settings have been set, run <tt>dconf update</tt>.
</description>
<ocil clause="GNOME automounting is not disabled">
These settings can be verified by running the following:
<pre>$ gsettings get org.gnome.desktop.media-handling automount
$ gsettings get org.gnome.desktop.media-handling automount-open
$ gsettings get org.gnome.desktop.media-handling autorun-never</pre>
If properly configured, the output for <tt>automount</tt> should be <tt>false</tt>.
If properly configured, the output for <tt>automount-open</tt>should be <tt>false</tt>.
If properly configured, the output for <tt>autorun-never</tt> should be <tt>true</tt>.
To ensure that users cannot enable automount and autorun in GNOME3, run the following:
<pre>$ grep 'automount\|autorun' /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output for <tt>automount</tt> should be <tt>/org/gnome/desktop/media-handling/automount</tt>
If properly configured, the output for <tt>automount-open</tt> should be <tt>/org/gnome/desktop/media-handling/auto-open</tt>
If properly configured, the output for <tt>autorun-never</tt> should be <tt>/org/gnome/desktop/media-handling/autorun-never</tt>
</ocil>
<rationale>Disabling automatic mounting in GNOME3 can prevent
the introduction of malware via removable media.
It will, however, also prevent desktop users from legitimate use
of removable media.
</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80122-5" />
<oval id="dconf_gnome_disable_automount" />
<ref prodtype="rhel7" nist="AC-19(a),AC-19(d),AC-19(e)" cui="3.1.7" />
</Rule>

<Rule id="dconf_gnome_disable_thumbnailers" prodtype="rhel7">
<title>Disable All GNOME3 Thumbnailers</title>
<description>The system's default desktop environment, GNOME3, uses
a number of different thumbnailer programs to generate thumbnails
for any new or modified content in an opened folder. To disable the
execution of these thumbnail applications, add or set <tt>disable-all</tt>
to <tt>true</tt> in <tt>/etc/dconf/db/local.d/00-security-settings</tt>.
For example:
<pre>[org/gnome/desktop/thumbnailers]
disable-all=true</pre>
Once the settings have been added, add a lock to
<tt>/etc/dconf/db/local.d/locks/00-security-settings-lock</tt> to prevent user modification.
For example:
<pre>/org/gnome/desktop/thumbnailers/disable-all</pre>
After the settings have been set, run <tt>dconf update</tt>.
This effectively prevents an attacker from gaining access to a
system through a flaw in GNOME3's Nautilus thumbnail creators.
</description>
<ocil clause="GNOME thumbnailers are not disabled">
These settings can be verified by running the following:
<pre>$ gsettings get org.gnome.desktop.thumbnailers disable-all</pre>
If properly configured, the output should be <tt>true</tt>.
To ensure that users cannot how long until the the screensaver locks, run the following:
<pre>$ grep disable-all /etc/dconf/db/local.d/locks/*</pre>
If properly configured, the output should be <tt>/org/gnome/desktop/thumbnailers/disable-all</tt>
</ocil>
<rationale>An attacker with knowledge of a flaw in a GNOME3 thumbnailer application could craft a malicious
file to exploit this flaw. Assuming the attacker could place the malicious file on the local filesystem
(via a web upload for example) and assuming a user browses the same location using Nautilus, the
malicious file would exploit the thumbnailer with the potential for malicious code execution. It
is best to disable these thumbnailer applications unless they are explicitly required.</rationale>
<platform idref="cpe:/a:machine" />
<ident prodtype="rhel7" cce="80123-3" />
<oval id="dconf_gnome_disable_thumbnailers" />
<ref prodtype="rhel7" nist="CM-7" />
</Rule>

</Group>

</Group>
