<def-group>
  <definition class="inventory" id="installed_OS_is_al2023" version="1">
    <metadata>
      <title>Amazon Linux 2023</title>
      <affected family="unix">
        <platform>multi_platform_all</platform>
      </affected>
      <reference ref_id="cpe:/o:amazon:amazon_linux:2023" source="CPE" />
      <description>The operating system installed on the system is Amazon Linux 2023</description>
    </metadata>

    <criteria operator="AND">
      <extend_definition
        comment="Installed OS is part of the Unix family"
        definition_ref="installed_OS_is_part_of_Unix_family" />

      <criterion
        comment="OS ID is Amazon Linux"
        test_ref="test_amzn_id" />

      <criterion
        comment="OS version is 2023"
        test_ref="test_amzn_version_2023" />
    </criteria>
  </definition>

  <!-- ID="amzn" -->
  <ind:textfilecontent54_test
      id="test_amzn_id"
      comment="Check ID=amzn in /etc/os-release"
      check="all"
      check_existence="at_least_one_exists"
      version="1">
    <ind:object object_ref="obj_amzn_id" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object
      id="obj_amzn_id"
      comment="Read OS ID from os-release"
      version="1">
    <ind:filepath>/etc/os-release</ind:filepath>
    <ind:pattern>ID="?amzn"?</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>

  <!-- VERSION_ID="2023" -->
  <ind:textfilecontent54_test
      id="test_amzn_version_2023"
      comment="Check VERSION_ID=2023 in /etc/os-release"
      check="all"
      check_existence="at_least_one_exists"
      version="1">
    <ind:object object_ref="obj_amzn_version_2023" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object
      id="obj_amzn_version_2023"
      comment="Read OS version from os-release"
      version="1">
    <ind:filepath>/etc/os-release</ind:filepath>
    <ind:pattern>VERSION_ID="?2023"?</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>

</def-group>
