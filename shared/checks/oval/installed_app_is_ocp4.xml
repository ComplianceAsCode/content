<def-group>
  <definition class="inventory" id="installed_app_is_ocp4" version="1">
    <metadata>
      <title>Red Hat OpenShift Container Platform</title>
      <affected family="unix">
        <platform>Red Hat OpenShift Container Platform 4</platform>
      </affected>
      <reference ref_id="cpe:/a:redhat:openshift_container_platform:4.1" source="CPE" />
      <description>The application installed installed on the system is OpenShift 4.</description>
    </metadata>
    <criteria>
      <criterion comment="Make sure OCP4 clusteroperators file is present" test_ref="test_file_for_ocp4"/>
    </criteria>
  </definition>

  <local_variable id="ocp4_dump_location" datatype="string" comment="The actual filepath of the file to scan." version="1">
      <literal_component>/kubernetes-api-resources/apis/config.openshift.io/v1/clusteroperators/openshift-apiserver</literal_component>
  </local_variable>

  <unix:file_test id="test_file_for_ocp4" check="only one" comment="Find the actual file to be scanned." version="1">
      <unix:object object_ref="object_file_for_ocp4"/>
  </unix:file_test>

  <unix:file_object id="object_file_for_ocp4" version="1">
      <unix:filepath var_ref="ocp4_dump_location"/>
  </unix:file_object>
</def-group>
